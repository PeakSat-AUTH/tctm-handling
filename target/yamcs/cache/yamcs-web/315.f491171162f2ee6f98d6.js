(self.webpackChunk_yamcs_webapp=self.webpackChunk_yamcs_webapp||[]).push([[315],{9315:(t,e,n)=>{"use strict";n.r(e),n.d(e,{CommandingModule:()=>Dc});var i=n(7290),a=n(3337),o=n(7102),c=n(4017),s=n(4200),r=n(9385),l=n(8981),m=n(5366);let u=(()=>{class t{constructor(t,e){this.router=e,this.config=t.getConfig()}canActivate(t,e){return this.config.commandClearances}canActivateChild(t,e){return this.canActivate(t,e)}}return t.\u0275fac=function(e){return new(e||t)(m.LFG(l.E),m.LFG(a.F0))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=n(8378),p=n(5609),g=n(9241),f=n(7340),h=n(8293),Z=n(1041),x=n(2935),y=n(2991);let A=(()=>{class t{constructor(t,e,n){this.dialogRef=t,this.data=n,this.form=e.group({level:new Z.NI(null,[Z.kI.required])}),n.clearance&&this.form.setValue({level:n.clearance.level||"DISABLED"})}confirm(){this.dialogRef.close({level:"DISABLED"===this.form.value.level?void 0:this.form.value.level})}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(x.so),m.Y36(Z.qu),m.Y36(x.WI))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-change-level-dialog"]],decls:31,vars:8,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","radio","formControlName","level","value","DISABLED"],[2,"font-weight","normal"],["type","radio","formControlName","level","value","NONE"],["level","NONE",3,"grayscale"],["type","radio","formControlName","level","value","WATCH"],["level","WATCH",3,"grayscale"],["type","radio","formControlName","level","value","WARNING"],["level","WARNING",3,"grayscale"],["type","radio","formControlName","level","value","DISTRESS"],["level","DISTRESS",3,"grayscale"],["type","radio","formControlName","level","value","CRITICAL"],["level","CRITICAL",3,"grayscale"],["type","radio","formControlName","level","value","SEVERE"],["level","SEVERE",3,"grayscale"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(t,e){1&t&&(m.TgZ(0,"h2",0),m._uU(1,"Command clearance"),m.qZA(),m.TgZ(2,"mat-dialog-content",1),m.TgZ(3,"form",2),m.TgZ(4,"label"),m._UZ(5,"input",3),m.TgZ(6,"span",4),m._uU(7,"No clearance"),m.qZA(),m.qZA(),m.TgZ(8,"label"),m._UZ(9,"input",5),m._UZ(10,"app-significance-level",6),m.qZA(),m.TgZ(11,"label"),m._UZ(12,"input",7),m._UZ(13,"app-significance-level",8),m.qZA(),m.TgZ(14,"label"),m._UZ(15,"input",9),m._UZ(16,"app-significance-level",10),m.qZA(),m.TgZ(17,"label"),m._UZ(18,"input",11),m._UZ(19,"app-significance-level",12),m.qZA(),m.TgZ(20,"label"),m._UZ(21,"input",13),m._UZ(22,"app-significance-level",14),m.qZA(),m.TgZ(23,"label"),m._UZ(24,"input",15),m._UZ(25,"app-significance-level",16),m.qZA(),m.qZA(),m.qZA(),m.TgZ(26,"mat-dialog-actions",17),m.TgZ(27,"button",18),m._uU(28,"CANCEL"),m.qZA(),m.TgZ(29,"button",19),m.NdJ("click",function(){return e.confirm()}),m._uU(30,"SAVE CHANGES"),m.qZA(),m.qZA()),2&t&&(m.xp6(3),m.Q6J("formGroup",e.form),m.xp6(7),m.Q6J("grayscale",!0),m.xp6(3),m.Q6J("grayscale",!0),m.xp6(3),m.Q6J("grayscale",!0),m.xp6(3),m.Q6J("grayscale",!0),m.xp6(3),m.Q6J("grayscale",!0),m.xp6(3),m.Q6J("grayscale",!0),m.xp6(4),m.Q6J("disabled",!e.form.valid))},directives:[x.uh,x.xY,Z._Y,Z.JL,Z.sg,Z._,Z.Fj,Z.JJ,Z.u,y.U,x.H8,x.ZT],styles:["[_ngcontent-%COMP%]:focus{outline:none}"]}),t})();var b=n(9624),T=n(9451),v=n(6972),C=n(1430),q=n(4369),_=n(7307),w=n(2619),k=n(1116),N=n(5722),U=n(487);function Q(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"th",17),m.TgZ(1,"input",18),m.NdJ("change",function(e){m.CHM(t);const n=m.oxw(2);return e?n.masterToggle():null}),m.qZA(),m.qZA()}if(2&t){const t=m.oxw(2);m.xp6(1),m.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())}}function S(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"td",19),m.TgZ(1,"input",20),m.NdJ("click",function(t){return t.stopPropagation()})("change",function(e){const n=m.CHM(t).$implicit,i=m.oxw(2);return e?i.selection.toggle(n):null}),m.qZA(),m.qZA()}if(2&t){const t=e.$implicit,n=m.oxw(2);m.xp6(1),m.Q6J("checked",n.selection.isSelected(t))}}function I(t,e){1&t&&(m.TgZ(0,"th",21),m._uU(1,"Username"),m.qZA())}function J(t,e){if(1&t&&(m.TgZ(0,"td",22),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.username," ")}}function O(t,e){1&t&&(m.TgZ(0,"th",23),m._uU(1,"Level"),m.qZA())}function Y(t,e){1&t&&(m.ynx(0),m._uU(1,"No clearance"),m.BQk())}function M(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-significance-level",25),m.BQk()),2&t){const t=m.oxw().$implicit;m.xp6(1),m.Q6J("level",t.level)("grayscale",!0)}}function $(t,e){if(1&t&&(m.TgZ(0,"td",22),m.YNc(1,Y,2,0,"ng-container",24),m.YNc(2,M,2,2,"ng-container",24),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf",!t.level),m.xp6(1),m.Q6J("ngIf",t.level)}}function D(t,e){1&t&&(m.TgZ(0,"th",26),m._uU(1,"Issued"),m.qZA())}function P(t,e){if(1&t&&(m.ynx(0),m._uU(1),m.BQk()),2&t){const t=m.oxw().$implicit;m.xp6(1),m.hij(" by ",t.issuedBy," ")}}function E(t,e){if(1&t&&(m.TgZ(0,"td",22),m._uU(1),m.ALo(2,"datetime"),m.YNc(3,P,2,1,"ng-container",24),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",m.lcZ(2,2,t.issueTime)||"-"," "),m.xp6(2),m.Q6J("ngIf",t.issuedBy)}}function L(t,e){1&t&&m._UZ(0,"tr",27)}function F(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"tr",28),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw(2).toggleOne(e)}),m.qZA()}if(2&t){const t=e.$implicit,n=m.oxw(2);m.ekj("selected",n.selection.isSelected(t))}}function B(t,e){if(1&t&&(m.TgZ(0,"table",4),m.ynx(1,5),m.YNc(2,Q,2,1,"th",6),m.YNc(3,S,2,1,"td",7),m.BQk(),m.ynx(4,8),m.YNc(5,I,2,0,"th",9),m.YNc(6,J,2,1,"td",10),m.BQk(),m.ynx(7,11),m.YNc(8,O,2,0,"th",12),m.YNc(9,$,3,2,"td",10),m.BQk(),m.ynx(10,13),m.YNc(11,D,2,0,"th",14),m.YNc(12,E,4,4,"td",10),m.BQk(),m.YNc(13,L,1,0,"tr",15),m.YNc(14,F,1,2,"tr",16),m.qZA()),2&t){const t=m.oxw();m.Q6J("dataSource",t.dataSource),m.xp6(13),m.Q6J("matHeaderRowDef",t.displayedColumns),m.xp6(1),m.Q6J("matRowDefColumns",t.displayedColumns)}}let R=(()=>{class t{constructor(t,e,n){this.yamcs=t,this.dialog=n,this.displayedColumns=["select","username","level","issued"],this.dataSource=new f.by,this.selection=new d.Ov(!0,[]),e.setTitle("Clearances"),this.refresh()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}refresh(){this.selection.clear(),this.yamcs.yamcsClient.getClearances().then(t=>{this.dataSource.data=t.clearances||[]})}isGroupChangeLevelEnabled(){return!this.selection.isEmpty()}openChangeLevelDialog(){let t;1===this.selection.selected.length&&(t=this.selection.selected[0]),this.dialog.open(A,{data:{clearance:t},width:"400px"}).afterClosed().subscribe(t=>{if(t){const e=[];if(t.level)for(const n of this.selection.selected)e.push(this.yamcs.yamcsClient.changeClearance(n.username,{level:t.level}));else for(const t of this.selection.selected)e.push(this.yamcs.yamcsClient.deleteClearance(t.username));e.length&&Promise.all(e).then(()=>this.refresh())}})}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(h.C),m.Y36(b.Dx),m.Y36(x.uw))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&(m.Gf(g.YE,5),m.Gf(p.NW,5)),2&t){let t;m.iGM(t=m.CRH())&&(e.sort=t.first),m.iGM(t=m.CRH())&&(e.paginator=t.first)}},decls:17,vars:5,consts:[["mat-button","","color","primary",3,"disabled","click"],[1,"panel-content"],["mat-table","","class","ya-data-table","matSort","","matSortActive","username","matSortDirection","asc","matSortDisableClear","",3,"dataSource",4,"ngIf"],[3,"pageSize","hidePageSize","showFirstLastButtons"],["mat-table","","matSort","","matSortActive","username","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","username"],["mat-header-cell","","mat-sort-header","","width","200",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","level"],["mat-header-cell","","mat-sort-header","","style","width: 200px",4,"matHeaderCellDef"],["matColumnDef","issued"],["mat-header-cell","","mat-sort-header","","style","width: 300px",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change"],["mat-header-cell","","mat-sort-header","","width","200"],["mat-cell",""],["mat-header-cell","","mat-sort-header","",2,"width","200px"],[4,"ngIf"],[3,"level","grayscale"],["mat-header-cell","","mat-sort-header","",2,"width","300px"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(t,e){1&t&&(m.TgZ(0,"app-instance-page"),m.TgZ(1,"app-instance-toolbar"),m._uU(2," Clearances "),m.TgZ(3,"app-help"),m.TgZ(4,"p"),m._uU(5,"Clearances allow central control over the level of commands that users are able to send."),m.qZA(),m.TgZ(6,"p"),m._uU(7," Clearance works in addition to regular permission checks. So if a user does anyway not have authorization to send certain commands, giving this user clearance will not change this fact. "),m.qZA(),m.qZA(),m._uU(8," \xa0\xa0\xa0 "),m.TgZ(9,"button",0),m.NdJ("click",function(){return e.openChangeLevelDialog()}),m.TgZ(10,"mat-icon"),m._uU(11,"how_to_reg"),m.qZA(),m._uU(12," CHANGE LEVEL "),m.qZA(),m.qZA(),m.TgZ(13,"div",1),m.TgZ(14,"app-table-container"),m.YNc(15,B,15,3,"table",2),m._UZ(16,"mat-paginator",3),m.qZA(),m.qZA(),m.qZA()),2&t&&(m.xp6(9),m.Q6J("disabled",!e.isGroupChangeLevelEnabled()),m.xp6(6),m.Q6J("ngIf",e.dataSource),m.xp6(1),m.Q6J("pageSize",100)("hidePageSize",!0)("showFirstLastButtons",!0))},directives:[T.a,v.k,C.W,q.lW,_.Hw,w.x,k.O5,p.NW,f.BZ,g.YE,N.fo,N.D5,N.O_,f.w1,f.fO,f.Dz,f.as,f.nj,f.ge,f.ev,g.nU,y.U,f.XQ,f.Gk],pipes:[U.i],encapsulation:2,changeDetection:0}),t})();var j=n(8512),H=n(7701),V=n(6801),G=n(8561),W=n(8509);class X{constructor(){this.dirty=!1,this.archiveRecords=[]}addArchiveData(t){this.archiveRecords=this.archiveRecords.concat(t),this.dirty=!0}reset(){this.archiveRecords=[],this.dirty=!0}snapshot(){return this.archiveRecords}}class z{constructor(t){this.assignments=[],this.userAssignments=[],this.extraAcks=[],this.extra=[],this.acksByName={},this.entry=t,this.id=t.id,this.generationTime=t.generationTime,this.origin=t.origin,this.sequenceNumber=t.sequenceNumber,this.commandName=t.commandName;for(const e of t.assignment||[])this.assignments.push(e),e.userInput&&this.userAssignments.push(e);for(const e of t.attr)if("username"===e.name)this.username=e.value.stringValue;else if("source"===e.name)this.source=e.value.stringValue;else if("binary"===e.name)this.binary=e.value.binaryValue;else if("comment"===e.name)this.comment=e.value.stringValue;else if("queue"===e.name)this.queue=e.value.stringValue;else if(e.name.endsWith("_Message")){const t=e.name.substring(0,e.name.length-"_Message".length);this.saveAckMessage(t,e.value.stringValue)}else if(e.name.endsWith("_Time")){const t=e.name.substring(0,e.name.length-"_Time".length);this.saveAckTime(t,e.value.stringValue)}else if(e.name.endsWith("_Status")){const t=e.name.substring(0,e.name.length-"_Status".length);this.saveAckStatus(t,e.value.stringValue)}else this.extra.push({name:e.name,value:W.c7(e.value)});for(const e of Object.values(this.acksByName))"CommandComplete"===e.name?this.completed=e:"TransmissionConstraints"===e.name?this.transmissionConstraints=e:"Acknowledge_Queued"===e.name?this.queued=e:"Acknowledge_Released"===e.name?this.released=e:"Acknowledge_Sent"===e.name?this.sent=e:this.extraAcks.push(e)}mergeEntry(t){const e=[...this.entry.attr,...t.attr],n=Object.assign(Object.assign(Object.assign({},t),this.entry),{attr:e});return new z(n)}saveAckTime(t,e){let n=null;for(const i in this.acksByName)if(i===t){n=this.acksByName[i];break}n||(n={name:t},this.acksByName[t]=n),n.time=e}saveAckStatus(t,e){let n=null;for(const i in this.acksByName)if(i===t){n=this.acksByName[i];break}n||(n={name:t},this.acksByName[t]=n),n.status=e}saveAckMessage(t,e){let n=null;for(const i in this.acksByName)if(i===t){n=this.acksByName[i];break}n||(n={name:t},this.acksByName[t]=n),n.message=e}}class K extends d.o2{constructor(t,e){super(),this.yamcs=t,this.pageSize=100,this.blockHasMore=!1,this.records$=new j.X([]),this.loading$=new j.X(!1),this.syncSubscription=e.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.records$.next(this.buffer.snapshot()),this.buffer.dirty=!1)}),this.buffer=new X}connect(){return this.records$}loadEntries(t){return this.loading$.next(!0),this.loadPage(Object.assign(Object.assign({},t),{limit:this.pageSize})).then(t=>{this.loading$.next(!1),this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(t.map(t=>new z(t)))})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(t){return this.yamcs.yamcsClient.getCommandHistoryEntries(this.yamcs.instance,t).then(t=>(this.continuationToken=t.continuationToken,t.entry||[]))}loadMoreData(t){this.continuationToken&&this.loadPage(Object.assign(Object.assign({},t),{next:this.continuationToken,limit:this.pageSize})).then(t=>{this.buffer.addArchiveData(t.map(t=>new z(t)))})}disconnect(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.records$.complete(),this.loading$.complete()}isEmpty(){return!this.records$.getValue().length}}var tt=n(6278),et=n(7433),nt=n(4311);function it(t,e){if(1&t&&(m.TgZ(0,"mat-icon",7),m._uU(1,"schedule"),m.qZA()),2&t){const t=m.oxw(2);m.Q6J("matTooltip",t.ack.name+": Scheduled")}}function at(t,e){if(1&t&&(m.TgZ(0,"mat-icon",8),m._uU(1,"check_circle_outline"),m.qZA()),2&t){const t=m.oxw(2);m.Q6J("matTooltip",t.ack.name+": OK")}}function ot(t,e){if(1&t&&(m.TgZ(0,"mat-icon",7),m._uU(1,"lens"),m.qZA()),2&t){const t=m.oxw(2);m.Q6J("matTooltip",t.ack.name+": PENDING")}}function ct(t,e){if(1&t&&(m.TgZ(0,"mat-icon",9),m._uU(1,"block"),m.qZA()),2&t){const t=m.oxw(2);m.Q6J("matTooltip",t.ack.name+": CANCELLED")}}function st(t,e){if(1&t&&(m.TgZ(0,"mat-icon",9),m._uU(1,"block"),m.qZA()),2&t){const t=m.oxw(2);m.Q6J("matTooltip",t.ack.name+": DISABLED")}}function rt(t,e){if(1&t&&(m.TgZ(0,"mat-icon",10),m._uU(1,"highlight_off"),m.qZA()),2&t){const t=m.oxw(2);m.Q6J("matTooltip",t.ack.name+": TIMEOUT")}}function lt(t,e){if(1&t&&(m.TgZ(0,"mat-icon",10),m._uU(1,"highlight_off"),m.qZA()),2&t){const t=m.oxw(2);m.Q6J("matTooltip",t.ack.name+": "+t.ack.status+" ("+t.ack.message+")")}}function mt(t,e){if(1&t&&(m.ynx(0),m.ynx(1,1),m.YNc(2,it,2,1,"mat-icon",2),m.YNc(3,at,2,1,"mat-icon",3),m.YNc(4,ot,2,1,"mat-icon",2),m.YNc(5,ct,2,1,"mat-icon",4),m.YNc(6,st,2,1,"mat-icon",4),m.YNc(7,rt,2,1,"mat-icon",5),m.YNc(8,lt,2,1,"mat-icon",6),m.BQk(),m.BQk()),2&t){const t=m.oxw();m.xp6(1),m.Q6J("ngSwitch",t.ack.status),m.xp6(1),m.Q6J("ngSwitchCase","SCHEDULED"),m.xp6(1),m.Q6J("ngSwitchCase","OK"),m.xp6(1),m.Q6J("ngSwitchCase","PENDING"),m.xp6(1),m.Q6J("ngSwitchCase","CANCELLED"),m.xp6(1),m.Q6J("ngSwitchCase","DISABLED"),m.xp6(1),m.Q6J("ngSwitchCase","TIMEOUT")}}function ut(t,e){1&t&&(m.ynx(0),m.TgZ(1,"mat-icon",11),m._uU(2,"lens"),m.qZA(),m.BQk()),2&t&&(m.xp6(1),m.Q6J("matTooltip","Unknown"))}let dt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-acknowledgment-icon"]],inputs:{ack:"ack"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"ngSwitch"],["class","icon16 down",3,"matTooltip",4,"ngSwitchCase"],["class","icon16","style","color: #00c752",3,"matTooltip",4,"ngSwitchCase"],["class","icon16","style","color: lightgrey",3,"matTooltip",4,"ngSwitchCase"],["class","icon16","style","color: red",3,"matTooltip",4,"ngSwitchCase"],["class","icon16","style","color: red",3,"matTooltip",4,"ngSwitchDefault"],[1,"icon16","down",3,"matTooltip"],[1,"icon16",2,"color","#00c752",3,"matTooltip"],[1,"icon16",2,"color","lightgrey",3,"matTooltip"],[1,"icon16",2,"color","red",3,"matTooltip"],[1,"down","icon16",3,"matTooltip"]],template:function(t,e){1&t&&(m.YNc(0,mt,9,7,"ng-container",0),m.YNc(1,ut,3,1,"ng-container",0)),2&t&&(m.Q6J("ngIf",e.ack),m.xp6(1),m.Q6J("ngIf",!e.ack))},directives:[k.O5,k.RF,k.n9,k.ED,_.Hw,nt.gM],styles:["[_nghost-%COMP%]{line-height:0;font-size:0}"],changeDetection:0}),t})();function pt(t,e){1&t&&(m.TgZ(0,"mat-icon",3),m._uU(1,"cached "),m.qZA())}function gt(t,e){1&t&&(m.TgZ(0,"mat-icon",4),m._uU(1,"lens"),m.qZA())}let ft=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-transmission-constraints-icon"]],inputs:{command:"command"},decls:3,vars:2,consts:[[3,"ngSwitch"],["class","down icon16 spin","matTooltip","Checking transmission constraints",4,"ngSwitchCase"],["class","down icon16",4,"ngSwitchDefault"],["matTooltip","Checking transmission constraints",1,"down","icon16","spin"],[1,"down","icon16"]],template:function(t,e){1&t&&(m.ynx(0,0),m.YNc(1,pt,2,0,"mat-icon",1),m.YNc(2,gt,2,0,"mat-icon",2),m.BQk()),2&t&&(m.Q6J("ngSwitch",null==e.command||null==e.command.transmissionConstraints?null:e.command.transmissionConstraints.status),m.xp6(1),m.Q6J("ngSwitchCase","PENDING"))},directives:[k.RF,k.n9,k.ED,_.Hw,nt.gM],styles:["[_nghost-%COMP%]{line-height:0;font-size:0}.spin[_ngcontent-%COMP%]{animation:yspin 2s linear infinite}"],changeDetection:0}),t})();var ht=n(8888);function Zt(t,e){if(1&t&&(m.TgZ(0,"td",7),m.TgZ(1,"div",8),m._UZ(2,"app-acknowledgment-icon",9),m.qZA(),m.qZA()),2&t){const t=m.oxw(2);m.xp6(2),m.Q6J("ack",t.command.queued)}}function xt(t,e){if(1&t&&m._UZ(0,"app-transmission-constraints-icon",12),2&t){const t=m.oxw(3);m.Q6J("command",t.command)}}function yt(t,e){if(1&t&&m._UZ(0,"app-acknowledgment-icon",9),2&t){const t=m.oxw(3);m.Q6J("ack",t.command.released)}}function At(t,e){if(1&t&&(m.TgZ(0,"td"),m.TgZ(1,"div",8),m.YNc(2,xt,1,1,"app-transmission-constraints-icon",10),m.YNc(3,yt,1,1,"app-acknowledgment-icon",11),m.qZA(),m.qZA()),2&t){const t=m.oxw(2);m.xp6(2),m.Q6J("ngIf",!t.command.released),m.xp6(1),m.Q6J("ngIf",t.command.released)}}function bt(t,e){if(1&t&&(m.TgZ(0,"td"),m.TgZ(1,"div",8),m._UZ(2,"app-acknowledgment-icon",9),m.qZA(),m.qZA()),2&t){const t=m.oxw(2);m.xp6(2),m.Q6J("ack",t.command.sent)}}function Tt(t,e){if(1&t&&(m.TgZ(0,"table",1),m.TgZ(1,"tr"),m.YNc(2,Zt,3,1,"td",2),m.TgZ(3,"td",3),m._uU(4,"Queued"),m.qZA(),m.TgZ(5,"td",4),m._uU(6),m.qZA(),m.TgZ(7,"td"),m.TgZ(8,"span",5),m._uU(9),m.ALo(10,"deltaWith"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(11,"tr"),m.YNc(12,At,4,2,"td",6),m.TgZ(13,"td"),m._uU(14,"Released"),m.qZA(),m.TgZ(15,"td"),m._uU(16),m.qZA(),m.TgZ(17,"td"),m.TgZ(18,"span",5),m._uU(19),m.ALo(20,"deltaWith"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(21,"tr"),m.YNc(22,bt,3,1,"td",6),m.TgZ(23,"td"),m._uU(24,"Sent"),m.qZA(),m.TgZ(25,"td"),m._uU(26),m.qZA(),m.TgZ(27,"td"),m.TgZ(28,"span",5),m._uU(29),m.ALo(30,"deltaWith"),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t){const t=m.oxw();m.ekj("inline",t.inline),m.xp6(2),m.Q6J("ngIf",t.showIcons),m.xp6(4),m.Oqu((null==t.command.queued?null:t.command.queued.status)||"-"),m.xp6(2),m.Q6J("matTooltip",null==t.command.queued?null:t.command.queued.time),m.xp6(1),m.hij(" ",m.xi3(10,14,null==t.command.queued?null:t.command.queued.time,t.command.generationTime)||"-"," "),m.xp6(3),m.Q6J("ngIf",t.showIcons),m.xp6(4),m.hij(" ",(null==t.command.released?null:t.command.released.status)||(null==t.command.transmissionConstraints?null:t.command.transmissionConstraints.status)||"-"," "),m.xp6(2),m.Q6J("matTooltip",null==t.command.released?null:t.command.released.time),m.xp6(1),m.hij(" ",m.xi3(20,17,null==t.command.released?null:t.command.released.time,t.command.generationTime)||"-"," "),m.xp6(3),m.Q6J("ngIf",t.showIcons),m.xp6(4),m.Oqu((null==t.command.sent?null:t.command.sent.status)||"-"),m.xp6(2),m.Q6J("matTooltip",null==t.command.sent?null:t.command.sent.time),m.xp6(1),m.hij(" ",m.xi3(30,20,null==t.command.sent?null:t.command.sent.time,t.command.generationTime)||"-"," ")}}let vt=(()=>{class t{constructor(){this.inline=!1,this.showIcons=!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-yamcs-acknowledgments-table"]],inputs:{command:"command",inline:"inline",showIcons:"showIcons"},decls:1,vars:1,consts:[["yaDataTable","",3,"inline",4,"ngIf"],["yaDataTable",""],["style","width: 16px",4,"ngIf"],[2,"width","150px"],[2,"width","70px"],[3,"matTooltip"],[4,"ngIf"],[2,"width","16px"],[2,"display","flex","align-items","center"],[3,"ack"],[3,"command",4,"ngIf"],[3,"ack",4,"ngIf"],[3,"command"]],template:function(t,e){1&t&&m.YNc(0,Tt,31,23,"table",0),2&t&&m.Q6J("ngIf",e.command)},directives:[k.O5,et.O,nt.gM,dt,ft],pipes:[ht.m],styles:["table[_ngcontent-%COMP%]{width:100%}table.inline[_ngcontent-%COMP%]{width:auto}table.inline[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:0}table.inline[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:first-child), table.inline[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:not(:first-child){padding-left:10px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}"],changeDetection:0}),t})();var Ct=n(4930);function qt(t,e){if(1&t&&(m.TgZ(0,"td",8),m.TgZ(1,"div",9),m._UZ(2,"app-acknowledgment-icon",10),m.qZA(),m.qZA()),2&t){const t=m.oxw().$implicit;m.xp6(2),m.Q6J("ack",t)}}function _t(t,e){1&t&&(m.TgZ(0,"span"),m._uU(1,"-"),m.qZA())}function wt(t,e){1&t&&(m.TgZ(0,"span"),m._uU(1,"-"),m.qZA())}function kt(t,e){if(1&t&&(m.TgZ(0,"span",11),m._uU(1),m.ALo(2,"deltaWith"),m.qZA()),2&t){const t=m.oxw().$implicit,e=m.oxw();m.Q6J("matTooltip",t.time),m.xp6(1),m.hij(" ",m.xi3(2,2,t.time,e.command.generationTime)," ")}}function Nt(t,e){if(1&t&&(m.TgZ(0,"tr"),m.YNc(1,qt,3,1,"td",2),m.TgZ(2,"td",3),m._uU(3),m.qZA(),m.TgZ(4,"td",4),m._uU(5),m.qZA(),m.TgZ(6,"td"),m.ynx(7,5),m.YNc(8,_t,2,0,"span",6),m.YNc(9,wt,2,0,"span",6),m.YNc(10,kt,3,5,"span",7),m.BQk(),m.qZA(),m.qZA()),2&t){const t=e.$implicit,n=m.oxw();m.xp6(1),m.Q6J("ngIf",n.showIcons),m.xp6(2),m.Oqu(t.name),m.xp6(2),m.Oqu(t.status),m.xp6(2),m.Q6J("ngSwitch",t.status),m.xp6(1),m.Q6J("ngSwitchCase","SCHEDULED"),m.xp6(1),m.Q6J("ngSwitchCase","PENDING")}}let Ut=(()=>{class t{constructor(){this.inline=!1,this.showIcons=!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-extra-acknowledgments-table"]],inputs:{command:"command",inline:"inline",showIcons:"showIcons"},decls:2,vars:3,consts:[["yaDataTable",""],[4,"ngFor","ngForOf"],["style","width: 16px",4,"ngIf"],[2,"width","150px"],[2,"width","70px"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"matTooltip",4,"ngSwitchDefault"],[2,"width","16px"],[2,"display","flex","align-items","center"],[3,"ack"],[3,"matTooltip"]],template:function(t,e){1&t&&(m.TgZ(0,"table",0),m.YNc(1,Nt,11,6,"tr",1),m.qZA()),2&t&&(m.ekj("inline",e.inline),m.xp6(1),m.Q6J("ngForOf",e.command.extraAcks))},directives:[et.O,k.sg,k.O5,k.RF,k.n9,k.ED,dt,nt.gM],pipes:[ht.m],styles:["table[_ngcontent-%COMP%]{width:100%}table.inline[_ngcontent-%COMP%]{width:auto}table.inline[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:0}table.inline[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:first-child), table.inline[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:not(:first-child){padding-left:10px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}"],changeDetection:0}),t})();function Qt(t,e){if(1&t&&(m.ynx(0),m._uU(1),m.BQk()),2&t){const t=m.oxw();m.xp6(1),m.hij("@",t.command.origin," ")}}function St(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"div",2),m._uU(2,"Queue"),m.qZA(),m.TgZ(3,"div",1),m._uU(4),m.qZA(),m.BQk()),2&t){const t=m.oxw();m.xp6(4),m.hij(" ",t.command.queue||"-"," ")}}function It(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"div",2),m._uU(2,"Binary"),m.qZA(),m.TgZ(3,"div",1),m._UZ(4,"app-hex",6),m.qZA(),m.BQk()),2&t){const t=m.oxw();m.xp6(4),m.Q6J("base64String",t.command.binary)}}function Jt(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"mat-divider",4),m.TgZ(2,"div",0),m._uU(3,"Comment"),m.qZA(),m.TgZ(4,"div",1),m._uU(5),m.qZA(),m.BQk()),2&t){const t=m.oxw();m.xp6(5),m.hij(" ",t.command.comment," ")}}function Ot(t,e){if(1&t&&(m.TgZ(0,"li"),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.AsE("",t.name,": ",t.value,"")}}function Yt(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"mat-divider",4),m.TgZ(2,"div",0),m._uU(3,"Extra attributes"),m.qZA(),m.TgZ(4,"div",1),m.TgZ(5,"ul"),m.YNc(6,Ot,2,2,"li",7),m.qZA(),m.qZA(),m.BQk()),2&t){const t=m.oxw();m.xp6(6),m.Q6J("ngForOf",t.command.extra)}}function Mt(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"div",2),m._uU(2,"Extra acknowledgments"),m.qZA(),m.TgZ(3,"div",1),m._UZ(4,"app-extra-acknowledgments-table",5),m.qZA(),m.BQk()),2&t){const t=m.oxw();m.xp6(4),m.Q6J("command",t.command)("showIcons",t.showIcons)}}function $t(t,e){1&t&&(m.ynx(0),m._uU(1,"SUCCESS"),m.BQk())}function Dt(t,e){if(1&t&&(m.ynx(0),m._uU(1),m.BQk()),2&t){const t=m.oxw();m.xp6(1),m.hij(" FAILURE: ",null==t.command.completed?null:t.command.completed.message," ")}}function Pt(t,e){1&t&&(m.ynx(0),m._uU(1,"-"),m.BQk())}let Et=(()=>{class t{constructor(){this.showIcons=!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-command-detail2"]],inputs:{command:"command",showIcons:"showIcons"},decls:39,vars:18,consts:[[1,"block-title",2,"padding-top","0"],[1,"block"],[1,"block-title"],[4,"ngIf"],[2,"margin-top","1em","margin-bottom","1em"],[3,"command","showIcons"],[3,"base64String"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m._uU(1,"ID"),m.qZA(),m.TgZ(2,"div",1),m._uU(3),m.qZA(),m.TgZ(4,"div",2),m._uU(5,"Command"),m.qZA(),m.TgZ(6,"div",1),m._uU(7),m.qZA(),m.TgZ(8,"div",2),m._uU(9,"Time"),m.qZA(),m.TgZ(10,"div",1),m._uU(11),m.ALo(12,"datetime"),m.qZA(),m.TgZ(13,"div",2),m._uU(14,"Issuer"),m.qZA(),m.TgZ(15,"div",1),m._uU(16),m.YNc(17,Qt,2,1,"ng-container",3),m.qZA(),m.YNc(18,St,5,1,"ng-container",3),m._UZ(19,"mat-divider",4),m.TgZ(20,"div",0),m._uU(21,"Source"),m.qZA(),m.TgZ(22,"div",1),m._uU(23),m.qZA(),m.YNc(24,It,5,1,"ng-container",3),m.YNc(25,Jt,6,1,"ng-container",3),m.YNc(26,Yt,7,1,"ng-container",3),m._UZ(27,"mat-divider",4),m.TgZ(28,"div",0),m._uU(29,"Yamcs acknowledgments"),m.qZA(),m.TgZ(30,"div",1),m._UZ(31,"app-yamcs-acknowledgments-table",5),m.qZA(),m.YNc(32,Mt,5,2,"ng-container",3),m.TgZ(33,"div",2),m._uU(34,"Completion"),m.qZA(),m.TgZ(35,"div",1),m.YNc(36,$t,2,0,"ng-container",3),m.YNc(37,Dt,2,1,"ng-container",3),m.YNc(38,Pt,2,0,"ng-container",3),m.qZA()),2&t&&(m.xp6(3),m.hij(" ",e.command.id,"\n"),m.xp6(4),m.hij(" ",e.command.commandName,"\n"),m.xp6(4),m.hij(" ",m.lcZ(12,16,e.command.generationTime),"\n"),m.xp6(5),m.hij(" ",e.command.username,""),m.xp6(1),m.Q6J("ngIf",e.command.origin),m.xp6(1),m.Q6J("ngIf",e.command.queue),m.xp6(5),m.hij(" ",e.command.source||"-","\n"),m.xp6(1),m.Q6J("ngIf",e.command.binary),m.xp6(1),m.Q6J("ngIf",e.command.comment),m.xp6(1),m.Q6J("ngIf",e.command.extra.length),m.xp6(5),m.Q6J("command",e.command)("showIcons",e.showIcons),m.xp6(1),m.Q6J("ngIf",e.command.extraAcks.length),m.xp6(4),m.Q6J("ngIf","OK"===(null==e.command.completed?null:e.command.completed.status)),m.xp6(1),m.Q6J("ngIf","NOK"===(null==e.command.completed?null:e.command.completed.status)),m.xp6(1),m.Q6J("ngIf",!e.command.completed))},directives:[k.O5,tt.d,vt,Ct.p,k.sg,Ut],pipes:[U.i],styles:[".step[_ngcontent-%COMP%]{margin-right:8px}.step.mat-icon[_ngcontent-%COMP%]{font-size:14px!important;vertical-align:middle}"],changeDetection:0}),t})();function Lt(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-command-detail2",1),m._UZ(2,"div",2),m.BQk()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("command",t)("showIcons",!1)}}let Ft=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-command-history-printable"]],inputs:{pageTitle:"pageTitle",data:"data"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"command","showIcons"],[2,"page-break-after","always"]],template:function(t,e){1&t&&m.YNc(0,Lt,3,2,"ng-container",0),2&t&&m.Q6J("ngForOf",e.data)},directives:[k.sg,Et],encapsulation:2,changeDetection:0}),t})();var Bt=n(3068),Rt=n(6243),jt=n(5725),Ht=n(7070),Vt=n(221),Gt=n(864),Wt=n(8784),Xt=n(178),zt=n(808),Kt=n(7112),te=n(6764),ee=n(7408),ne=n(4580),ie=n(2656);let ae=(()=>{class t{constructor(t){this.yamcs=t}transform(t){return t?this.yamcs.yamcsClient.getCommandDownloadURL(this.yamcs.instance,t.id):null}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(h.C,16))},t.\u0275pipe=m.Yjl({name:"commandDownloadLink",type:t,pure:!0}),t})();const oe=["intervalSelect"];function ce(t,e){if(1&t&&(m.TgZ(0,"button",10),m.ALo(1,"async"),m.TgZ(2,"mat-icon"),m._uU(3,"save_alt"),m.qZA(),m._uU(4," EXPORT "),m.qZA()),2&t){const t=m.oxw(),e=m.MAs(4);let n;m.Q6J("matMenuTriggerFor",e)("disabled",!(null!=(n=m.lcZ(1,2,t.dataSource.records$))&&n.length))}}const se=function(t){return["/commanding/send",t]},re=function(t,e){return{c:t,template:e}};function le(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"br"),m._UZ(2,"mat-divider"),m._UZ(3,"br"),m.TgZ(4,"button",14),m._uU(5," Resend "),m.qZA(),m.BQk()),2&t){const t=m.oxw().ngIf,e=m.oxw();m.xp6(4),m.Q6J("routerLink",m.VKq(2,se,null==t?null:t.commandName))("queryParams",m.WLB(4,re,e.yamcs.context,null==t?null:t.id))}}function me(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"app-detail-toolbar"),m._uU(2," Command Detail "),m.qZA(),m.TgZ(3,"div",11),m._UZ(4,"app-command-detail2",12),m.YNc(5,le,6,7,"ng-container",13),m.TgZ(6,"p"),m._uU(7,"\xa0"),m.qZA(),m.qZA(),m.BQk()),2&t){const t=e.ngIf,n=m.oxw();m.xp6(4),m.Q6J("command",t),m.xp6(1),m.Q6J("ngIf",n.showResend())}}function ue(t,e){1&t&&(m.TgZ(0,"app-detail-toolbar"),m._uU(1," Select a command "),m.qZA())}function de(t,e){if(1&t){const t=m.EpF();m.ynx(0),m._UZ(1,"app-date-time-input",60),m._UZ(2,"app-date-time-input",61),m.TgZ(3,"button",59),m.NdJ("click",function(){return m.CHM(t),m.oxw(2).applyCustomDates()}),m._uU(4,"Apply"),m.qZA(),m.BQk()}if(2&t){const t=m.oxw(2);m.xp6(3),m.Q6J("disabled",t.filterForm.invalid)}}function pe(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.TgZ(1,"button",62),m.NdJ("click",function(){return m.CHM(t),m.oxw(2).jumpToNow()}),m._uU(2," Jump to now "),m.qZA(),m.BQk()}}function ge(t,e){1&t&&m._UZ(0,"app-dots")}function fe(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1," Showing entries from "),m.TgZ(2,"b"),m._uU(3,"the last hour"),m.qZA(),m._uU(4," ending at "),m.TgZ(5,"b"),m._uU(6),m.ALo(7,"datetime"),m.qZA(),m._uU(8," (Mission Time) "),m.qZA()),2&t){const t=m.oxw(2);m.xp6(6),m.Oqu(m.lcZ(7,1,t.validStop))}}function he(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1," Showing entries from "),m.TgZ(2,"b"),m._uU(3,"the last 6 hours"),m.qZA(),m._uU(4," ending at "),m.TgZ(5,"b"),m._uU(6),m.ALo(7,"datetime"),m.qZA(),m._uU(8," (Mission Time) "),m.qZA()),2&t){const t=m.oxw(2);m.xp6(6),m.Oqu(m.lcZ(7,1,t.validStop))}}function Ze(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1," Showing entries from "),m.TgZ(2,"b"),m._uU(3,"the last 24 hours"),m.qZA(),m._uU(4," ending at "),m.TgZ(5,"b"),m._uU(6),m.ALo(7,"datetime"),m.qZA(),m._uU(8," (Mission Time) "),m.qZA()),2&t){const t=m.oxw(2);m.xp6(6),m.Oqu(m.lcZ(7,1,t.validStop))}}function xe(t,e){1&t&&(m.TgZ(0,"span"),m._uU(1," Showing entries from "),m.TgZ(2,"b"),m._uU(3,"all time"),m.qZA(),m.qZA())}function ye(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1," Showing entries from "),m.TgZ(2,"b"),m._uU(3),m.ALo(4,"datetime"),m.qZA(),m._uU(5," to "),m.TgZ(6,"b"),m._uU(7),m.ALo(8,"datetime"),m.qZA(),m._uU(9," (Mission Time) "),m.qZA()),2&t){const t=m.oxw(2);m.xp6(3),m.Oqu(m.lcZ(4,2,t.validStart)),m.xp6(4),m.Oqu(m.lcZ(8,4,t.validStop))}}function Ae(t,e){1&t&&(m.TgZ(0,"th",63),m._uU(1,"ID"),m.qZA())}function be(t,e){if(1&t&&(m.TgZ(0,"td",64),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.id," ")}}function Te(t,e){1&t&&(m.TgZ(0,"th",63),m._uU(1,"Time"),m.qZA())}function ve(t,e){if(1&t&&(m.TgZ(0,"td",64),m._uU(1),m.ALo(2,"datetime"),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",m.lcZ(2,1,t.generationTime)," ")}}function Ce(t,e){1&t&&(m.TgZ(0,"th",65),m.TgZ(1,"mat-icon",66),m._uU(2,"comment"),m.qZA(),m.qZA())}function qe(t,e){if(1&t&&(m.TgZ(0,"mat-icon",69),m._uU(1,"comment"),m.qZA()),2&t){const t=m.oxw().$implicit;m.Q6J("matTooltip",t.comment)}}function _e(t,e){1&t&&(m.ynx(0),m._uU(1,"-"),m.BQk())}function we(t,e){if(1&t&&(m.TgZ(0,"td",67),m.YNc(1,qe,2,1,"mat-icon",68),m.YNc(2,_e,2,0,"ng-container",13),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf",t.comment),m.xp6(1),m.Q6J("ngIf",!t.comment)}}function ke(t,e){1&t&&(m.TgZ(0,"th",70),m._uU(1,"Command"),m.qZA())}function Ne(t,e){if(1&t&&(m.TgZ(0,"td",64),m._UZ(1,"app-highlight",71),m.qZA()),2&t){const t=e.$implicit,n=m.oxw(2);m.xp6(1),m.Q6J("text",t.commandName)("term",n.filterForm.value.filter)}}function Ue(t,e){1&t&&(m.TgZ(0,"th",72),m._uU(1,"Issuer"),m.qZA())}function Qe(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1),m.qZA()),2&t){const t=m.oxw().$implicit;m.xp6(1),m.hij("@",t.origin,"")}}function Se(t,e){if(1&t&&(m.TgZ(0,"td",64),m._uU(1),m.YNc(2,Qe,2,1,"span",13),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.username,""),m.xp6(1),m.Q6J("ngIf",t.origin)}}function Ie(t,e){1&t&&(m.TgZ(0,"th",73),m._uU(1,"Sequence number"),m.qZA())}function Je(t,e){if(1&t&&(m.TgZ(0,"td",64),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.sequenceNumber," ")}}function Oe(t,e){1&t&&(m.TgZ(0,"th",74),m._uU(1,"Q "),m.qZA())}function Ye(t,e){if(1&t&&(m.TgZ(0,"td",75),m.TgZ(1,"div",76),m._UZ(2,"app-acknowledgment-icon",77),m.qZA(),m.qZA()),2&t){const t=e.$implicit;m.xp6(2),m.Q6J("ack",t.queued)}}function Me(t,e){1&t&&(m.TgZ(0,"th",78),m._uU(1," R "),m.qZA())}function $e(t,e){if(1&t&&m._UZ(0,"app-transmission-constraints-icon",12),2&t){const t=m.oxw().$implicit;m.Q6J("command",t)}}function De(t,e){if(1&t&&m._UZ(0,"app-acknowledgment-icon",77),2&t){const t=m.oxw().$implicit;m.Q6J("ack",t.released)}}function Pe(t,e){if(1&t&&(m.TgZ(0,"td",75),m.TgZ(1,"div",76),m.YNc(2,$e,1,1,"app-transmission-constraints-icon",79),m.YNc(3,De,1,1,"app-acknowledgment-icon",80),m.qZA(),m.qZA()),2&t){const t=e.$implicit;m.xp6(2),m.Q6J("ngIf",!t.released),m.xp6(1),m.Q6J("ngIf",t.released)}}function Ee(t,e){1&t&&(m.TgZ(0,"th",81),m._uU(1,"S "),m.qZA())}function Le(t,e){if(1&t&&(m.TgZ(0,"td",75),m.TgZ(1,"div",76),m._UZ(2,"app-acknowledgment-icon",77),m.qZA(),m.qZA()),2&t){const t=e.$implicit;m.xp6(2),m.Q6J("ack",t.sent)}}function Fe(t,e){1&t&&(m.TgZ(0,"th",82),m._uU(1,"Acks"),m.qZA())}function Be(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-acknowledgment-icon",77),m.BQk()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ack",t)}}function Re(t,e){1&t&&(m.ynx(0),m._uU(1,"-"),m.BQk())}function je(t,e){if(1&t&&(m.TgZ(0,"td",83),m.TgZ(1,"div",76),m.YNc(2,Be,2,1,"ng-container",84),m.qZA(),m.YNc(3,Re,2,0,"ng-container",13),m.qZA()),2&t){const t=e.$implicit;m.xp6(2),m.Q6J("ngForOf",t.extraAcks),m.xp6(1),m.Q6J("ngIf",!t.extraAcks.length)}}function He(t,e){1&t&&(m.TgZ(0,"th",85),m._uU(1,"Completion"),m.qZA())}function Ve(t,e){1&t&&(m.ynx(0),m._uU(1,"SUCCESS"),m.BQk())}function Ge(t,e){if(1&t&&(m.TgZ(0,"span",88),m._uU(1," FAILURE "),m.qZA()),2&t){const t=m.oxw().$implicit;m.Q6J("matTooltip",null==t.completed?null:t.completed.message)}}function We(t,e){1&t&&(m.ynx(0),m._uU(1,"-"),m.BQk())}function Xe(t,e){if(1&t&&(m.TgZ(0,"td",86),m.YNc(1,Ve,2,0,"ng-container",13),m.YNc(2,Ge,2,1,"span",87),m.YNc(3,We,2,0,"ng-container",13),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf","OK"===(null==t.completed?null:t.completed.status)),m.xp6(1),m.Q6J("ngIf","NOK"===(null==t.completed?null:t.completed.status)),m.xp6(1),m.Q6J("ngIf",!t.completed)}}function ze(t,e){1&t&&m._UZ(0,"th",89)}function Ke(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"button",94),m._uU(2," Resend "),m.qZA(),m._UZ(3,"mat-divider"),m.BQk()),2&t){const t=m.oxw().$implicit,e=m.oxw(2);m.xp6(1),m.Q6J("routerLink",m.VKq(2,se,t.commandName))("queryParams",m.WLB(4,re,e.yamcs.context,t.id))}}function tn(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"mat-divider"),m.TgZ(2,"app-download-menu-item",95),m.ALo(3,"commandDownloadLink"),m._uU(4," Download "),m.qZA(),m.BQk()),2&t){const t=m.oxw().$implicit;m.xp6(2),m.Q6J("link",m.lcZ(3,1,t))}}function en(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"td",90),m.TgZ(1,"mat-menu",91,92),m.YNc(3,Ke,4,7,"ng-container",13),m.TgZ(4,"button",3),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw(2).copyHex(e)}),m._uU(5," Copy Hex "),m.qZA(),m.TgZ(6,"button",3),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw(2).copyBinary(e)}),m._uU(7," Copy Binary "),m.qZA(),m.YNc(8,tn,5,3,"ng-container",13),m.qZA(),m.TgZ(9,"button",93),m.NdJ("click",function(t){return t.stopPropagation()}),m.TgZ(10,"mat-icon"),m._uU(11,"more_vert"),m.qZA(),m.qZA(),m.qZA()}if(2&t){const t=m.MAs(2),e=m.oxw(2);m.xp6(3),m.Q6J("ngIf",e.showResend()),m.xp6(5),m.Q6J("ngIf",e.showCommandExports()),m.xp6(1),m.Q6J("matMenuTriggerFor",t)}}function nn(t,e){1&t&&m._UZ(0,"tr",96)}function an(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"tr",97),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw(2).selectRecord(e)}),m.ALo(1,"async"),m.qZA()}if(2&t){const t=e.$implicit,n=m.oxw(2);m.ekj("selected",m.lcZ(1,7,n.selectedRecord$)===t)("success","OK"===(null==t.completed?null:t.completed.status))("failed","NOK"===(null==t.completed?null:t.completed.status)),m.Q6J("@rowAnimation",t.animate)}}function on(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"div",15),m.TgZ(1,"form",16),m.TgZ(2,"div",17),m._UZ(3,"app-search-filter",18),m._UZ(4,"app-column-chooser",19,20),m.qZA(),m.TgZ(6,"div",17),m._UZ(7,"app-select",21,22),m.YNc(9,de,5,1,"ng-container",13),m.YNc(10,pe,3,0,"ng-container",13),m.YNc(11,ge,1,0,"app-dots",13),m.ALo(12,"async"),m.qZA(),m.qZA(),m.TgZ(13,"div",23),m._UZ(14,"div",24),m.YNc(15,fe,9,3,"span",25),m.YNc(16,he,9,3,"span",25),m.YNc(17,Ze,9,3,"span",25),m.YNc(18,xe,4,0,"span",25),m.YNc(19,ye,10,6,"span",25),m.qZA(),m.TgZ(20,"table",26),m.ynx(21,27),m.YNc(22,Ae,2,0,"th",28),m.YNc(23,be,2,1,"td",29),m.BQk(),m.ynx(24,30),m.YNc(25,Te,2,0,"th",28),m.YNc(26,ve,3,3,"td",29),m.BQk(),m.ynx(27,31),m.YNc(28,Ce,3,0,"th",32),m.YNc(29,we,3,2,"td",33),m.BQk(),m.ynx(30,34),m.YNc(31,ke,2,0,"th",35),m.YNc(32,Ne,2,2,"td",29),m.BQk(),m.ynx(33,36),m.YNc(34,Ue,2,0,"th",37),m.YNc(35,Se,3,2,"td",29),m.BQk(),m.ynx(36,38),m.YNc(37,Ie,2,0,"th",39),m.YNc(38,Je,2,1,"td",29),m.BQk(),m.ynx(39,40),m.YNc(40,Oe,2,0,"th",41),m.YNc(41,Ye,3,1,"td",42),m.BQk(),m.ynx(42,43),m.YNc(43,Me,2,0,"th",44),m.YNc(44,Pe,4,2,"td",42),m.BQk(),m.ynx(45,45),m.YNc(46,Ee,2,0,"th",46),m.YNc(47,Le,3,1,"td",42),m.BQk(),m.ynx(48,47),m.YNc(49,Fe,2,0,"th",48),m.YNc(50,je,4,2,"td",49),m.BQk(),m.ynx(51,50),m.YNc(52,He,2,0,"th",51),m.YNc(53,Xe,4,3,"td",52),m.BQk(),m.ynx(54,53),m.YNc(55,ze,1,0,"th",54),m.YNc(56,en,12,3,"td",55),m.BQk(),m.YNc(57,nn,1,0,"tr",56),m.ALo(58,"async"),m.YNc(59,an,2,9,"tr",57),m.ALo(60,"async"),m.qZA(),m.TgZ(61,"mat-toolbar"),m._UZ(62,"span",58),m.TgZ(63,"button",59),m.NdJ("click",function(){return m.CHM(t),m.oxw().loadMoreData()}),m._uU(64,"Load More"),m.qZA(),m._UZ(65,"span",58),m.qZA(),m.qZA()}if(2&t){const t=m.MAs(5),e=m.oxw();m.xp6(1),m.Q6J("formGroup",e.filterForm),m.xp6(3),m.Q6J("columns",e.columns),m.xp6(3),m.Q6J("options",e.intervalOptions),m.xp6(2),m.Q6J("ngIf","CUSTOM"===e.filterForm.value.interval),m.xp6(1),m.Q6J("ngIf","CUSTOM"!==e.filterForm.value.interval),m.xp6(1),m.Q6J("ngIf",m.lcZ(12,16,e.dataSource.loading$)),m.xp6(2),m.Q6J("ngSwitch",e.appliedInterval),m.xp6(2),m.Q6J("ngSwitchCase","PT1H"),m.xp6(1),m.Q6J("ngSwitchCase","PT6H"),m.xp6(1),m.Q6J("ngSwitchCase","P1D"),m.xp6(1),m.Q6J("ngSwitchCase","NO_LIMIT"),m.xp6(1),m.Q6J("ngSwitchCase","CUSTOM"),m.xp6(1),m.Q6J("dataSource",e.dataSource),m.xp6(37),m.Q6J("matHeaderRowDef",m.lcZ(58,18,t.displayedColumns$)),m.xp6(2),m.Q6J("matRowDefColumns",m.lcZ(60,20,t.displayedColumns$)),m.xp6(4),m.Q6J("disabled",!e.dataSource.hasMore())}}const cn="PT1H";let sn=(()=>{class t{constructor(t,e,n,i,a,o,c,s,r,l){this.yamcs=t,this.router=i,this.route=a,this.componentFactoryResolver=o,this.printService=c,this.clipboard=l,this.selectedRecord$=new j.X(null),this.filterForm=new Z.cw({filter:new Z.NI,interval:new Z.NI(cn),customStart:new Z.NI(null),customStop:new Z.NI(null)}),this.columns=[{id:"commandId",label:"ID"},{id:"generationTime",label:"Time",alwaysVisible:!0},{id:"comment",label:"Comment",visible:!0},{id:"command",label:"Command",alwaysVisible:!0},{id:"issuer",label:"Issuer"},{id:"queued",label:"Queued",visible:!0},{id:"released",label:"Released",visible:!0},{id:"sent",label:"Sent",visible:!0},{id:"acknowledgments",label:"Extra acknowledgments",visible:!0},{id:"completion",label:"Completion",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.config=e.getConfig(),this.user=n.getUser(),s.setTitle("Command History"),this.dataSource=new K(this.yamcs,r),this.initializeOptions(),this.loadData(),this.filterForm.get("filter").valueChanges.pipe((0,H.b)(400)).forEach(t=>{this.filter=t,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(e=>{if("CUSTOM"===e){const t=this.validStart||this.yamcs.getMissionTime(),e=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(W.Y6(t)),this.filterForm.get("customStop").setValue(W.Y6(e))}else"NO_LIMIT"===e?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=t.getMissionTime(),this.validStart=(0,W.rV)(this.validStop,e),this.appliedInterval=e,this.loadData())})}initializeOptions(){const t=this.route.snapshot.queryParamMap;if(t.has("filter")&&(this.filter=t.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),t.has("interval"))if(this.appliedInterval=t.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const e=t.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);const n=t.get("customStop");this.filterForm.get("customStop").setValue(n),this.validStop=new Date(n)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,W.rV)(this.validStop,this.appliedInterval));else this.appliedInterval=cn,this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,W.rV)(this.validStop,cn)}jumpToNow(){const t=this.filterForm.value.interval;"NO_LIMIT"===t||"CUSTOM"===t?this.filterForm.get("interval").setValue(cn):(this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,W.rV)(this.validStop,t),this.loadData())}applyCustomDates(){this.validStart=W.ZU(this.filterForm.value.customStart),this.validStop=W.ZU(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const t={};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.filter&&(t.q=this.filter),this.dataSource.loadEntries(t)}loadMoreData(){const t={};this.validStart&&(t.start=this.validStart.toISOString()),this.filter&&(t.q=this.filter),this.dataSource.loadMoreData(t)}showResend(){return this.config.tc&&this.user.hasAnyObjectPrivilegeOfType("Command")}showCommandExports(){return this.config.commandExports}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:this.filter||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}copyHex(t){const e=W.TR(t.binary);this.clipboard.copy(e)}copyBinary(t){const e=atob(t.binary);this.clipboard.copy(e)}selectRecord(t){this.selectedRecord$.next(t)}printReport(){const t=this.dataSource.records$.value.slice().reverse(),e=this.componentFactoryResolver.resolveComponentFactory(Ft);this.printService.printComponent(e,"Command Report",t)}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(h.C),m.Y36(l.E),m.Y36(G.e),m.Y36(a.F0),m.Y36(a.gz),m.Y36(m._Vd),m.Y36(Bt.Y),m.Y36(b.Dx),m.Y36(Rt.j),m.Y36(jt.TU))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&m.Gf(oe,5),2&t){let t;m.iGM(t=m.CRH())&&(e.intervalSelect=t.first)}},decls:20,vars:7,consts:[[3,"hasDetailPane"],[1,"ya-menu"],["exportMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled",4,"ngIf"],["mat-button","","matTooltip","Jump to now","color","primary",3,"click"],[4,"ngIf","ngIfElse"],["noSelection",""],[1,"table-wrapper"],["class","panel-content",4,"ngIf"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled"],[2,"padding","0 16px"],[3,"command"],[4,"ngIf"],[1,"ya-button",3,"routerLink","queryParams"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","filter","placeholder","Filter by text search"],["preferenceKey","cmdhist",3,"columns"],["columnChooser",""],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[1,"table-status",3,"ngSwitch"],[1,"message-zone"],[4,"ngSwitchCase"],["mat-table","",1,"ya-data-table",3,"dataSource"],["matColumnDef","commandId"],["mat-header-cell","","style","width: 200px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","comment"],["mat-header-cell","","class","iconcol",4,"matHeaderCellDef"],["mat-cell","","class","iconcol",4,"matCellDef"],["matColumnDef","command"],["mat-header-cell","","style","width: 350px",4,"matHeaderCellDef"],["matColumnDef","issuer"],["mat-header-cell","","style","width: 150px",4,"matHeaderCellDef"],["matColumnDef","sequenceNumber"],["mat-header-cell","","style","width: 70px",4,"matHeaderCellDef"],["matColumnDef","queued"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command queued",4,"matHeaderCellDef"],["mat-cell","","class","iconcol dense","style","text-align: center",4,"matCellDef"],["matColumnDef","released"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command released",4,"matHeaderCellDef"],["matColumnDef","sent"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command sent",4,"matHeaderCellDef"],["matColumnDef","acknowledgments"],["mat-header-cell","","class","dense",4,"matHeaderCellDef"],["mat-cell","","class","dense",4,"matCellDef"],["matColumnDef","completion"],["mat-header-cell","","style","padding-left: 8px",4,"matHeaderCellDef"],["mat-cell","","class","completion","style","text-align: center; padding-left: 8px",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","success","failed","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1 1 auto"],[1,"ya-button",3,"disabled","click"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click"],["mat-header-cell","",2,"width","200px"],["mat-cell",""],["mat-header-cell","",1,"iconcol"],["matTooltip","Comment",1,"icon16"],["mat-cell","",1,"iconcol"],["class","icon16",3,"matTooltip",4,"ngIf"],[1,"icon16",3,"matTooltip"],["mat-header-cell","",2,"width","350px"],[3,"text","term"],["mat-header-cell","",2,"width","150px"],["mat-header-cell","",2,"width","70px"],["mat-header-cell","","matTooltip","Command queued",1,"iconcol","dense",2,"text-align","center"],["mat-cell","",1,"iconcol","dense",2,"text-align","center"],[2,"display","flex","align-items","center"],[3,"ack"],["mat-header-cell","","matTooltip","Command released",1,"iconcol","dense",2,"text-align","center"],[3,"command",4,"ngIf"],[3,"ack",4,"ngIf"],["mat-header-cell","","matTooltip","Command sent",1,"iconcol","dense",2,"text-align","center"],["mat-header-cell","",1,"dense"],["mat-cell","",1,"dense"],[4,"ngFor","ngForOf"],["mat-header-cell","",2,"padding-left","8px"],["mat-cell","",1,"completion",2,"text-align","center","padding-left","8px"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-header-cell",""],["mat-cell","",2,"text-align","right"],["overlapTrigger","false",1,"ya-menu"],["itemMenu","matMenu"],["mat-button","",1,"icon",3,"matMenuTriggerFor","click"],["mat-menu-item","",3,"routerLink","queryParams"],[3,"link"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(t,e){if(1&t&&(m.TgZ(0,"app-instance-page"),m.TgZ(1,"app-instance-toolbar",0),m._uU(2," Command History \xa0\xa0\xa0 "),m.TgZ(3,"mat-menu",1,2),m.TgZ(5,"button",3),m.NdJ("click",function(){return e.printReport()}),m.TgZ(6,"mat-icon"),m._uU(7,"print"),m.qZA(),m._uU(8," Print report "),m.qZA(),m.qZA(),m.YNc(9,ce,5,4,"button",4),m.TgZ(10,"button",5),m.NdJ("click",function(){return e.jumpToNow()}),m.TgZ(11,"mat-icon"),m._uU(12,"refresh"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(13,"app-detail-pane"),m.YNc(14,me,8,2,"ng-container",6),m.ALo(15,"async"),m.YNc(16,ue,2,0,"ng-template",null,7,m.W1O),m.qZA(),m.TgZ(18,"div",8),m.YNc(19,on,66,22,"div",9),m.qZA(),m.qZA()),2&t){const t=m.MAs(17);m.xp6(1),m.Q6J("hasDetailPane",!0),m.xp6(8),m.Q6J("ngIf",e.showCommandExports()),m.xp6(5),m.Q6J("ngIf",m.lcZ(15,5,e.selectedRecord$))("ngIfElse",t),m.xp6(5),m.Q6J("ngIf",e.dataSource)}},directives:[T.a,v.k,Ht.VK,Ht.OP,_.Hw,k.O5,q.lW,nt.gM,Vt.Z,Ht.p6,Gt.j,Et,tt.d,a.rH,Z._Y,Z.JL,Z.sg,Wt.a,Z.JJ,Z.u,Xt.k,zt.P,k.RF,k.n9,f.BZ,f.w1,f.fO,f.Dz,f.as,f.nj,Kt.Ye,te.Y,ee.b,f.ge,f.ev,ne.y,dt,ft,k.sg,ie.t,f.XQ,f.Gk],pipes:[k.Ov,U.i,ae],styles:[".table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-status[_ngcontent-%COMP%]{background-color:#f2f2f2;padding-left:6px;margin-bottom:20px}.table-status[_ngcontent-%COMP%], .table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{height:24px;line-height:24px;font-size:12px}.table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{float:right;padding-right:6px}.mat-row[_ngcontent-%COMP%]{cursor:pointer}tr.failed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:red}tr.success[_ngcontent-%COMP%]   td.completion[_ngcontent-%COMP%]{background-color:#e6ffed;color:#00c752}tr.failed[_ngcontent-%COMP%]   td.completion[_ngcontent-%COMP%]{background-color:#ffeef0;color:red}td.dense[_ngcontent-%COMP%], th.dense[_ngcontent-%COMP%]{width:1px;white-space:nowrap;padding-left:12px;padding-right:12px}"],data:{animation:[V.q]},changeDetection:0}),t})(),rn=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-send-command-wizard-step"]],inputs:{step:"step"},decls:11,vars:6,consts:[[1,"sub"]],template:function(t,e){1&t&&(m.TgZ(0,"mat-toolbar",0),m.TgZ(1,"mat-toolbar-row"),m.TgZ(2,"span"),m.TgZ(3,"span"),m._uU(4,"1. Select command"),m.qZA(),m._uU(5," \xa0\xa0\xa0\xa0\xa0\xa0\xa0 "),m.TgZ(6,"span"),m._uU(7,"2. Configure command"),m.qZA(),m._uU(8," \xa0\xa0\xa0\xa0\xa0\xa0\xa0 "),m.TgZ(9,"span"),m._uU(10,"3. View report"),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t&&(m.xp6(3),m.ekj("active",1==e.step),m.xp6(3),m.ekj("active",2==e.step),m.xp6(3),m.ekj("active",3==e.step))},directives:[Kt.Ye,Kt.rD],styles:["span[_ngcontent-%COMP%]{cursor:default}span[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.3}span[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{opacity:1}mat-toolbar.sub[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;background-color:#fff;font-size:12px}.mat-toolbar-row[_ngcontent-%COMP%]{height:32px;padding:0 24px}.mat-toolbar-multiple-rows[_ngcontent-%COMP%]{min-height:32px}"],changeDetection:0}),t})();const ln=function(t){return{c:t}},mn=function(t){return["/commanding/send",t]},un=function(t,e){return{c:t,template:e}};function dn(t,e){if(1&t&&(m.TgZ(0,"div",2),m._UZ(1,"app-command-detail2",3),m.ynx(2),m._UZ(3,"br"),m._UZ(4,"mat-divider"),m._UZ(5,"br"),m.TgZ(6,"button",4),m._uU(7," Send another command "),m.qZA(),m._uU(8," \xa0\xa0 "),m.TgZ(9,"button",5),m._uU(10," Resend this command "),m.qZA(),m.BQk(),m.qZA()),2&t){const t=e.ngIf,n=m.oxw();m.xp6(1),m.Q6J("command",t),m.xp6(5),m.Q6J("queryParams",m.VKq(4,ln,n.yamcs.context)),m.xp6(3),m.Q6J("routerLink",m.VKq(6,mn,t.commandName))("queryParams",m.WLB(8,un,n.yamcs.context,t.id))}}let pn=(()=>{class t{constructor(t,e){this.yamcs=e,this.command$=new j.X(null);const n=t.snapshot.paramMap.get("commandId");e.yamcsClient.getCommandHistoryEntry(this.yamcs.instance,n).then(t=>{this.mergeEntry(t),this.commandSubscription=e.yamcsClient.createCommandSubscription({instance:e.instance,processor:e.processor,ignorePastCommands:!1},t=>{t.id===n&&this.mergeEntry(t)})})}mergeEntry(t){const e=this.command$.value;if(e){const n=e.mergeEntry(t);this.command$.next(n)}else this.command$.next(new z(t))}ngOnDestroy(){this.commandSubscription&&this.commandSubscription.cancel()}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(a.gz),m.Y36(h.C))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],decls:6,vars:3,consts:[["step","3"],["class","panel-content",4,"ngIf"],[1,"panel-content"],[3,"command"],["routerLink","/commanding/send",1,"ya-button",3,"queryParams"],[1,"ya-button",3,"routerLink","queryParams"]],template:function(t,e){1&t&&(m.TgZ(0,"app-instance-page"),m.TgZ(1,"app-instance-toolbar"),m._uU(2," Send a command "),m.qZA(),m._UZ(3,"app-send-command-wizard-step",0),m.YNc(4,dn,11,11,"div",1),m.ALo(5,"async"),m.qZA()),2&t&&(m.xp6(4),m.Q6J("ngIf",m.lcZ(5,1,e.command$)))},directives:[T.a,v.k,rn,k.O5,Et,tt.d,a.rH],pipes:[k.Ov],encapsulation:2,changeDetection:0}),t})();var gn=n(1508),fn=n(5381),hn=n(6298),Zn=n(7686),xn=n(7673);function yn(t,e){if(1&t&&(m.TgZ(0,"option",10),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.Q6J("value",t.label),m.xp6(1),m.hij(" ",t.label,"")}}function An(t,e){if(1&t&&(m.TgZ(0,"label"),m.TgZ(1,"div",4),m.TgZ(2,"div",5),m._uU(3),m.qZA(),m.qZA(),m._uU(4),m._UZ(5,"app-errors",6),m.TgZ(6,"select",7),m.TgZ(7,"option",8),m._uU(8," -- select an option -- "),m.qZA(),m.YNc(9,yn,2,2,"option",9),m.qZA(),m.qZA()),2&t){const t=m.oxw().ngIf,e=m.oxw();m.xp6(3),m.Oqu(e.argument.type.engType),m.xp6(1),m.hij(" ",e.argument.name," "),m.xp6(1),m.Q6J("controlName",t),m.xp6(1),m.Q6J("formControlName",t),m.xp6(3),m.Q6J("ngForOf",e.argument.type.enumValue)}}function bn(t,e){if(1&t&&(m.TgZ(0,"label"),m._uU(1),m._UZ(2,"app-errors",6),m._UZ(3,"br"),m._UZ(4,"input",11),m._uU(5),m._UZ(6,"input",11),m._uU(7),m.qZA()),2&t){const t=m.oxw().ngIf,e=m.oxw();m.xp6(1),m.hij(" ",e.argument.name," "),m.xp6(1),m.Q6J("controlName",t),m.xp6(2),m.Q6J("formControlName",t)("value",e.argument.type.oneStringValue),m.xp6(1),m.hij(" ",e.argument.type.oneStringValue," "),m.xp6(1),m.Q6J("formControlName",t)("value",e.argument.type.zeroStringValue),m.xp6(1),m.hij(" ",e.argument.type.zeroStringValue," ")}}function Tn(t,e){if(1&t&&(m.TgZ(0,"label"),m._uU(1),m._UZ(2,"app-errors",6),m._UZ(3,"app-date-time-input",7),m.qZA()),2&t){const t=m.oxw().ngIf,e=m.oxw();m.xp6(1),m.hij(" ",e.argument.name," "),m.xp6(1),m.Q6J("controlName",t),m.xp6(1),m.Q6J("formControlName",t)}}function vn(t,e){if(1&t&&(m.TgZ(0,"label"),m.TgZ(1,"div",4),m.TgZ(2,"div",5),m.ALo(3,"async"),m._uU(4),m.qZA(),m.qZA(),m._uU(5),m._UZ(6,"app-errors",6,12),m._UZ(8,"app-binary-input",7),m.qZA()),2&t){const t=m.MAs(7),e=m.oxw().ngIf,n=m.oxw();m.xp6(2),m.ekj("error",m.lcZ(3,6,t.invalid$)),m.xp6(2),m.Oqu(n.argument.type.engType),m.xp6(1),m.hij(" ",n.argument.name," "),m.xp6(1),m.Q6J("controlName",e),m.xp6(2),m.Q6J("formControlName",e)}}function Cn(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-command-form-argument",15),m._UZ(2,"br"),m.BQk()),2&t){const t=e.$implicit,n=m.oxw(3);m.xp6(1),m.Q6J("argument",t)("formGroup",n.formGroup)("parent",n.parent?n.parent+"."+n.argument.name:n.argument.name)}}function qn(t,e){if(1&t&&(m.TgZ(0,"label"),m.TgZ(1,"div",4),m.TgZ(2,"div",5),m._uU(3),m.qZA(),m.qZA(),m._uU(4),m.TgZ(5,"div",13),m.YNc(6,Cn,3,3,"ng-container",14),m.qZA(),m.qZA()),2&t){const t=m.oxw(2);m.xp6(3),m.Oqu(t.argument.type.engType),m.xp6(1),m.hij(" ",t.argument.name," "),m.xp6(2),m.Q6J("ngForOf",null==t.argument.type?null:t.argument.type.member)}}function _n(t,e){if(1&t&&(m.TgZ(0,"div",5),m._UZ(1,"app-interval",18),m.qZA()),2&t){const t=m.oxw(3);m.xp6(1),m.Q6J("left",t.argument.type.rangeMin)("right",t.argument.type.rangeMax)}}function wn(t,e){if(1&t&&(m.TgZ(0,"div",5),m._uU(1),m.ALo(2,"units"),m.qZA()),2&t){const t=m.oxw(3);m.xp6(1),m.hij(" ",m.lcZ(2,1,null==t.argument.type?null:t.argument.type.unitSet)," ")}}function kn(t,e){if(1&t&&(m.TgZ(0,"label"),m.TgZ(1,"div",4),m.ALo(2,"async"),m.YNc(3,_n,2,2,"div",16),m.YNc(4,wn,3,3,"div",16),m.TgZ(5,"div",5),m._uU(6),m.qZA(),m.qZA(),m._uU(7),m._UZ(8,"app-errors",6,12),m._UZ(10,"input",17),m.qZA()),2&t){const t=m.MAs(9),e=m.oxw().ngIf,n=m.oxw();m.xp6(1),m.ekj("error",m.lcZ(2,8,t.invalid$)),m.xp6(2),m.Q6J("ngIf",void 0!==n.argument.type.rangeMin||void 0!==n.argument.type.rangeMax),m.xp6(1),m.Q6J("ngIf",null==n.argument.type?null:n.argument.type.unitSet),m.xp6(2),m.Oqu(n.argument.type.engType),m.xp6(1),m.hij(" ",n.argument.name," "),m.xp6(1),m.Q6J("controlName",e),m.xp6(2),m.Q6J("formControlName",e)}}function Nn(t,e){if(1&t&&(m.ynx(0,1),m.YNc(1,An,10,5,"label",2),m.YNc(2,bn,8,8,"label",2),m.YNc(3,Tn,4,3,"label",2),m.YNc(4,vn,9,8,"label",2),m.YNc(5,qn,7,3,"label",2),m.YNc(6,kn,11,10,"label",3),m.BQk()),2&t){const t=m.oxw();m.Q6J("formGroup",t.formGroup)("ngSwitch",null==t.argument.type?null:t.argument.type.engType),m.xp6(1),m.Q6J("ngSwitchCase","enumeration"),m.xp6(1),m.Q6J("ngSwitchCase","boolean"),m.xp6(1),m.Q6J("ngSwitchCase","time"),m.xp6(1),m.Q6J("ngSwitchCase","binary"),m.xp6(1),m.Q6J("ngSwitchCase","aggregate")}}let Un=(()=>{class t{constructor(){this.controlName$=new j.X(null)}ngOnInit(){this.controlName$.next(this.parent?this.parent+"."+this.argument.name:this.argument.name)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-command-form-argument"]],inputs:{formGroup:"formGroup",argument:"argument",parent:"parent"},decls:2,vars:3,consts:[[3,"formGroup","ngSwitch",4,"ngIf"],[3,"formGroup","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControlName"],["hidden","","disabled","","selected","","value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","radio",3,"formControlName","value"],["err",""],[1,"members"],[4,"ngFor","ngForOf"],[3,"argument","formGroup","parent"],["class","item",4,"ngIf"],["type","text",3,"formControlName"],[3,"left","right"]],template:function(t,e){1&t&&(m.YNc(0,Nn,7,7,"ng-container",0),m.ALo(1,"async")),2&t&&m.Q6J("ngIf",m.lcZ(1,1,e.controlName$))},directives:[k.O5,Z.JL,Z.sg,k.RF,k.n9,k.ED,fn.D,Z.EJ,Z.JJ,Z.u,Z.YN,Z.Kr,k.sg,Z._,Z.Fj,te.Y,hn.Y,t,Zn.X],pipes:[k.Ov,xn.H],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:rgba(0,0,0,.65);padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px}"],changeDetection:0}),t})();var Qn=n(3357);function Sn(t,e){1&t&&m._UZ(0,"br")}function In(t,e){if(1&t&&(m.ynx(0),m.YNc(1,Sn,1,0,"br",2),m._UZ(2,"app-command-form-argument",5),m.BQk()),2&t){const t=e.$implicit,n=e.first,i=m.oxw();m.xp6(1),m.Q6J("ngIf",!n),m.xp6(1),m.Q6J("argument",t)("formGroup",i.form)}}function Jn(t,e){1&t&&m._UZ(0,"br",8)}function On(t,e){if(1&t&&(m.ynx(0),m.YNc(1,Jn,1,0,"br",6),m._UZ(2,"app-command-form-argument",7),m.BQk()),2&t){const t=e.$implicit,n=e.first,i=m.oxw();m.xp6(1),m.Q6J("ngIf",!n||i.arguments.length),m.xp6(1),m.Q6J("argument",t)("formGroup",i.form)}}function Yn(t,e){1&t&&m._UZ(0,"br")}function Mn(t,e){1&t&&(m.ynx(0),m._uU(1,"s"),m.BQk())}function $n(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.YNc(1,Yn,1,0,"br",2),m.TgZ(2,"app-text-action",9),m.NdJ("click",function(){return m.CHM(t),m.oxw().showAll$.next(!0)}),m._uU(3),m.YNc(4,Mn,2,0,"ng-container",2),m._uU(5," with defaults "),m.qZA(),m.BQk()}if(2&t){const t=m.oxw();m.xp6(1),m.Q6J("ngIf",t.arguments.length),m.xp6(2),m.hij(" Show ",t.argumentsWithInitial.length," argument"),m.xp6(1),m.Q6J("ngIf",1!==t.argumentsWithInitial.length)}}function Dn(t,e){if(1&t&&(m.TgZ(0,"app-help",16),m._UZ(1,"div",17),m.qZA()),2&t){const t=m.oxw(2).$implicit;m.Q6J("dialogTitle",t.verboseName||t.id),m.xp6(1),m.Q6J("innerHTML",t.help,m.oJD)}}function Pn(t,e){if(1&t&&(m.TgZ(0,"label"),m._uU(1),m.YNc(2,Dn,2,2,"app-help",13),m._UZ(3,"br"),m._UZ(4,"input",14),m._uU(5," true "),m._UZ(6,"input",15),m._uU(7," false "),m.qZA()),2&t){const t=m.oxw().$implicit;m.xp6(1),m.hij(" ",t.verboseName||t.id," "),m.xp6(1),m.Q6J("ngIf",t.help),m.xp6(2),m.Q6J("formControlName","extra__"+t.id),m.xp6(2),m.Q6J("formControlName","extra__"+t.id)}}function En(t,e){if(1&t&&(m.TgZ(0,"app-help",16),m._UZ(1,"div",17),m.qZA()),2&t){const t=m.oxw(2).$implicit;m.Q6J("dialogTitle",t.verboseName||t.id),m.xp6(1),m.Q6J("innerHTML",t.help,m.oJD)}}function Ln(t,e){if(1&t&&(m.TgZ(0,"label"),m._uU(1),m.YNc(2,En,2,2,"app-help",13),m._UZ(3,"input",18),m.qZA()),2&t){const t=m.oxw().$implicit;m.xp6(1),m.hij(" ",t.verboseName||t.id," "),m.xp6(1),m.Q6J("ngIf",t.help),m.xp6(1),m.Q6J("formControlName","extra__"+t.id)}}function Fn(t,e){if(1&t&&(m.ynx(0),m.ynx(1,10),m.YNc(2,Pn,8,4,"label",11),m.YNc(3,Ln,4,3,"label",12),m.BQk(),m._UZ(4,"br"),m.BQk()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngSwitch",t.type),m.xp6(1),m.Q6J("ngSwitchCase","BOOLEAN")}}function Bn(t,e){if(1&t&&(m.ynx(0),m.YNc(1,Fn,5,2,"ng-container",1),m.BQk()),2&t){const t=m.oxw();m.xp6(1),m.Q6J("ngForOf",t.commandOptions)}}function Rn(t,e){let n={};for(let i=0;i<e.name.length;i++){const a=e.name[i],o=e.value[i];"AGGREGATE"===o.type?n=Object.assign(Object.assign({},n),Rn(t+a+".",o.aggregateValue)):n[t+a]=jn(o)}return n}function jn(t){switch(t.type){case"BOOLEAN":return""+t.booleanValue;case"FLOAT":return""+t.floatValue;case"DOUBLE":return""+t.doubleValue;case"UINT32":return""+t.uint32Value;case"SINT32":return""+t.sint32Value;case"BINARY":return W.TR(t.binaryValue);case"ENUMERATED":case"STRING":case"TIMESTAMP":return t.stringValue;case"UINT64":return""+t.uint64Value;case"SINT64":return""+t.sint64Value}}let Hn=(()=>{class t{constructor(t,e){this.arguments=[],this.argumentsWithInitial=[],this.showAll$=new j.X(!1),this.form=new Z.cw({}),this.user=e.getUser(),this.commandOptions=t.getCommandOptions(),this.form.addControl("extra__comment",new Z.NI(""));for(const n of this.commandOptions)this.form.addControl("extra__"+n.id,new Z.NI(""))}ngOnChanges(){var t;this.arguments=[],this.argumentsWithInitial=[],this.showAll$.next(!1);for(const o in this.form.controls)o.startsWith("extra__")||this.form.removeControl(o);this.form.reset();const e=(null===(t=this.templateProvider)||void 0===t?void 0:t.getComment())||"";if(this.form.controls.extra__comment.setValue(e),!this.command)return;const n=[];let i=this.command;for(;i;)n.unshift(i),i=i.baseCommand;const a=new Map;for(const o of n){if(o.argument)for(const t of o.argument){if(this.templateProvider){const e=this.templateProvider.getAssignment(t.name);if(void 0!==e){jn(e)===t.initialValue?this.argumentsWithInitial.push(t):this.arguments.push(t);continue}}void 0!==t.initialValue?this.argumentsWithInitial.push(t):this.arguments.push(t)}if(o.argumentAssignment)for(const t of o.argumentAssignment)a.set(t.name,t.value)}this.arguments=this.arguments.filter(t=>!a.has(t.name)),this.argumentsWithInitial=this.argumentsWithInitial.filter(t=>!a.has(t.name));for(const o of this.arguments)this.addControl(o,this.templateProvider);for(const o of this.argumentsWithInitial)this.addControl(o,this.templateProvider)}getAssignments(){const t=[];for(const e of[...this.arguments,...this.argumentsWithInitial])if("aggregate"===e.type.engType){const n=JSON.stringify(this.getMemberAssignments(e.name+".",e));t.push({name:e.name,value:n})}else{const n=this.form.controls[e.name];this.isArgumentWithInitialValue(e.name)&&!n.touched||t.push({name:e.name,value:this.form.value[e.name]})}return t}getMemberAssignments(t,e){const n={};for(const i of e.type.member||[])if("aggregate"===i.type.engType)n[i.name]=this.getMemberAssignments(t+i.name+".",i);else{const e=this.form.controls[t+i.name];switch(i.type.engType){case"float":case"double":case"integer":n[i.name]=Number(e.value);break;default:n[i.name]=e.value}}return n}getComment(){return this.form.value.extra__comment||void 0}getExtraOptions(){const t={};for(const e in this.form.controls)if(e.startsWith("extra__")&&"extra__comment"!==e){const n=this.form.controls[e];if(null!==n.value){const i=e.replace("extra__","");t[i]=this.toYamcsValue(i,n.value)}}return t}toYamcsValue(t,e){let n;for(const i of this.commandOptions)i.id===t&&(n=i);switch(n.type){case"BOOLEAN":return"true"===e?{type:"BOOLEAN",booleanValue:!0}:{type:"BOOLEAN",booleanValue:!1};case"NUMBER":return{type:"SINT32",sint32Value:Number(e)};default:return{type:"STRING",stringValue:String(e)}}}showCommandOptions(){return this.user.hasSystemPrivilege("CommandOptions")}addControl(t,e){if("aggregate"===t.type.engType)this.addAggregateControl(t,e);else{let n=t.initialValue;if(e){const i=e.getAssignment(t.name);void 0!==i&&(n=jn(i))}void 0===n&&(n="");const i=this.getValidatorsForType(t.type);this.form.addControl(t.name,new Z.NI(n,i))}}addAggregateControl(t,e){if(this.addMemberControls(t.name+".",t.type.member||[]),e){const n=e.getAssignment(t.name);if(void 0!==n&&"AGGREGATE"===n.type){const e=Rn(t.name+".",n.aggregateValue);for(const t in e)t in this.form.controls&&this.form.controls[t].setValue(e[t])}}}addMemberControls(t,e){for(const n of e)if("aggregate"===n.type.engType)this.addMemberControls(t+n.name+".",n.type.member||[]);else{const e=t+n.name,i=this.getValidatorsForType(n.type);this.form.addControl(e,new Z.NI("",i))}}getValidatorsForType(t){const e=[Z.kI.required];return"integer"===t.engType?e.push(gn.V):"float"===t.engType&&e.push(gn.H),void 0!==t.rangeMax&&e.push(Z.kI.max(t.rangeMax)),void 0!==t.rangeMin&&e.push(Z.kI.min(t.rangeMin)),e}isArgumentWithInitialValue(t){for(const e of this.argumentsWithInitial)if(e.name===t)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(l.E),m.Y36(G.e))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-command-form"]],inputs:{command:"command",templateProvider:"templateProvider"},features:[m.TTD],decls:16,vars:11,consts:[[1,"ya-form",3,"formGroup"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"hint"],["formControlName","extra__comment","rows","3",2,"width","100%","resize","none"],[3,"argument","formGroup"],["class","hasInitial",4,"ngIf"],[1,"hasInitial",3,"argument","formGroup"],[1,"hasInitial"],["icon","double_arrow",3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"dialogTitle",4,"ngIf"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],[3,"dialogTitle"],[3,"innerHTML"],["type","text",3,"formControlName"]],template:function(t,e){1&t&&(m.TgZ(0,"form",0),m.ALo(1,"async"),m.YNc(2,In,3,3,"ng-container",1),m.YNc(3,On,3,3,"ng-container",1),m.YNc(4,$n,6,3,"ng-container",2),m.ALo(5,"async"),m.TgZ(6,"p"),m._uU(7,"\xa0"),m.qZA(),m.TgZ(8,"h3"),m._uU(9,"Options"),m.qZA(),m.YNc(10,Bn,2,1,"ng-container",2),m.TgZ(11,"label"),m._uU(12," Comment "),m.TgZ(13,"span",3),m._uU(14,"(optional)"),m.qZA(),m._UZ(15,"textarea",4),m.qZA(),m.qZA()),2&t&&(m.ekj("showAll",m.lcZ(1,7,e.showAll$)),m.Q6J("formGroup",e.form),m.xp6(2),m.Q6J("ngForOf",e.arguments),m.xp6(1),m.Q6J("ngForOf",e.argumentsWithInitial),m.xp6(1),m.Q6J("ngIf",e.argumentsWithInitial.length&&!m.lcZ(5,9,e.showAll$)),m.xp6(6),m.Q6J("ngIf",e.showCommandOptions()))},directives:[Z._Y,Z.JL,Z.sg,k.sg,k.O5,Z.Fj,Z.JJ,Z.u,Un,Qn.l,k.RF,k.n9,k.ED,Z._,C.W],pipes:[k.Ov],styles:[".hasInitial[_ngcontent-%COMP%]{display:none}.showAll[_ngcontent-%COMP%]   .hasInitial[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),t})();var Vn=n(2420),Gn=n(8393),Wn=n(5700),Xn=n(4145),zn=n(3032),Kn=n(9572),ti=n(6927),ei=n(3123);const ni=["commandForm"],ii=["another"];function ai(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"dt"),m._uU(2),m.qZA(),m.TgZ(3,"dd"),m._uU(4),m.qZA(),m.BQk()),2&t){const t=e.$implicit;m.xp6(2),m.Oqu(t.namespace),m.xp6(2),m.Oqu(t.name)}}function oi(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"dt"),m._uU(2,"Description"),m.qZA(),m.TgZ(3,"dd"),m._UZ(4,"app-markdown",14),m.qZA(),m.BQk()),2&t){const t=m.oxw(2).ngIf;m.xp6(4),m.Q6J("text",t.longDescription)}}function ci(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"dt"),m._uU(2,"Description"),m.qZA(),m.TgZ(3,"dd"),m._uU(4),m.qZA(),m.BQk()),2&t){const t=m.oxw(2).ngIf;m.xp6(4),m.hij(" ",t.shortDescription||"-"," ")}}function si(t,e){if(1&t&&(m.ynx(0),m.YNc(1,oi,5,1,"ng-container",3),m.YNc(2,ci,5,1,"ng-container",3),m.BQk()),2&t){const t=m.oxw().ngIf;m.xp6(1),m.Q6J("ngIf",t.longDescription),m.xp6(1),m.Q6J("ngIf",!t.longDescription)}}function ri(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-significance-level",15),m._uU(2),m.BQk()),2&t){const t=e.ngIf;m.xp6(1),m.Q6J("level",t.consequenceLevel),m.xp6(1),m.hij(" \xa0\xa0",t.reasonForWarning," ")}}function li(t,e){if(1&t&&(m.TgZ(0,"dl",11),m.TgZ(1,"dt"),m._uU(2,"Command"),m.qZA(),m.TgZ(3,"dd"),m._uU(4),m.ALo(5,"shortName"),m.qZA(),m.TgZ(6,"dt"),m._uU(7,"Space system"),m.qZA(),m.TgZ(8,"dd"),m._uU(9),m.ALo(10,"spaceSystemName"),m.qZA(),m.YNc(11,ai,5,2,"ng-container",12),m.YNc(12,si,3,2,"ng-container",3),m.TgZ(13,"dt"),m._uU(14,"Significance"),m.qZA(),m.TgZ(15,"dd"),m.YNc(16,ri,3,2,"ng-container",13),m.ALo(17,"effectiveSignificance"),m.qZA(),m.qZA()),2&t){const t=e.ngIf;m.oxw();const n=m.MAs(31);m.xp6(4),m.Oqu(m.lcZ(5,6,t.qualifiedName)),m.xp6(5),m.Oqu(m.lcZ(10,8,t.qualifiedName)||"-"),m.xp6(2),m.Q6J("ngForOf",t.alias),m.xp6(1),m.Q6J("ngIf",t.longDescription||t.shortDescription),m.xp6(4),m.Q6J("ngIf",m.lcZ(17,10,t))("ngIfElse",n)}}function mi(t,e){1&t&&(m.TgZ(0,"app-warning-message"),m._uU(1," You're not cleared to send this command "),m.qZA())}function ui(t,e){1&t&&(m.TgZ(0,"span",21),m._uU(1," satisfied "),m.qZA())}function di(t,e){1&t&&(m.TgZ(0,"span",22),m._uU(1," not satisfied "),m.qZA())}function pi(t,e){if(1&t&&(m.TgZ(0,"tr"),m.TgZ(1,"td"),m._uU(2),m.qZA(),m.TgZ(3,"td"),m._uU(4),m.qZA(),m.TgZ(5,"td"),m.YNc(6,ui,2,0,"span",17),m.ALo(7,"async"),m.YNc(8,di,2,0,"span",18),m.ALo(9,"async"),m._UZ(10,"app-live-expression",19,20),m.qZA(),m.qZA()),2&t){const t=e.$implicit,n=m.MAs(11);m.xp6(2),m.Oqu(t.expression),m.xp6(2),m.Oqu(t.timeout||"-"),m.xp6(2),m.Q6J("ngIf",!0===m.lcZ(7,7,n.result$)),m.xp6(2),m.Q6J("ngIf",!1===m.lcZ(9,9,n.result$)),m.xp6(2),m.Udp("display","none"),m.Q6J("expression",t.expression)}}function gi(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"p"),m._uU(2,"\xa0"),m.qZA(),m.TgZ(3,"h3"),m._uU(4,"Constraints"),m.qZA(),m.TgZ(5,"table",16),m.TgZ(6,"tr"),m.TgZ(7,"th"),m._uU(8,"Constraint"),m.qZA(),m.TgZ(9,"th"),m._uU(10,"Timeout"),m.qZA(),m.TgZ(11,"th"),m._uU(12,"Live Evaluation"),m.qZA(),m.qZA(),m.YNc(13,pi,12,11,"tr",12),m.qZA(),m.BQk()),2&t){const t=m.oxw().ngIf;m.xp6(13),m.Q6J("ngForOf",t.constraint)}}function fi(t,e){if(1&t&&(m.ynx(0),m.YNc(1,gi,14,1,"ng-container",3),m.BQk()),2&t){const t=e.ngIf;m.xp6(1),m.Q6J("ngIf",t.constraint)}}function hi(t,e){1&t&&(m.TgZ(0,"p"),m._uU(1,"\xa0"),m.qZA())}function Zi(t,e){1&t&&(m.TgZ(0,"h3"),m._uU(1,"Arguments"),m.qZA())}function xi(t,e){if(1&t&&(m.TgZ(0,"mat-slide-toggle",23),m._uU(1," Arm "),m.qZA()),2&t){const t=m.oxw();m.Q6J("formControl",t.armControl)}}function yi(t,e){1&t&&m._uU(0," -\n")}let Ai=(()=>{class t{constructor(t,e,n,i,a,o,c,s,r){this.router=e,this.messageService=i,this.yamcs=a,this.location=o,this.command$=new j.X(null),this.templateProvider$=new j.X(null),this.cleared$=new j.X(!0),this.armControl=new Z.NI,this.config=c.getConfig();const l=t.snapshot.paramMap.get("qualifiedName");n.setTitle(`Send a command: ${l}`);const m=[this.yamcs.yamcsClient.getCommand(this.yamcs.instance,l)],u=t.snapshot.queryParamMap.get("template");if(u){const t=this.yamcs.yamcsClient.getCommandHistoryEntry(this.yamcs.instance,u);m.push(t)}Promise.all(m).then(t=>{const e=t[0];let n;t.length>1&&(n=t[1]),this.command$.next(e),this.templateProvider$.next(n?new bi(n):null),this.config.commandClearances&&(this.connectionInfoSubscription=a.clearance$.subscribe(t=>{const n=r.transform(e);this.cleared$.next(this.isCleared(t,null==n?void 0:n.consequenceLevel))}))})}ngAfterViewInit(){this.config.twoStageCommanding&&(this.commandForm.form.valueChanges.subscribe(()=>{this.armControl.setValue(!1)}),this.commandForm.form.statusChanges.subscribe(()=>{this.commandForm.form.valid?this.armControl.enable():this.armControl.disable()}))}goBack(){this.location.back()}sendCommand(){this.armControl.setValue(!1);const t=this.commandForm.getAssignments(),e=this.commandForm.getComment(),n=this.commandForm.getExtraOptions();this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,this.command$.value.qualifiedName,{assignment:t,comment:e,extra:n}).then(t=>{this.router.navigate(["/commanding/report",t.id],{queryParams:{c:this.yamcs.context}})}).catch(t=>{this.messageService.showError(t)})}isCleared(t,e){if(!t)return!1;switch(t.level){case"SEVERE":if("SEVERE"===e)return!0;case"CRITICAL":if("CRITICAL"===e)return!0;case"DISTRESS":if("DISTRESS"===e)return!0;case"WARNING":if("WARNING"===e)return!0;case"WATCH":if("WATCH"===e)return!0;case"NONE":if("NONE"===e||!e)return!0}return!1}ngOnDestroy(){this.connectionInfoSubscription&&this.connectionInfoSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(a.gz),m.Y36(a.F0),m.Y36(b.Dx),m.Y36(Vn.e),m.Y36(h.C),m.Y36(k.Ye),m.Y36(l.E),m.Y36(G.e),m.Y36(Gn.m))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&(m.Gf(ni,5),m.Gf(ii,5)),2&t){let t;m.iGM(t=m.CRH())&&(e.commandForm=t.first),m.iGM(t=m.CRH())&&(e.anotherChild=t.first)}},decls:32,vars:21,consts:[["step","2"],[1,"form-content"],["class","dl-horizontal no-lead no-trail",4,"ngIf"],[4,"ngIf"],[3,"command","templateProvider"],["commandForm",""],[1,"ya-button",3,"click"],[2,"flex","1 1 auto"],["color","primary",3,"formControl",4,"ngIf"],[1,"ya-button","primary",3,"disabled","click"],["dash",""],[1,"dl-horizontal","no-lead","no-trail"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[3,"text"],[3,"level"],["yaDataTable",""],["class","evaluation valid",4,"ngIf"],["class","evaluation invalid",4,"ngIf"],[3,"expression"],["expr",""],[1,"evaluation","valid"],[1,"evaluation","invalid"],["color","primary",3,"formControl"]],template:function(t,e){if(1&t&&(m.TgZ(0,"app-instance-page"),m.TgZ(1,"app-instance-toolbar"),m._uU(2," Send a command "),m.qZA(),m._UZ(3,"app-send-command-wizard-step",0),m.TgZ(4,"div",1),m.YNc(5,li,18,12,"dl",2),m.ALo(6,"async"),m.YNc(7,mi,2,0,"app-warning-message",3),m.ALo(8,"async"),m.YNc(9,fi,2,1,"ng-container",3),m.ALo(10,"async"),m.YNc(11,hi,2,0,"p",3),m.YNc(12,Zi,2,0,"h3",3),m._UZ(13,"app-command-form",4,5),m.ALo(15,"async"),m.ALo(16,"async"),m.TgZ(17,"p"),m._uU(18,"\xa0"),m.qZA(),m.TgZ(19,"mat-toolbar"),m.TgZ(20,"button",6),m.NdJ("click",function(){return e.goBack()}),m._uU(21," Cancel "),m.qZA(),m._UZ(22,"span",7),m.YNc(23,xi,2,1,"mat-slide-toggle",8),m._uU(24," \xa0\xa0\xa0\xa0 "),m.TgZ(25,"button",9),m.NdJ("click",function(){return e.sendCommand()}),m.ALo(26,"async"),m.TgZ(27,"mat-icon"),m._uU(28,"send"),m.qZA(),m._uU(29," Send "),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.YNc(30,yi,1,0,"ng-template",null,10,m.W1O)),2&t){const t=m.MAs(14);m.xp6(5),m.Q6J("ngIf",m.lcZ(6,9,e.command$)),m.xp6(2),m.Q6J("ngIf",!m.lcZ(8,11,e.cleared$)),m.xp6(2),m.Q6J("ngIf",m.lcZ(10,13,e.command$)),m.xp6(2),m.Q6J("ngIf",t.arguments.length||t.argumentsWithInitial.length),m.xp6(1),m.Q6J("ngIf",t.arguments.length||t.argumentsWithInitial.length),m.xp6(1),m.Q6J("command",m.lcZ(15,15,e.command$))("templateProvider",m.lcZ(16,17,e.templateProvider$)),m.xp6(10),m.Q6J("ngIf",e.config.twoStageCommanding),m.xp6(2),m.Q6J("disabled",e.config.twoStageCommanding&&!e.armControl.value||!m.lcZ(26,19,e.cleared$)||!t.form.valid)}},directives:[T.a,v.k,rn,k.O5,Hn,Kt.Ye,_.Hw,k.sg,Wn.U,y.U,Xn.j,et.O,zn.Q,Kn.Rr,Z.JJ,Z.oH],pipes:[k.Ov,ti.y,ei.B,Gn.m],styles:[".evaluation[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace;background-color:#ffeef0;color:red;padding-left:2px;padding-right:2px}.evaluation.valid[_ngcontent-%COMP%]{background-color:#e6ffed;color:#00c752}"],changeDetection:0}),t})();class bi{constructor(t){this.entry=t}getAssignment(t){if(this.entry.assignment)for(const e of this.entry.assignment)if(e.name===t)return e.value}getComment(){}}var Ti=n(8921),vi=n(2679),Ci=n(3061),qi=n(4626),_i=n(1576);const wi=["top"];function ki(t,e){if(1&t&&m._UZ(0,"app-breadcrumb",12),2&t){const t=e.$implicit;m.Q6J("link",t.route)("queryParams",t.queryParams)("label",t.name)}}const Ni=function(t){return{c:t}};function Ui(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-breadcrumb",10),m.YNc(2,ki,1,3,"app-breadcrumb",11),m.BQk()),2&t){const t=m.oxw().ngIf,e=m.oxw(2);m.xp6(1),m.Q6J("queryParams",m.VKq(2,Ni,e.yamcs.context)),m.xp6(1),m.Q6J("ngForOf",t)}}function Qi(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.TgZ(1,"app-breadcrumb-trail"),m.YNc(2,Ui,3,4,"ng-container",5),m.TgZ(3,"app-search-filter",9),m.NdJ("onArrowDown",function(){return m.CHM(t),m.oxw(2).selectNext()})("onArrowUp",function(){return m.CHM(t),m.oxw(2).selectPrevious()})("onEnter",function(){return m.CHM(t),m.oxw(2).applySelection()}),m.qZA(),m.qZA(),m.BQk()}if(2&t){const t=e.ngIf,n=m.oxw(2);m.xp6(2),m.Q6J("ngIf",t.length),m.xp6(1),m.ekj("pullRight",t.length),m.Q6J("formControl",n.filterControl)}}function Si(t,e){1&t&&(m.TgZ(0,"th",24),m._uU(1,"Significance"),m.qZA())}function Ii(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-significance-level",27),m.BQk()),2&t){const t=e.ngIf;m.xp6(1),m.Q6J("level",t.consequenceLevel)}}function Ji(t,e){if(1&t&&(m.TgZ(0,"td",25),m.YNc(1,Ii,2,1,"ng-container",26),m.ALo(2,"effectiveSignificance"),m.qZA()),2&t){const t=e.$implicit;m.oxw(3);const n=m.MAs(9);m.xp6(1),m.Q6J("ngIf",m.lcZ(2,2,t.command))("ngIfElse",n)}}function Oi(t,e){1&t&&(m.TgZ(0,"th",28),m._uU(1,"Name"),m.qZA())}const Yi=function(){return["/commanding/send"]},Mi=function(t,e){return{c:t,system:e}};function $i(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"mat-icon",30),m._uU(2,"folder"),m.qZA(),m.TgZ(3,"a",31),m._uU(4),m.ALo(5,"filename"),m.qZA(),m.BQk()),2&t){const t=m.oxw().$implicit,e=m.oxw(3);m.xp6(3),m.Q6J("routerLink",m.DdM(5,Yi))("queryParams",m.WLB(6,Mi,e.yamcs.context,t.name)),m.xp6(1),m.hij(" ",m.lcZ(5,3,t.name),"/ ")}}function Di(t,e){if(1&t&&m._UZ(0,"app-highlight",33),2&t){const t=m.oxw(2).$implicit,e=m.oxw(3);m.Q6J("text",t.command.qualifiedName)("term",e.filterControl.value)}}function Pi(t,e){if(1&t&&(m._UZ(0,"app-highlight",33),m.ALo(1,"slice")),2&t){const t=m.oxw(2).$implicit,e=m.oxw(3);m.Q6J("text",m.xi3(1,2,t.command.qualifiedName,e.system.length+1))("term",e.filterControl.value)}}const Ei=function(t){return["/commanding/send",t]};function Li(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"mat-icon",30),m._uU(2,"rss_feed"),m.qZA(),m.TgZ(3,"a",31),m.YNc(4,Di,1,2,"app-highlight",32),m.YNc(5,Pi,2,5,"app-highlight",32),m.qZA(),m.BQk()),2&t){const t=m.oxw().$implicit,e=m.oxw(3);m.xp6(3),m.Q6J("routerLink",m.VKq(4,Ei,t.command.qualifiedName))("queryParams",m.VKq(6,Ni,e.yamcs.context)),m.xp6(1),m.Q6J("ngIf",!e.system),m.xp6(1),m.Q6J("ngIf",e.system)}}function Fi(t,e){if(1&t&&(m.TgZ(0,"td",29),m.YNc(1,$i,6,9,"ng-container",5),m.YNc(2,Li,6,8,"ng-container",5),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf",t.spaceSystem),m.xp6(1),m.Q6J("ngIf",!t.spaceSystem)}}function Bi(t,e){1&t&&(m.TgZ(0,"th",34),m._uU(1,"Description"),m.qZA())}function Ri(t,e){if(1&t&&(m.TgZ(0,"td",25),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",(null==t.command?null:t.command.shortDescription)||"-"," ")}}function ji(t,e){1&t&&m._UZ(0,"tr",35)}function Hi(t,e){if(1&t&&m._UZ(0,"tr",36),2&t){const t=e.$implicit,n=m.oxw(3);m.ekj("selected",n.selection.isSelected(t))}}function Vi(t,e){if(1&t&&(m.TgZ(0,"table",13),m.ynx(1,14),m.YNc(2,Si,2,0,"th",15),m.YNc(3,Ji,3,4,"td",16),m.BQk(),m.ynx(4,17),m.YNc(5,Oi,2,0,"th",18),m.YNc(6,Fi,3,2,"td",19),m.BQk(),m.ynx(7,20),m.YNc(8,Bi,2,0,"th",21),m.YNc(9,Ri,2,1,"td",16),m.BQk(),m.YNc(10,ji,1,0,"tr",22),m.YNc(11,Hi,1,2,"tr",23),m.qZA()),2&t){const t=m.oxw(2);m.Q6J("dataSource",t.dataSource),m.xp6(10),m.Q6J("cdkHeaderRowDef",t.displayedColumns),m.xp6(1),m.Q6J("cdkRowDefColumns",t.displayedColumns)}}function Gi(t,e){1&t&&(m.ynx(0),m._uU(1,"replay"),m.BQk())}function Wi(t,e){if(1&t&&(m.TgZ(0,"app-empty-message",37),m.TgZ(1,"p"),m._uU(2," You are connected to the "),m.YNc(3,Gi,2,0,"ng-container",5),m._uU(4," processor "),m.TgZ(5,"strong"),m._uU(6),m.qZA(),m._uU(7,". "),m.qZA(),m.TgZ(8,"p"),m._uU(9," This processor does not support commanding. "),m.qZA(),m.qZA()),2&t){const t=m.oxw().ngIf;m.xp6(3),m.Q6J("ngIf",null==t.processor?null:t.processor.replay),m.xp6(3),m.Oqu(null==t.processor?null:t.processor.name)}}function Xi(t,e){if(1&t&&(m.TgZ(0,"div",4),m.TgZ(1,"div"),m.YNc(2,Qi,4,4,"ng-container",5),m.ALo(3,"async"),m.YNc(4,Vi,12,3,"table",6),m._UZ(5,"mat-paginator",7),m.ALo(6,"async"),m.qZA(),m.YNc(7,Wi,10,2,"app-empty-message",8),m.qZA()),2&t){const t=e.ngIf,n=m.oxw();m.xp6(1),m.ekj("noDisplay",!(null!=t.processor&&t.processor.hasCommanding)),m.xp6(1),m.Q6J("ngIf",m.lcZ(3,9,n.breadcrumb$)),m.xp6(2),m.Q6J("ngIf",n.dataSource),m.xp6(1),m.Q6J("pageSize",n.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",m.lcZ(6,11,n.dataSource.totalSize$)),m.xp6(2),m.Q6J("ngIf",!(null!=t.processor&&t.processor.hasCommanding))}}function zi(t,e){1&t&&m._uU(0," -\n")}let Ki=(()=>{class t{constructor(t,e,n,i){this.yamcs=e,this.route=n,this.router=i,this.pageSize=100,this.system=null,this.breadcrumb$=new j.X([]),this.filterControl=new Z.NI,this.displayedColumns=["name","significance","shortDescription"],this.selection=new d.Ov(!1),t.setTitle("Send a command"),this.connectionInfo$=e.connectionInfo$,this.dataSource=new Ti.S(e)}ngAfterViewInit(){this.filterControl.setValue(this.route.snapshot.queryParamMap.get("filter")),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(t=>{t.get("system")!==this.system&&this.changeSystem(t)}),this.filterControl.valueChanges.subscribe(()=>{this.paginator.pageIndex=0,this.updateDataSource()}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(t){this.system=t.get("system"),this.updateBrowsePath(),this.paginator.pageIndex=t.has("page")?Number(t.get("page")):0,this.updateDataSource()}updateDataSource(){this.updateURL();const t={system:this.system||"/",noAbstract:!0,details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize},e=this.filterControl.value;e&&(t.q=e.toLowerCase()),this.dataSource.loadCommands(t).then(()=>{this.selection.clear(),this.updateBrowsePath()})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filterControl.value||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){const t=[];let e="";if(this.system)for(const n of this.system.slice(1).split("/"))e+="/"+n,t.push({name:n,route:"/commanding/send",queryParams:{system:e,c:this.yamcs.context}});this.breadcrumb$.next(t)}selectNext(){const t=this.dataSource.items$.value;let e=0;if(this.selection.hasValue()){const n=this.selection.selected[0];-1!==t.indexOf(n)&&(e=Math.min(t.indexOf(n)+1,t.length-1))}this.selection.select(t[e])}selectPrevious(){const t=this.dataSource.items$.value;let e=0;if(this.selection.hasValue()){const n=this.selection.selected[0];-1!==t.indexOf(n)&&(e=Math.max(t.indexOf(n)-1,0))}this.selection.select(t[e])}applySelection(){var t;if(this.selection.hasValue()){const e=this.selection.selected[0],n=this.dataSource.items$.value;e.command&&-1!==n.indexOf(e)&&this.router.navigate(["/commanding/send",null===(t=e.command)||void 0===t?void 0:t.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription&&this.queryParamMapSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(b.Dx),m.Y36(h.C),m.Y36(a.gz),m.Y36(a.F0))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&(m.Gf(wi,7),m.Gf(p.NW,5)),2&t){let t;m.iGM(t=m.CRH())&&(e.top=t.first),m.iGM(t=m.CRH())&&(e.paginator=t.first)}},decls:10,vars:3,consts:[["top",""],["step","1"],["class","panel-content",4,"ngIf"],["dash",""],[1,"panel-content"],[4,"ngIf"],["mat-table","","class","ya-data-table","style","width: 100%",3,"dataSource",4,"ngIf"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["headerTitle","Send a command",4,"ngIf"],["placeholder","Search by name","icon","search",3,"formControl","onArrowDown","onArrowUp","onEnter"],["link","/commanding/send","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table",2,"width","100%",3,"dataSource"],["matColumnDef","significance"],["mat-header-cell","","style","width: 1px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["cdkColumnDef","name"],["mat-header-cell","","style","width: 400px",4,"cdkHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","shortDescription"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",2,"width","1px"],["mat-cell",""],[4,"ngIf","ngIfElse"],[3,"level"],["mat-header-cell","",2,"width","400px"],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],[3,"routerLink","queryParams"],[3,"text","term",4,"ngIf"],[3,"text","term"],["mat-header-cell",""],["mat-header-row",""],["mat-row",""],["headerTitle","Send a command"]],template:function(t,e){1&t&&(m.TgZ(0,"app-instance-page"),m.TgZ(1,"app-instance-toolbar"),m._uU(2," Send a command "),m.qZA(),m._UZ(3,"span",null,0),m._UZ(5,"app-send-command-wizard-step",1),m.YNc(6,Xi,8,13,"div",2),m.ALo(7,"async"),m.qZA(),m.YNc(8,zi,1,0,"ng-template",null,3,m.W1O)),2&t&&(m.xp6(6),m.Q6J("ngIf",m.lcZ(7,1,e.connectionInfo$)))},directives:[T.a,v.k,rn,k.O5,p.NW,vi.w,Wt.a,Z.JJ,Z.oH,Ci.a,k.sg,f.BZ,f.w1,f.fO,f.Dz,N.fo,N.D5,N.s$,N.Sq,f.ge,f.ev,y.U,_.Hw,a.yS,ne.y,f.XQ,f.Gk,qi.M],pipes:[k.Ov,Gn.m,_i.X,k.OU],styles:[".pullRight[_ngcontent-%COMP%]{float:right}.primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0}),t})();var ta=n(2532);function ea(t,e){1&t&&(m.TgZ(0,"th",18),m._uU(1,"#"),m.qZA())}function na(t,e){if(1&t&&(m.TgZ(0,"td",19),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.order," ")}}function ia(t,e){1&t&&(m.TgZ(0,"th",20),m._uU(1,"Name"),m.qZA())}function aa(t,e){if(1&t&&(m.TgZ(0,"td",19),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.name," ")}}function oa(t,e){1&t&&(m.TgZ(0,"th",20),m._uU(1,"Issuer"),m.qZA())}function ca(t,e){if(1&t&&(m.TgZ(0,"app-label",24),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Oqu(t)}}function sa(t,e){if(1&t&&(m.TgZ(0,"app-label",25),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Oqu(t)}}function ra(t,e){1&t&&(m.ynx(0),m._uU(1,"-"),m.BQk())}function la(t,e){if(1&t&&(m.TgZ(0,"td",19),m.YNc(1,ca,2,1,"app-label",21),m.YNc(2,sa,2,1,"app-label",22),m.YNc(3,ra,2,0,"ng-container",23),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngForOf",t.groups),m.xp6(1),m.Q6J("ngForOf",t.users),m.xp6(1),m.Q6J("ngIf",!t.groups&&!t.users)}}function ma(t,e){1&t&&(m.TgZ(0,"th",26),m._uU(1,"Min.\xa0level"),m.qZA())}function ua(t,e){if(1&t&&(m.TgZ(0,"td",19),m._UZ(1,"app-significance-level",27),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("level",t.minLevel)("grayscale",!0)}}function da(t,e){1&t&&(m.TgZ(0,"th",26),m._uU(1,"Action"),m.qZA())}function pa(t,e){1&t&&(m.TgZ(0,"span"),m._uU(1," ACCEPT "),m.qZA())}function ga(t,e){if(1&t&&(m.TgZ(0,"span"),m.ALo(1,"async"),m._uU(2," HOLD "),m.qZA()),2&t){const t=m.oxw(3);m.Udp("visibility",m.lcZ(1,2,t.visibility$)?"visible":"hidden")}}function fa(t,e){1&t&&(m.TgZ(0,"span"),m._uU(1," REJECT "),m.qZA())}function ha(t,e){if(1&t&&(m.TgZ(0,"td",19),m.YNc(1,pa,2,0,"span",23),m.YNc(2,ga,3,4,"span",28),m.YNc(3,fa,2,0,"span",23),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf","ENABLED"===t.state),m.xp6(1),m.Q6J("ngIf","BLOCKED"===t.state),m.xp6(1),m.Q6J("ngIf","DISABLED"===t.state)}}function Za(t,e){1&t&&(m.TgZ(0,"th",29),m._uU(1,"Pending"),m.qZA())}function xa(t,e){if(1&t&&(m.TgZ(0,"td",30),m._uU(1),m.ALo(2,"number"),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",m.lcZ(2,1,(null==t.entry?null:t.entry.length)||0)," ")}}function ya(t,e){1&t&&m._UZ(0,"th",31)}function Aa(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"td",19),m.TgZ(1,"mat-menu",32,33),m.TgZ(3,"button",34),m._uU(4," Change action "),m.qZA(),m.qZA(),m.TgZ(5,"mat-menu",35,36),m.TgZ(7,"button",37),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw(2).enableQueue(e)}),m.TgZ(8,"mat-icon"),m._uU(9,"check"),m.qZA(),m._uU(10," ACCEPT "),m.qZA(),m.TgZ(11,"button",37),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw(2).blockQueue(e)}),m.TgZ(12,"mat-icon"),m._uU(13,"pause"),m.qZA(),m._uU(14," HOLD "),m.qZA(),m.TgZ(15,"button",37),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw(2).disableQueue(e)}),m.TgZ(16,"mat-icon"),m._uU(17,"close"),m.qZA(),m._uU(18," REJECT "),m.qZA(),m.qZA(),m.TgZ(19,"button",38),m.NdJ("click",function(t){return t.stopPropagation()}),m.TgZ(20,"mat-icon"),m._uU(21,"more_vert"),m.qZA(),m.qZA(),m.qZA()}if(2&t){const t=m.MAs(2),e=m.MAs(6);m.xp6(3),m.Q6J("matMenuTriggerFor",e),m.xp6(16),m.Q6J("matMenuTriggerFor",t)}}function ba(t,e){1&t&&m._UZ(0,"tr",39)}function Ta(t,e){1&t&&m._UZ(0,"tr",40)}function va(t,e){if(1&t&&(m.TgZ(0,"table",1),m.ynx(1,2),m.YNc(2,ea,2,0,"th",3),m.YNc(3,na,2,1,"td",4),m.BQk(),m.ynx(4,5),m.YNc(5,ia,2,0,"th",6),m.YNc(6,aa,2,1,"td",4),m.BQk(),m.ynx(7,7),m.YNc(8,oa,2,0,"th",6),m.YNc(9,la,4,3,"td",4),m.BQk(),m.ynx(10,8),m.YNc(11,ma,2,0,"th",9),m.YNc(12,ua,2,2,"td",4),m.BQk(),m.ynx(13,10),m.YNc(14,da,2,0,"th",9),m.YNc(15,ha,4,3,"td",4),m.BQk(),m.ynx(16,11),m.YNc(17,Za,2,0,"th",12),m.YNc(18,xa,3,3,"td",13),m.BQk(),m.ynx(19,14),m.YNc(20,ya,1,0,"th",15),m.YNc(21,Aa,22,2,"td",4),m.BQk(),m.YNc(22,ba,1,0,"tr",16),m.YNc(23,Ta,1,0,"tr",17),m.qZA()),2&t){const t=m.oxw();m.Q6J("dataSource",t.dataSource)("trackBy",t.tableTrackerFn),m.xp6(22),m.Q6J("matHeaderRowDef",t.displayedColumns),m.xp6(1),m.Q6J("matRowDefColumns",t.displayedColumns)}}let Ca=(()=>{class t{constructor(t,e,n){this.yamcs=t,this.changeDetection=e,this.dataSource=new f.by,this.displayedColumns=["order","name","issuer","level","action","pending","actions"],this.visibility$=new j.X(!0),this.tableTrackerFn=(t,e)=>e.name,this.syncSubscription=n.syncFast(()=>{this.visibility$.next(!this.visibility$.value)})}ngAfterViewInit(){this.cqueues$.subscribe(t=>{this.dataSource.data=t,this.changeDetection.detectChanges()})}enableQueue(t){var e;const n=(null===(e=t.entry)||void 0===e?void 0:e.length)||0;let i="Are you sure you want to change this queue's action to ACCEPT?\n\n";i+=1===n?`There is ${n} queued command that will be accepted immediately.`:`There are ${n} queued commands that will be accepted immediately.`,n&&!confirm(i)||this.yamcs.yamcsClient.editCommandQueue(t.instance,t.processorName,t.name,{state:"enabled"})}disableQueue(t){var e;const n=(null===(e=t.entry)||void 0===e?void 0:e.length)||0;let i="Are you sure you want to change this queue's action to REJECT?\n\n";i+=1===n?`There is ${n} queued command that will be rejected immediately.`:`There are ${n} queued commands that will be rejected immediately.`,n&&!confirm(i)||this.yamcs.yamcsClient.editCommandQueue(t.instance,t.processorName,t.name,{state:"disabled"})}blockQueue(t){this.yamcs.yamcsClient.editCommandQueue(t.instance,t.processorName,t.name,{state:"blocked"})}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(h.C),m.Y36(m.sBO),m.Y36(Rt.j))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-queues-table"]],inputs:{cqueues$:"cqueues$"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table",3,"dataSource","trackBy",4,"ngIf"],["mat-table","",1,"ya-data-table",3,"dataSource","trackBy"],["matColumnDef","order"],["mat-header-cell","","style","width: 1px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","style","width: 200px",4,"matHeaderCellDef"],["matColumnDef","issuer"],["matColumnDef","level"],["mat-header-cell","","style","width: 100px",4,"matHeaderCellDef"],["matColumnDef","action"],["matColumnDef","pending"],["mat-header-cell","","width","1",4,"matHeaderCellDef"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"width","1px"],["mat-cell",""],["mat-header-cell","",2,"width","200px"],["icon","people",4,"ngFor","ngForOf"],["icon","person",4,"ngFor","ngForOf"],[4,"ngIf"],["icon","people"],["icon","person"],["mat-header-cell","",2,"width","100px"],[3,"level","grayscale"],[3,"visibility",4,"ngIf"],["mat-header-cell","","width","1"],["mat-cell","",2,"text-align","center"],["mat-header-cell",""],["overlapTrigger","false",1,"ya-menu"],["queueMenu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],[1,"ya-menu"],["actions","matMenu"],["mat-menu-item","",3,"click"],["mat-button","",1,"icon",3,"matMenuTriggerFor","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&m.YNc(0,va,24,4,"table",0),2&t&&m.Q6J("ngIf",e.dataSource)},directives:[k.O5,f.BZ,f.w1,f.fO,f.Dz,f.as,f.nj,f.ge,f.ev,k.sg,ta._,y.U,Ht.VK,Ht.OP,Ht.p6,_.Hw,q.lW,f.XQ,f.Gk],pipes:[k.Ov,k.JJ],encapsulation:2,changeDetection:0}),t})();function qa(t,e){1&t&&(m.TgZ(0,"th",19),m._uU(1,"Time"),m.qZA())}function _a(t,e){if(1&t&&(m.TgZ(0,"td",20),m._uU(1),m.ALo(2,"datetime"),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",m.lcZ(2,1,t.generationTime)," ")}}function wa(t,e){1&t&&(m.TgZ(0,"th",21),m.TgZ(1,"mat-icon",22),m._uU(2,"comment"),m.qZA(),m.qZA())}function ka(t,e){if(1&t&&(m.TgZ(0,"mat-icon",26),m._uU(1,"comment"),m.qZA()),2&t){const t=m.oxw().$implicit;m.Q6J("matTooltip",t.comment)}}function Na(t,e){1&t&&(m.ynx(0),m._uU(1,"-"),m.BQk())}function Ua(t,e){if(1&t&&(m.TgZ(0,"td",23),m.YNc(1,ka,2,1,"mat-icon",24),m.YNc(2,Na,2,0,"ng-container",25),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf",t.comment),m.xp6(1),m.Q6J("ngIf",!t.comment)}}function Qa(t,e){1&t&&(m.TgZ(0,"th",27),m._uU(1,"Command"),m.qZA())}function Sa(t,e){if(1&t&&(m.TgZ(0,"td",20),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.commandName||"-"," ")}}function Ia(t,e){1&t&&(m.TgZ(0,"th",27),m._uU(1,"Queue"),m.qZA())}function Ja(t,e){if(1&t&&(m.TgZ(0,"td",20),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.queueName||"-"," ")}}function Oa(t,e){1&t&&(m.TgZ(0,"th",27),m._uU(1,"Issuer"),m.qZA())}function Ya(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1),m.qZA()),2&t){const t=m.oxw().$implicit;m.xp6(1),m.hij("@",t.origin,"")}}function Ma(t,e){if(1&t&&(m.TgZ(0,"td",20),m._uU(1),m.YNc(2,Ya,2,1,"span",25),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.username,""),m.xp6(1),m.Q6J("ngIf",t.origin)}}function $a(t,e){1&t&&(m.TgZ(0,"th",27),m._uU(1,"Source"),m.qZA())}function Da(t,e){if(1&t&&(m.TgZ(0,"td",20),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.origin||"-"," ")}}function Pa(t,e){1&t&&(m.TgZ(0,"th",28),m._uU(1,"Command"),m.qZA())}function Ea(t,e){if(1&t&&(m.TgZ(0,"td",20),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",t.source||"-"," ")}}function La(t,e){1&t&&(m.TgZ(0,"th",29),m._uU(1,"Actions"),m.qZA())}function Fa(t,e){1&t&&(m.TgZ(0,"span",31),m.TgZ(1,"mat-icon",32),m._uU(2,"cached"),m.qZA(),m._uU(3," Checking transmission constraints "),m.qZA())}function Ba(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.TgZ(1,"app-text-action",33),m.NdJ("click",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw(2).releaseEntry(e)}),m._uU(2,"ACCEPT"),m.qZA(),m.TgZ(3,"app-text-action",34),m.NdJ("click",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw(2).rejectEntry(e)}),m._uU(4,"REJECT"),m.qZA(),m.BQk()}if(2&t){const t=m.oxw().$implicit;m.xp6(1),m.Q6J("disabled",t.pendingTransmissionConstraints),m.xp6(2),m.Q6J("disabled",t.pendingTransmissionConstraints)}}function Ra(t,e){if(1&t&&(m.TgZ(0,"td",20),m.YNc(1,Fa,4,0,"span",30),m.YNc(2,Ba,5,2,"ng-container",25),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf",t.pendingTransmissionConstraints),m.xp6(1),m.Q6J("ngIf",!t.pendingTransmissionConstraints)}}function ja(t,e){1&t&&m._UZ(0,"tr",35)}function Ha(t,e){1&t&&m._UZ(0,"tr",36)}function Va(t,e){if(1&t&&(m.TgZ(0,"table",1),m.ynx(1,2),m.YNc(2,qa,2,0,"th",3),m.YNc(3,_a,3,3,"td",4),m.BQk(),m.ynx(4,5),m.YNc(5,wa,3,0,"th",6),m.YNc(6,Ua,3,2,"td",7),m.BQk(),m.ynx(7,8),m.YNc(8,Qa,2,0,"th",9),m.YNc(9,Sa,2,1,"td",4),m.BQk(),m.ynx(10,10),m.YNc(11,Ia,2,0,"th",9),m.YNc(12,Ja,2,1,"td",4),m.BQk(),m.ynx(13,11),m.YNc(14,Oa,2,0,"th",9),m.YNc(15,Ma,3,2,"td",4),m.BQk(),m.ynx(16,12),m.YNc(17,$a,2,0,"th",9),m.YNc(18,Da,2,1,"td",4),m.BQk(),m.ynx(19,13),m.YNc(20,Pa,2,0,"th",14),m.YNc(21,Ea,2,1,"td",4),m.BQk(),m.ynx(22,15),m.YNc(23,La,2,0,"th",16),m.YNc(24,Ra,3,2,"td",4),m.BQk(),m.YNc(25,ja,1,0,"tr",17),m.YNc(26,Ha,1,0,"tr",18),m.qZA()),2&t){const t=m.oxw();m.Q6J("dataSource",t.dataSource),m.xp6(25),m.Q6J("matHeaderRowDef",t.displayedColumns),m.xp6(1),m.Q6J("matRowDefColumns",t.displayedColumns)}}let Ga=(()=>{class t{constructor(t){this.yamcs=t,this.dataSource=new f.by,this.displayedColumns=["generationTime","comment","source","queueName","issuer","actions"]}ngAfterViewInit(){this.dataSource.sort=this.sort,this.cqueues$.subscribe(t=>{const e=[];for(const n of t)n.entry&&e.push(...n.entry);this.dataSource.data=e})}releaseEntry(t){confirm(`Are you sure you want to accept this command?\n\n ${t.source}`)&&this.yamcs.yamcsClient.editCommandQueueEntry(t.instance,t.processorName,t.queueName,t.uuid,{state:"released"})}rejectEntry(t){confirm(`Are you sure you want to reject this command?\n\n ${t.source}`)&&this.yamcs.yamcsClient.editCommandQueueEntry(t.instance,t.processorName,t.queueName,t.uuid,{state:"rejected"})}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(h.C))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-queued-commands-table"]],viewQuery:function(t,e){if(1&t&&m.Gf(g.YE,5),2&t){let t;m.iGM(t=m.CRH())&&(e.sort=t.first)}},inputs:{cqueues$:"cqueues$"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table","matSort","","matSortActive","generationTime","matSortDirection","asc","matSortDisableClear","",3,"dataSource",4,"ngIf"],["mat-table","","matSort","","matSortActive","generationTime","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table",3,"dataSource"],["matColumnDef","generationTime"],["mat-header-cell","","mat-sort-header","","style","width: 200px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","comment"],["mat-header-cell","","style","width: 30px; text-align: center",4,"matHeaderCellDef"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","commandName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","queueName"],["matColumnDef","issuer"],["matColumnDef","origin"],["matColumnDef","source"],["mat-header-cell","","mat-sort-header","","style","width: 350px",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","",2,"width","200px"],["mat-cell",""],["mat-header-cell","",2,"width","30px","text-align","center"],["matTooltip","Comment"],["mat-cell","",2,"text-align","center"],[3,"matTooltip",4,"ngIf"],[4,"ngIf"],[3,"matTooltip"],["mat-header-cell","","mat-sort-header",""],["mat-header-cell","","mat-sort-header","",2,"width","350px"],["mat-header-cell",""],["style","color: #999",4,"ngIf"],[2,"color","#999"],[1,"icon16","spin",2,"vertical-align","middle"],["icon","check",3,"disabled","click"],["icon","close",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&m.YNc(0,Va,27,3,"table",0),2&t&&m.Q6J("ngIf",e.dataSource)},directives:[k.O5,f.BZ,g.YE,f.w1,f.fO,f.Dz,f.as,f.nj,f.ge,g.nU,f.ev,_.Hw,nt.gM,Qn.l,f.XQ,f.Gk],pipes:[U.i],encapsulation:2,changeDetection:0}),t})();function Wa(t,e){if(1&t&&m._UZ(0,"app-queued-commands-table",5),2&t){const t=m.oxw(2);m.Q6J("cqueues$",t.cqueues$)}}function Xa(t,e){1&t&&m._uU(0," All queues are empty. ")}function za(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-queues-table",5),m.TgZ(2,"p"),m._uU(3,"\xa0"),m.qZA(),m.TgZ(4,"h2"),m._uU(5,"Pending commands"),m.qZA(),m.YNc(6,Wa,1,1,"app-queued-commands-table",6),m.YNc(7,Xa,1,0,"ng-template",null,7,m.W1O),m.BQk()),2&t){const t=m.MAs(8),e=m.oxw();m.xp6(1),m.Q6J("cqueues$",e.cqueues$),m.xp6(5),m.Q6J("ngIf",e.hasEntries())("ngIfElse",t)}}function Ka(t,e){1&t&&(m.ynx(0),m._uU(1,"replay"),m.BQk())}function to(t,e){if(1&t&&(m.TgZ(0,"app-empty-message",9),m.TgZ(1,"p"),m._uU(2," You are connected to the "),m.YNc(3,Ka,2,0,"ng-container",10),m._uU(4," processor "),m.TgZ(5,"strong"),m._uU(6),m.qZA(),m._uU(7,". "),m.qZA(),m.TgZ(8,"p"),m._uU(9," This processor does not support commanding. "),m.qZA(),m.qZA()),2&t){const t=e.ngIf;m.xp6(3),m.Q6J("ngIf",null==t.processor?null:t.processor.replay),m.xp6(3),m.Oqu(null==t.processor?null:t.processor.name)}}function eo(t,e){if(1&t&&(m.YNc(0,to,10,2,"app-empty-message",8),m.ALo(1,"async")),2&t){const t=m.oxw();m.Q6J("ngIf",m.lcZ(1,1,t.connectionInfo$))}}let no=(()=>{class t{constructor(t,e){this.cqueues$=new j.X([]),this.cqueueByName={},e.setTitle("Queues"),this.connectionInfo$=t.connectionInfo$,t.yamcsClient.getCommandQueues(t.instance,t.processor).then(t=>{for(const e of t)this.cqueueByName[e.name]=e;this.emitChange()}),this.queueSubscription=t.yamcsClient.createQueueStatisticsSubscription({instance:t.instance,processor:t.processor},t=>{const e=this.cqueueByName[t.name];e&&(t.entry=e.entry,this.cqueueByName[t.name]=t,this.emitChange())}),this.queueEventSubscription=t.yamcsClient.createQueueEventsSubscription({instance:t.instance,processor:t.processor},t=>{const e=this.cqueueByName[t.data.queueName];if(e){if("COMMAND_ADDED"===t.type)e.entry=e.entry||[],e.entry.push(t.data);else if("COMMAND_UPDATED"===t.type){const n=(e.entry||[]).findIndex(e=>e.uuid===t.data.uuid);-1!==n&&(e.entry[n]=t.data)}else if("COMMAND_REJECTED"===t.type)e.entry=e.entry||[],e.entry=e.entry.filter(e=>e.uuid!==t.data.uuid);else{if("COMMAND_SENT"!==t.type)throw new Error(`Unexpected queue event ${t.type}`);e.entry=e.entry||[],e.entry=e.entry.filter(e=>e.uuid!==t.data.uuid)}this.emitChange()}else console.warn("Received an event for an unknown queue",t)})}hasEntries(){for(const t of this.cqueues$.getValue())if(t.entry&&t.entry.length)return!0;return!1}emitChange(){this.cqueues$.next(Object.values(this.cqueueByName))}ngOnDestroy(){this.queueSubscription&&this.queueSubscription.cancel(),this.queueEventSubscription&&this.queueEventSubscription.cancel()}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(h.C),m.Y36(b.Dx))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],decls:31,vars:4,consts:[[1,"ya-data-table"],["width","1"],[1,"panel-content"],[4,"ngIf","ngIfElse"],["noCommanding",""],[3,"cqueues$"],[3,"cqueues$",4,"ngIf","ngIfElse"],["empty",""],["headerTitle","Queues",4,"ngIf"],["headerTitle","Queues"],[4,"ngIf"]],template:function(t,e){if(1&t&&(m.TgZ(0,"app-instance-page"),m.TgZ(1,"app-instance-toolbar"),m._uU(2," Queues "),m.TgZ(3,"app-help"),m.TgZ(4,"p"),m._uU(5," A queue is a temporary holding location for issued commands that are waiting to enter the next stage of processing. "),m.qZA(),m.TgZ(6,"p"),m._uU(7," Queues are an ordered list. Issued commands are offered to the first matching queue. "),m.qZA(),m.TgZ(8,"p"),m._uU(9," A queue can perform these actions: "),m.qZA(),m.TgZ(10,"table",0),m.TgZ(11,"tr"),m.TgZ(12,"td",1),m._uU(13," ACCEPT "),m.qZA(),m.TgZ(14,"td"),m._uU(15,"The queue accepts and releases commands."),m.qZA(),m.qZA(),m.TgZ(16,"tr"),m.TgZ(17,"td"),m._uU(18," HOLD "),m.qZA(),m.TgZ(19,"td"),m._uU(20,"The queue accepts commands but does not release them. These commands may be released manually, or automatically as soon as the queue action changes to ACCEPT."),m.qZA(),m.qZA(),m.TgZ(21,"tr"),m.TgZ(22,"td"),m._uU(23," REJECT "),m.qZA(),m.TgZ(24,"td"),m._uU(25,"The queue does not accept commands. Matching commands will fail immediately."),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(26,"div",2),m.YNc(27,za,9,3,"ng-container",3),m.ALo(28,"async"),m.YNc(29,eo,2,3,"ng-template",null,4,m.W1O),m.qZA(),m.qZA()),2&t){const t=m.MAs(30);let n;m.xp6(27),m.Q6J("ngIf",null==(n=m.lcZ(28,2,e.connectionInfo$))||null==n.processor?null:n.processor.hasCommanding)("ngIfElse",t)}},directives:[T.a,v.k,C.W,k.O5,Ca,Ga,qi.M],pipes:[k.Ov],encapsulation:2,changeDetection:0}),t})();var io=n(9244),ao=n(9996),oo=n(5183);const co=["commandSelector"],so=["commandForm"];function ro(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"form",2),m.TgZ(3,"h2"),m._uU(4,"Select command"),m.qZA(),m.TgZ(5,"div",3),m._UZ(6,"app-command-selector",4,5),m.qZA(),m.qZA(),m.qZA(),m.TgZ(8,"div",6),m.TgZ(9,"mat-toolbar"),m.TgZ(10,"mat-toolbar-row"),m.TgZ(11,"button",7),m._uU(12,"CANCEL"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()),2&t){const t=m.oxw();m.xp6(2),m.Q6J("formGroup",t.selectCommandForm)}}function lo(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.TgZ(1,"app-text-action",12),m.NdJ("click",function(){const e=m.CHM(t).ngIf;return m.oxw(2).returnToList(e)}),m._uU(2),m.qZA(),m.BQk()}if(2&t){const t=e.ngIf;m.xp6(1),m.Q6J("padding",!1),m.xp6(1),m.hij(" ",t," ")}}function mo(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",8),m.YNc(3,lo,3,2,"ng-container",0),m.ALo(4,"spaceSystemName"),m.TgZ(5,"h2"),m._uU(6),m.qZA(),m._UZ(7,"app-command-form",9,10),m.qZA(),m.qZA(),m.TgZ(9,"div",6),m.TgZ(10,"mat-toolbar"),m.TgZ(11,"mat-toolbar-row"),m.TgZ(12,"button",7),m._uU(13,"CANCEL"),m.qZA(),m._uU(14,"\xa0\xa0 "),m.TgZ(15,"button",11),m.NdJ("click",function(){return m.CHM(t),m.oxw().handleOK()}),m._uU(16),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&t){const t=e.ngIf,n=m.MAs(8),i=m.oxw();m.xp6(3),m.Q6J("ngIf",m.lcZ(4,6,t.qualifiedName)),m.xp6(3),m.Oqu(t.name),m.xp6(1),m.Q6J("command",t)("templateProvider",i.templateProvider),m.xp6(8),m.Q6J("disabled",!n.form.valid),m.xp6(1),m.Oqu(i.okLabel)}}class uo{constructor(t){this.entry=t}getAssignment(t){for(const e of this.entry.arguments)if(e.name===t)return{type:"STRING",stringValue:e.value}}getComment(){return this.entry.comment}}let po=(()=>{class t{constructor(t,e,n,i,a){this.dialogRef=t,this.yamcs=e,this.changeDetection=i,this.data=a,this.okLabel="OK",this.commandFormValid$=new j.X(!1),this.selectedCommand$=new j.X(null),(null==a?void 0:a.entry)&&(this.templateProvider=new uo(a.entry),this.selectedCommand$.next(a.entry.command)),(null==a?void 0:a.okLabel)&&(this.okLabel=null==a?void 0:a.okLabel),this.selectCommandForm=n.group({command:["",Z.kI.required]}),this.selectCommandForm.valueChanges.subscribe(()=>{this.selectedCommand$.next(this.selectCommandForm.value.command||null)})}handleOK(){const t={command:this.selectedCommand$.value,assignments:this.commandForm.getAssignments(),comment:this.commandForm.getComment(),extra:this.commandForm.getExtraOptions()};this.dialogRef.close(t)}returnToList(t){this.templateProvider=null,this.selectedCommand$.next(null),this.changeDetection.detectChanges(),this.selectCommandForm.reset(),this.commandSelector.changeSystem("/"===t?"":t)}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(x.so),m.Y36(h.C),m.Y36(Z.qu),m.Y36(m.sBO),m.Y36(x.WI))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&(m.Gf(co,5),m.Gf(so,5)),2&t){let t;m.iGM(t=m.CRH())&&(e.commandSelector=t.first),m.iGM(t=m.CRH())&&(e.commandForm=t.first)}},decls:4,vars:6,consts:[[4,"ngIf"],[1,"wrapper","mat-typography"],[1,"ya-form",3,"formGroup"],[1,"command-table-wrapper"],["formControlName","command"],["commandSelector",""],[1,"footer","mat-typography"],["mat-dialog-close","",1,"ya-button"],[1,"command-detail"],[3,"command","templateProvider"],["commandForm",""],[1,"ya-button","primary",3,"disabled","click"],[3,"padding","click"]],template:function(t,e){1&t&&(m.YNc(0,ro,13,1,"ng-container",0),m.ALo(1,"async"),m.YNc(2,mo,17,8,"ng-container",0),m.ALo(3,"async")),2&t&&(m.Q6J("ngIf",!m.lcZ(1,2,e.selectedCommand$)),m.xp6(2),m.Q6J("ngIf",m.lcZ(3,4,e.selectedCommand$)))},directives:[k.O5,Z._Y,Z.JL,Z.sg,oo.C,Z.JJ,Z.u,Kt.Ye,Kt.rD,x.ZT,Hn,Qn.l],pipes:[k.Ov,ei.B],styles:[".mat-dialog-container{border-radius:0;position:relative}.wrapper[_ngcontent-%COMP%]{position:relative;height:calc(100% - 32px);overflow:auto}.command-table-wrapper[_ngcontent-%COMP%]{position:absolute;overflow:auto;top:56px;bottom:1em;left:0;right:0}.command-detail[_ngcontent-%COMP%]{max-width:600px}.footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:64px;left:0;right:0;border-top:1px solid #d3d3d3}"]}),t})();class go{constructor(t=[]){this.entries=t}addEntry(t){this.entries.push(t)}toXML(){const t=document.implementation.createDocument(null,null,null),e=t.createElement("commandStack");t.appendChild(e);for(const i of this.entries){const n=t.createElement("command");n.setAttribute("qualifiedName",i.name),i.comment&&n.setAttribute("comment",i.comment);for(const e of i.arguments){const i=t.createElement("commandArgument");i.setAttribute("argumentName",e.name),i.setAttribute("argumentValue",e.value),n.appendChild(i)}e.appendChild(n)}let n=(new XMLSerializer).serializeToString(e);return this.formatXml(n)}formatXml(t){let e="",n="";return t.split(/>\s*</).forEach(function(t){t.match(/^\/\w/)&&(n=n.substring("  ".length)),e+=n+"<"+t+">\r\n",t.match(/^<?\w[^>]*[^\/]$/)&&(n+="  ")}),e.substring(1,e.length-3)}}function fo(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"div",2),m._uU(2),m.qZA(),m.TgZ(3,"div",1),m._uU(4),m.qZA(),m.BQk()),2&t){const t=e.$implicit;m.xp6(2),m.Oqu(t.namespace),m.xp6(2),m.hij(" ",t.name," ")}}function ho(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-markdown",8),m.BQk()),2&t){const t=m.oxw();m.xp6(1),m.Q6J("text",null==t.entry.command?null:t.entry.command.longDescription)}}function Zo(t,e){if(1&t&&(m.ynx(0),m._uU(1),m.BQk()),2&t){const t=m.oxw();m.xp6(1),m.hij(" ",(null==t.entry.command?null:t.entry.command.shortDescription)||"-"," ")}}function xo(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-significance-level",9),m._uU(2),m.BQk()),2&t){const t=e.ngIf;m.xp6(1),m.Q6J("level",t.consequenceLevel),m.xp6(1),m.hij(" ",t.reasonForWarning," ")}}function yo(t,e){1&t&&(m.TgZ(0,"span",15),m._uU(1," satisfied "),m.qZA())}function Ao(t,e){1&t&&(m.TgZ(0,"span",16),m._uU(1," not satisfied "),m.qZA())}function bo(t,e){if(1&t&&(m.TgZ(0,"tr"),m.TgZ(1,"td"),m._uU(2),m.qZA(),m.TgZ(3,"td"),m._uU(4),m.qZA(),m.TgZ(5,"td"),m.YNc(6,yo,2,0,"span",11),m.ALo(7,"async"),m.YNc(8,Ao,2,0,"span",12),m.ALo(9,"async"),m._UZ(10,"app-live-expression",13,14),m.qZA(),m.qZA()),2&t){const t=e.$implicit,n=m.MAs(11);m.xp6(2),m.Oqu(t.expression),m.xp6(2),m.Oqu(t.timeout||"-"),m.xp6(2),m.Q6J("ngIf",!0===m.lcZ(7,7,n.result$)),m.xp6(2),m.Q6J("ngIf",!1===m.lcZ(9,9,n.result$)),m.xp6(2),m.Udp("display","none"),m.Q6J("expression",t.expression)}}function To(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"table",10),m.TgZ(2,"tr"),m.TgZ(3,"th"),m._uU(4,"Constraint"),m.qZA(),m.TgZ(5,"th"),m._uU(6,"Timeout"),m.qZA(),m.TgZ(7,"th"),m._uU(8,"Live Evaluation"),m.qZA(),m.qZA(),m.YNc(9,bo,12,11,"tr",3),m.qZA(),m.BQk()),2&t){const t=e.ngIf;m.xp6(9),m.Q6J("ngForOf",t)}}function vo(t,e){1&t&&(m.ynx(0),m._uU(1,"-"),m.BQk())}function Co(t,e){1&t&&m._uU(0," -\n")}let qo=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-stacked-command-detail"]],inputs:{entry:"entry"},decls:30,vars:15,consts:[[1,"block-title",2,"padding-top","0"],[1,"block"],[1,"block-title"],[4,"ngFor","ngForOf"],[4,"ngIf"],[2,"margin-top","1em","margin-bottom","1em"],[4,"ngIf","ngIfElse"],["dash",""],[3,"text"],[3,"level"],["yaDataTable",""],["class","evaluation valid",4,"ngIf"],["class","evaluation invalid",4,"ngIf"],[3,"expression"],["expr",""],[1,"evaluation","valid"],[1,"evaluation","invalid"]],template:function(t,e){if(1&t&&(m.TgZ(0,"div",0),m._uU(1,"Command"),m.qZA(),m.TgZ(2,"div",1),m._uU(3),m.ALo(4,"shortName"),m.qZA(),m.TgZ(5,"div",2),m._uU(6,"Space system"),m.qZA(),m.TgZ(7,"div",1),m._uU(8),m.ALo(9,"spaceSystemName"),m.qZA(),m.YNc(10,fo,5,2,"ng-container",3),m.TgZ(11,"div",2),m._uU(12,"Description"),m.qZA(),m.TgZ(13,"div",1),m.YNc(14,ho,2,1,"ng-container",4),m.YNc(15,Zo,2,1,"ng-container",4),m.qZA(),m._UZ(16,"mat-divider",5),m.TgZ(17,"div",2),m._uU(18,"Significance"),m.qZA(),m.TgZ(19,"div",1),m.YNc(20,xo,3,2,"ng-container",6),m.ALo(21,"effectiveSignificance"),m.qZA(),m._UZ(22,"mat-divider",5),m.TgZ(23,"div",0),m._uU(24,"Constraints"),m.qZA(),m.TgZ(25,"div",1),m.YNc(26,To,10,1,"ng-container",4),m.YNc(27,vo,2,0,"ng-container",4),m.qZA(),m.YNc(28,Co,1,0,"ng-template",null,7,m.W1O)),2&t){const t=m.MAs(29);m.xp6(3),m.hij(" ",m.lcZ(4,9,e.entry.name),"\n"),m.xp6(5),m.hij(" ",m.lcZ(9,11,e.entry.name)||"-","\n"),m.xp6(2),m.Q6J("ngForOf",null==e.entry.command?null:e.entry.command.alias),m.xp6(4),m.Q6J("ngIf",null==e.entry.command?null:e.entry.command.longDescription),m.xp6(1),m.Q6J("ngIf",!(null!=e.entry.command&&e.entry.command.longDescription)),m.xp6(5),m.Q6J("ngIf",m.lcZ(21,13,e.entry.command))("ngIfElse",t),m.xp6(6),m.Q6J("ngIf",null==e.entry.command?null:e.entry.command.constraint),m.xp6(1),m.Q6J("ngIf",!(null!=e.entry.command&&e.entry.command.constraint))}},directives:[k.sg,k.O5,tt.d,Wn.U,y.U,et.O,zn.Q],pipes:[ti.y,ei.B,Gn.m,k.Ov],styles:[".evaluation[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace;background-color:#dc143c;color:#fff;padding-left:2px;padding-right:2px}.evaluation.valid[_ngcontent-%COMP%]{background-color:#adff2f;color:#000}"],changeDetection:0}),t})();var _o=n(1667),wo=n(9979),ko=function(t,e,n,i){return new(n||(n=Promise))(function(a,o){function c(t){try{r(i.next(t))}catch(e){o(e)}}function s(t){try{r(i.throw(t))}catch(e){o(e)}}function r(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,s)}r((i=i.apply(t,e||[])).next())})};const No=["entryParent"];function Uo(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"app-detail-toolbar"),m._uU(2," Command Info "),m.qZA(),m.TgZ(3,"div",20),m._UZ(4,"app-stacked-command-detail",21),m.TgZ(5,"p"),m._uU(6,"\xa0"),m.qZA(),m.qZA(),m.BQk()),2&t){const t=e.ngIf;m.xp6(4),m.Q6J("entry",t)}}function Qo(t,e){1&t&&(m.TgZ(0,"app-detail-toolbar"),m._uU(1," Select an entry "),m.qZA())}function So(t,e){if(1&t&&(m.ynx(0),m._uU(1),m.BQk()),2&t){const t=m.oxw().$implicit;m.xp6(1),m.hij(" [",t.executionNumber,"]: ")}}function Io(t,e){1&t&&(m.ynx(0),m._uU(1," [ ]: "),m.BQk())}function Jo(t,e){if(1&t&&(m.TgZ(0,"mat-icon",31),m._uU(1," comment "),m.qZA()),2&t){const t=m.oxw().$implicit;m.Q6J("matTooltip",t.comment)}}function Oo(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1),m.ALo(2,"value"),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.AsE(" [",t.key,": ",m.lcZ(2,2,t.value),"] ")}}function Yo(t,e){if(1&t&&(m.TgZ(0,"tr"),m.TgZ(1,"td",32),m._uU(2),m.qZA(),m.TgZ(3,"td",33),m._uU(4),m.qZA(),m.qZA()),2&t){const t=e.$implicit;m.xp6(2),m.hij(" ",t.name," "),m.xp6(2),m.Oqu(t.value)}}function Mo(t,e){if(1&t&&(m.ynx(0),m._uU(1),m.BQk()),2&t){const t=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",t.err," ")}}function $o(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"div",38),m._UZ(2,"app-extra-acknowledgments-table",37),m.qZA(),m.BQk()),2&t){const t=m.oxw(3).$implicit;m.xp6(2),m.Q6J("command",t.record)("inline",!0)}}function Do(t,e){if(1&t&&(m.ynx(0),m._UZ(1,"app-yamcs-acknowledgments-table",37),m.YNc(2,$o,3,2,"ng-container",25),m.BQk()),2&t){const t=m.oxw(2).$implicit;m.xp6(1),m.Q6J("command",t.record)("inline",!0),m.xp6(1),m.Q6J("ngIf",null==t.record?null:t.record.extra.length)}}function Po(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"div",34),m.TgZ(1,"div",35),m.NdJ("click",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw().selectEntry(e)}),m.qZA(),m.TgZ(2,"div",36),m.YNc(3,Mo,2,1,"ng-container",25),m.YNc(4,Do,3,3,"ng-container",25),m.qZA(),m.qZA()}if(2&t){const t=m.oxw().$implicit;m.xp6(2),m.ekj("err",t.err),m.xp6(1),m.Q6J("ngIf",t.err),m.xp6(1),m.Q6J("ngIf",!t.err)}}function Eo(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"div",22),m.ALo(1,"async"),m.TgZ(2,"div",23),m.TgZ(3,"div",24),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw().selectEntry(e)}),m.YNc(4,So,2,1,"ng-container",25),m.YNc(5,Io,2,0,"ng-container",25),m.qZA(),m.TgZ(6,"div",26),m.NdJ("dblclick",function(){const e=m.CHM(t).$implicit;return m.oxw().editCommand(e)}),m._uU(7),m.YNc(8,Jo,2,1,"mat-icon",27),m.YNc(9,Oo,3,4,"span",28),m.ALo(10,"keyvalue"),m.TgZ(11,"table",29),m.YNc(12,Yo,5,2,"tr",28),m.qZA(),m.qZA(),m.qZA(),m.YNc(13,Po,5,4,"div",30),m.qZA()}if(2&t){const t=e.$implicit,n=m.oxw();m.ekj("selected",t===m.lcZ(1,9,n.selectedEntry$)),m.xp6(4),m.Q6J("ngIf",0===t.executionNumber||t.executionNumber),m.xp6(1),m.Q6J("ngIf",0!==t.executionNumber&&!t.executionNumber),m.xp6(2),m.hij(" ",t.name," "),m.xp6(1),m.Q6J("ngIf",t.comment),m.xp6(1),m.Q6J("ngForOf",m.lcZ(10,11,t.extra)),m.xp6(3),m.Q6J("ngForOf",t.arguments),m.xp6(1),m.Q6J("ngIf",0===t.executionNumber||t.executionNumber)}}const Lo=function(t){return{c:t}};let Fo=(()=>{class t{constructor(t,e,n,i,a){this.dialog=t,this.yamcs=e,this.route=n,this.title=i,this.dirty$=new j.X(!1),this.entries$=new j.X([]),this.hasOutputs$=this.entries$.pipe((0,ao.U)(t=>{for(const e of t)if(e.record)return!0;return!1})),this.running$=new j.X(!1),this.selectedEntry$=new j.X(null),this.clipboardEntry$=new j.X(null),this.commandHistoryRecords=new Map,this.executionCounter=0,this.folderPerInstance=a.getConfig().displayFolderPerInstance,this.storageClient=e.createStorageClient();const o=this.getObjectNameFromUrl();this.loadFile(o),this.commandSubscription=e.yamcsClient.createCommandSubscription({instance:e.instance,processor:e.processor,ignorePastCommands:!0},t=>{const e=t.id;let n=this.commandHistoryRecords.get(e);n=n?n.mergeEntry(t):new z(t),this.commandHistoryRecords.set(e,n);for(const i of this.entries$.value)if(i.id===e){i.record=n;break}})}handleDrop(t){t.previousIndex!==t.currentIndex&&((0,io.bA)(this.entries$.value,t.previousIndex,t.currentIndex),this.entries$.next([...this.entries$.value]),this.dirty$.next(!0))}getObjectNameFromUrl(){const t=this.route.snapshot.url;let e="";this.folderPerInstance&&(e+=this.yamcs.instance);for(const n of t)e&&(e+="/"),e+=n.path;return e}getNameWithoutInstance(t){return this.folderPerInstance?t.substr(this.yamcs.instance.length):t}loadFile(t){return ko(this,void 0,void 0,function*(){this.objectName=t;const e=this.objectName.lastIndexOf("/");if(-1===e)this.folderLink="/commanding/stacks/browse/",this.filename=this.objectName;else{const t=this.getNameWithoutInstance(this.objectName.substring(0,e));this.folderLink="/commanding/stacks/browse/"+t,this.filename=this.objectName.substring(e+1)}this.title.setTitle(this.filename);const n=yield this.storageClient.getObject("_global","stacks",t);if(n.ok){const t=yield n.text(),e=(new DOMParser).parseFromString(t,"text/xml"),a=this.parseXML(e.documentElement),o=[];for(const n of a)o.push(this.yamcs.yamcsClient.getCommand(this.yamcs.instance,n.name).then(t=>{n.command=t}));for(const n of o)try{yield n}catch(i){}this.entries$.next(a),this.selectedEntry$.next(a.length?a[0]:null)}})}parseXML(t){const e=[];for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes[n];if(3!==i.nodeType&&"command"===i.nodeName){const t=this.parseEntry(i);e.push(t)}}return e}selectEntry(t){this.selectedEntry$.next(t)}deleteSelectedCommands(){const t=this.selectedEntry$.value;if(t){const e=this.entries$.value.indexOf(t);-1!==e&&(this.entries$.value.splice(e,1),this.entries$.next([...this.entries$.value]),this.selectedEntry$.next(null),this.dirty$.next(!0))}}clearSelectedOutputs(){const t=this.selectedEntry$.value;t&&(t.executionNumber=void 0,t.id=void 0,t.record=void 0,t.err=void 0)}clearOutputs(){for(const t of this.entries$.value)t.executionNumber=void 0,t.id=void 0,t.record=void 0,t.err=void 0;this.executionCounter=0,this.entries$.next([...this.entries$.value]),this.entries$.value.length&&this.selectEntry(this.entries$.value[0])}hasPendingChanges(){return this.dirty$.value}runSelection(){const t=this.selectedEntry$.value;t&&this.runEntry(t).finally(()=>{this.advanceSelection(t)})}runEntry(t){return ko(this,void 0,void 0,function*(){return this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,t.name,{assignment:t.arguments,extra:t.extra}).then(e=>{t.executionNumber=++this.executionCounter,t.id=e.id;const n=this.commandHistoryRecords.get(t.id);n&&(t.record=n),this.entries$.next([...this.entries$.value])}).catch(e=>{t.executionNumber=++this.executionCounter,t.err=e.message||e})})}runFromSelection(){return ko(this,void 0,void 0,function*(){let t=this.selectedEntry$.value;if(t){this.running$.next(!0);try{const e=this.entries$.value;for(let n=e.indexOf(t);n<e.length;n++)t=e[n],yield this.runEntry(t),this.advanceSelection(t)}finally{this.running$.next(!1)}}})}stopRun(){this.running$.next(!1)}advanceSelection(t){const e=this.entries$.value,n=e.indexOf(t);if(n<e.length-1){this.selectEntry(e[n+1]);const t=this.entryParent.nativeElement.getElementsByClassName("entry")[n+1];this.isVisible(t)||t.scrollIntoView()}else this.selectedEntry$.next(null)}isVisible(t){const e=t.getBoundingClientRect(),n=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(e.bottom<0||e.top-n>=0)}parseEntry(t){const e=[];for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];"commandArgument"===n.nodeName&&e.push({name:this.getStringAttribute(n,"argumentName"),value:this.getStringAttribute(n,"argumentValue")})}const n={name:this.getStringAttribute(t,"qualifiedName"),arguments:e};return t.hasAttribute("comment")&&(n.comment=this.getStringAttribute(t,"comment")),n}addCommand(){this.dialog.open(po,{width:"70%",height:"100%",autoFocus:!1,position:{right:"0"},data:{okLabel:"ADD TO STACK"}}).afterClosed().subscribe(t=>{if(t){const e={name:t.command.qualifiedName,arguments:t.assignments,comment:t.comment,extra:t.extra,command:t.command},n=this.selectedEntry$.value;if(n){const t=this.entries$.value,i=t.indexOf(n);t.splice(i+1,0,e),this.entries$.next([...this.entries$.value])}else this.entries$.next([...this.entries$.value,e]);this.selectEntry(e),this.dirty$.next(!0)}})}editSelectedCommand(){this.editCommand(this.selectedEntry$.value)}editCommand(t){return this.selectEntry(t),this.dialog.open(po,{width:"70%",height:"100%",autoFocus:!1,position:{right:"0"},data:{okLabel:"UPDATE",entry:t}}).afterClosed().subscribe(e=>{if(e){const n={name:e.command.qualifiedName,arguments:e.assignments,comment:e.comment,extra:e.extra,command:e.command},i=this.entries$.value,a=i.indexOf(t);i.splice(a,1,n),this.entries$.next([...this.entries$.value]),this.selectEntry(n),this.dirty$.next(!0)}}),!1}cutSelectedCommand(){const t=this.selectedEntry$.value;this.advanceSelection(t),this.clipboardEntry$.next(t);const e=this.entries$.value,n=e.indexOf(t);e.splice(n,1),this.entries$.next([...this.entries$.value]),this.dirty$.next(!0)}copySelectedCommand(){this.clipboardEntry$.next(this.selectedEntry$.value)}pasteCommand(){const t=this.clipboardEntry$.value;if(t){const e={name:t.name,arguments:[...t.arguments],comment:t.comment,command:t.command};t.extra&&(e.extra=Object.assign({},t.extra));const n=this.selectedEntry$.value;if(n){const t=this.entries$.value,i=t.indexOf(n);t.splice(i+1,0,e),this.entries$.next([...this.entries$.value])}else this.entries$.next([...this.entries$.value,e]);this.selectEntry(e),this.dirty$.next(!0)}}saveStack(){const t=new go(this.entries$.value).toXML(),e=new Blob([t]);this.storageClient.uploadObject("_global","stacks",this.objectName,e).then(()=>{this.dirty$.next(!1)})}getStringAttribute(t,e){const n=t.attributes.getNamedItem(e);if(null===n)throw new Error(`No attribute named ${e}`);return n.textContent||""}ngOnDestroy(){this.commandSubscription&&this.commandSubscription.cancel()}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(x.uw),m.Y36(h.C),m.Y36(a.gz),m.Y36(b.Dx),m.Y36(l.E))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&m.Gf(No,5),2&t){let t;m.iGM(t=m.CRH())&&(e.entryParent=t.first)}},decls:68,vars:59,consts:[[3,"hasDetailPane"],["mat-icon-button","","color","primary",3,"routerLink","queryParams"],["mat-button","","color","primary","matTooltip","Save stack",3,"disabled","click"],["vertical","",2,"height","100%"],["mat-icon-button","","color","primary","matTooltip","Add a command below",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Edit the selected command",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Cut the selected command",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Copy the selected command",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Paste command from the clipboard",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Run the selected command",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Stop current execution",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Clear all outputs",3,"disabled","click"],["mat-icon-button","","color","primary","matTooltip","Run all from selected command",3,"disabled","click"],[4,"ngIf","ngIfElse"],["noSelection",""],[1,"panel-wrapper"],["cdkDropList","",1,"panel-content",3,"cdkDropListDropped"],["entryParent",""],["id","drag-boundary"],["cdkDrag","","cdkDragBoundary","#drag-boundary","class","entry",3,"selected",4,"ngFor","ngForOf"],[2,"padding","0 16px"],[3,"entry"],["cdkDrag","","cdkDragBoundary","#drag-boundary",1,"entry"],[1,"in"],["cdkDragHandle","",1,"seq",3,"click"],[4,"ngIf"],[1,"body",3,"dblclick"],["class","icon14","style","vertical-align: middle;",3,"matTooltip",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"args"],["class","out",4,"ngIf"],[1,"icon14",2,"vertical-align","middle",3,"matTooltip"],["width","1",1,"key"],[1,"value"],[1,"out"],[1,"seq",3,"click"],[1,"body"],[3,"command","inline"],[1,"block"]],template:function(t,e){if(1&t&&(m.TgZ(0,"app-instance-page"),m.TgZ(1,"app-instance-toolbar",0),m.TgZ(2,"a",1),m.TgZ(3,"mat-icon"),m._uU(4,"arrow_back"),m.qZA(),m.qZA(),m._uU(5),m.ALo(6,"basename"),m.TgZ(7,"button",2),m.NdJ("click",function(){return e.saveStack()}),m.ALo(8,"async"),m.TgZ(9,"mat-icon"),m._uU(10,"save"),m.qZA(),m._uU(11," SAVE "),m.qZA(),m._UZ(12,"mat-divider",3),m.TgZ(13,"button",4),m.NdJ("click",function(){return e.addCommand()}),m.ALo(14,"async"),m.TgZ(15,"mat-icon"),m._uU(16,"add_circle_outline"),m.qZA(),m.qZA(),m.TgZ(17,"button",5),m.NdJ("click",function(){return e.editSelectedCommand()}),m.ALo(18,"async"),m.ALo(19,"async"),m.TgZ(20,"mat-icon"),m._uU(21,"edit"),m.qZA(),m.qZA(),m.TgZ(22,"button",6),m.NdJ("click",function(){return e.cutSelectedCommand()}),m.ALo(23,"async"),m.ALo(24,"async"),m.TgZ(25,"mat-icon"),m._uU(26,"content_cut"),m.qZA(),m.qZA(),m.TgZ(27,"button",7),m.NdJ("click",function(){return e.copySelectedCommand()}),m.ALo(28,"async"),m.ALo(29,"async"),m.TgZ(30,"mat-icon"),m._uU(31,"content_copy"),m.qZA(),m.qZA(),m.TgZ(32,"button",8),m.NdJ("click",function(){return e.pasteCommand()}),m.ALo(33,"async"),m.ALo(34,"async"),m.TgZ(35,"mat-icon"),m._uU(36,"content_paste"),m.qZA(),m.qZA(),m._UZ(37,"mat-divider",3),m.TgZ(38,"button",9),m.NdJ("click",function(){return e.runSelection()}),m.ALo(39,"async"),m.ALo(40,"async"),m.TgZ(41,"mat-icon"),m._uU(42,"play_arrow"),m.qZA(),m.qZA(),m.TgZ(43,"button",10),m.NdJ("click",function(){return e.stopRun()}),m.ALo(44,"async"),m.TgZ(45,"mat-icon"),m._uU(46,"stop"),m.qZA(),m.qZA(),m.TgZ(47,"button",11),m.NdJ("click",function(){return e.clearOutputs()}),m.ALo(48,"async"),m.ALo(49,"async"),m.TgZ(50,"mat-icon"),m._uU(51,"refresh"),m.qZA(),m.qZA(),m.TgZ(52,"button",12),m.NdJ("click",function(){return e.runFromSelection()}),m.ALo(53,"async"),m.ALo(54,"async"),m.TgZ(55,"mat-icon"),m._uU(56,"playlist_play"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(57,"app-detail-pane"),m.YNc(58,Uo,7,1,"ng-container",13),m.ALo(59,"async"),m.YNc(60,Qo,2,0,"ng-template",null,14,m.W1O),m.qZA(),m.TgZ(62,"div",15),m.TgZ(63,"div",16,17),m.NdJ("cdkDropListDropped",function(t){return e.handleDrop(t)}),m.TgZ(65,"div",18),m.YNc(66,Eo,14,13,"div",19),m.ALo(67,"async"),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t){const t=m.MAs(61);m.xp6(1),m.Q6J("hasDetailPane",!0),m.xp6(1),m.Q6J("routerLink",e.folderLink)("queryParams",m.VKq(57,Lo,e.yamcs.context)),m.xp6(3),m.hij(" ",m.lcZ(6,17,e.filename)," \xa0\xa0\xa0 "),m.xp6(2),m.Q6J("disabled",!m.lcZ(8,19,e.dirty$)),m.xp6(6),m.Q6J("disabled",m.lcZ(14,21,e.running$)),m.xp6(4),m.Q6J("disabled",m.lcZ(18,23,e.running$)||!m.lcZ(19,25,e.selectedEntry$)),m.xp6(5),m.Q6J("disabled",m.lcZ(23,27,e.running$)||!m.lcZ(24,29,e.selectedEntry$)),m.xp6(5),m.Q6J("disabled",m.lcZ(28,31,e.running$)||!m.lcZ(29,33,e.selectedEntry$)),m.xp6(5),m.Q6J("disabled",m.lcZ(33,35,e.running$)||!m.lcZ(34,37,e.clipboardEntry$)),m.xp6(6),m.Q6J("disabled",m.lcZ(39,39,e.running$)||!m.lcZ(40,41,e.selectedEntry$)),m.xp6(5),m.Q6J("disabled",!m.lcZ(44,43,e.running$)),m.xp6(4),m.Q6J("disabled",m.lcZ(48,45,e.running$)||!m.lcZ(49,47,e.hasOutputs$)),m.xp6(5),m.Q6J("disabled",m.lcZ(53,49,e.running$)||!m.lcZ(54,51,e.selectedEntry$)),m.xp6(6),m.Q6J("ngIf",m.lcZ(59,53,e.selectedEntry$))("ngIfElse",t),m.xp6(8),m.Q6J("ngForOf",m.lcZ(67,55,e.entries$))}},directives:[T.a,v.k,q.zs,a.yS,_.Hw,q.lW,nt.gM,tt.d,Vt.Z,k.O5,io.Wj,k.sg,Gt.j,qo,io.Zt,io.Bh,vt,Ut],pipes:[_o.u,k.Ov,k.Nd,wo.V],styles:[".panel-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.ya-data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}table.args[_ngcontent-%COMP%]{margin:0 0 0 10px;font-size:10px}table.args[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0;border:0}table.args[_ngcontent-%COMP%]   td.key[_ngcontent-%COMP%]{min-width:120px;white-space:nowrap}table.args[_ngcontent-%COMP%]   td.value[_ngcontent-%COMP%]{color:#05a;padding-left:10px}div.entry[_ngcontent-%COMP%]{font-size:13px;line-height:17px}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%], div.entry[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]{display:flex;border-left:8px solid transparent;margin-bottom:10px}div.entry.selected[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%], div.entry.selected[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]{border-color:#2196f3}div.entry[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{width:64px;text-align:right;padding-top:5px;padding-right:10px;user-select:none;-webkit-user-select:none;-moz-user-select:none;-khtml-user-select:none;font-family:Roboto Mono,monospace;color:#bdbdbd}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{cursor:move}div.entry.selected[_ngcontent-%COMP%]   .seq[_ngcontent-%COMP%]{color:#2196f3}div.entry[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1;padding:5px}div.entry[_ngcontent-%COMP%]   div.in[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{background-color:#fafafa;border:1px solid #e0e0e0;font-family:Roboto Mono,monospace}div.entry[_ngcontent-%COMP%]   div.out[_ngcontent-%COMP%]   .body.err[_ngcontent-%COMP%]{background-color:#fcc;color:#dc143c}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.6}"],changeDetection:0}),t})();var Bo=n(8318),Ro=n(878);let jo=(()=>{class t{constructor(t){this.dialogRef=t}confirmDiscard(){this.dialogRef.close(!0)}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(x.so))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-stack-file-page-dirty-dialog"]],decls:10,vars:0,consts:[[1,"mat-typography"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(t,e){1&t&&(m.TgZ(0,"mat-dialog-content",0),m.TgZ(1,"h3"),m._uU(2,"Close without saving?"),m.qZA(),m.TgZ(3,"p"),m._uU(4,"You have unsaved changes, close without saving?"),m.qZA(),m.qZA(),m.TgZ(5,"mat-dialog-actions",1),m.TgZ(6,"button",2),m._uU(7,"CANCEL"),m.qZA(),m.TgZ(8,"button",3),m.NdJ("click",function(){return e.confirmDiscard()}),m._uU(9," OK "),m.qZA(),m.qZA())},directives:[x.xY,x.H8,x.ZT],encapsulation:2}),t})(),Ho=(()=>{class t{constructor(t,e){this.dialog=t,this.authService=e,this.dialogOpen$=new j.X(!1)}canDeactivate(t){return this.dialogOpen$.value?Bo.y.create(t=>{this.dialogRef.afterClosed().subscribe(e=>{t.next(e),t.complete()},e=>{t.next(!1),t.complete()})}):t.hasPendingChanges()&&this.mayManageStacks()?Bo.y.create(t=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(jo,{width:"400px"}),this.dialogRef.afterClosed().subscribe(e=>{this.dialogOpen$.next(!1),t.next(e),t.complete()},e=>{this.dialogOpen$.next(!1),t.next(!1),t.complete()})}):(0,Ro.of)(!0)}mayManageStacks(){const t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket","stacks")||t.hasSystemPrivilege("ManageAnyBucket")}}return t.\u0275fac=function(e){return new(e||t)(m.LFG(x.uw),m.LFG(G.e))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac}),t})();var Vo=n(3835),Go=n(1641);const Wo=["filename"];let Xo=(()=>{class t{constructor(t,e,n,i){this.dialogRef=t,this.data=i,this.storageClient=n.createStorageClient(),this.filenameForm=e.group({path:[i.path,Z.kI.required],name:["",[Z.kI.required]]})}save(){let t=this.filenameForm.get("path").value.trim();const e=this.filenameForm.get("name").value.trim()+".xml";t.startsWith("/")&&(t=t.substring(1)),t.endsWith("/")&&(t=t.substring(0,t.length-1));const n=t?t+"/"+e:e,i=this.data.prefix+n,a=new Blob([],{type:"application/xml"});this.storageClient.uploadObject("_global","stacks",i,a).then(()=>{this.dialogRef.close(n)})}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(x.so),m.Y36(Z.qu),m.Y36(h.C),m.Y36(x.WI))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-create-stack-dialog"]],viewQuery:function(t,e){if(1&t&&m.Gf(Wo,5),2&t){let t;m.iGM(t=m.CRH())&&(e.filenameInput=t.first)}},decls:17,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["filename",""],["type","text","formControlName","path"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(m.TgZ(0,"h2",0),m._uU(1,"Create stack"),m.qZA(),m.TgZ(2,"mat-dialog-content",1),m.TgZ(3,"form",2),m.TgZ(4,"label"),m._uU(5," Name "),m._UZ(6,"input",3,4),m.qZA(),m._UZ(8,"br"),m.TgZ(9,"label"),m._uU(10," Path "),m._UZ(11,"input",5),m.qZA(),m.qZA(),m.qZA(),m.TgZ(12,"mat-dialog-actions",6),m.TgZ(13,"button",7),m._uU(14,"CANCEL"),m.qZA(),m.TgZ(15,"button",8),m.NdJ("click",function(){return e.save()}),m._uU(16,"SAVE"),m.qZA(),m.qZA()),2&t){let t;m.xp6(3),m.Q6J("formGroup",e.filenameForm),m.xp6(1),m.ekj("invalid",null==(t=e.filenameForm.get("name"))?null:t.invalid),m.xp6(11),m.Q6J("disabled",!e.filenameForm.valid)}},directives:[x.uh,x.xY,Z._Y,Z.JL,Z.sg,Z.Fj,Z.JJ,Z.u,x.H8,x.ZT],encapsulation:2}),t})();const zo=["files"];function Ko(t,e){if(1&t&&(m.TgZ(0,"form",7),m.TgZ(1,"label"),m._uU(2," Files"),m._UZ(3,"br"),m._UZ(4,"input",8,9),m.qZA(),m._UZ(6,"br"),m.TgZ(7,"label"),m._uU(8," Path "),m._UZ(9,"input",10),m.qZA(),m.qZA()),2&t){const t=m.oxw();m.Q6J("formGroup",t.formGroup)}}function tc(t,e){1&t&&m._UZ(0,"app-dots")}let ec=(()=>{class t{constructor(t,e,n,i,a){this.dialogRef=t,this.messageService=e,this.data=a,this.uploading$=new j.X(!1),this.storageClient=i.createStorageClient(),this.formGroup=n.group({path:[a.path,Z.kI.required],files:[null,Z.kI.required]})}save(){let t=this.formGroup.get("path").value.trim();t.startsWith("/")&&(t=t.substring(1)),t.endsWith("/")&&(t=t.substring(0,t.length-1));const e=this.filesInput.nativeElement.files,n=[];this.uploading$.next(!0);for(const i in e)if(!isNaN(parseInt(i,10))){const a=e[i],o=this.storageClient.uploadObject("_global","stacks",this.data.prefix+(t?t+"/"+a.name:a.name),a);n.push(o)}Promise.all(n).then(()=>{this.uploading$.next(!1),this.dialogRef.close(!0)}).catch(t=>{this.messageService.showError(t),this.uploading$.next(!1),this.dialogRef.close(!0)})}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(x.so),m.Y36(Vn.e),m.Y36(Z.qu),m.Y36(h.C),m.Y36(x.WI))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-import-stack-dialog"]],viewQuery:function(t,e){if(1&t&&m.Gf(zo,5),2&t){let t;m.iGM(t=m.CRH())&&(e.filesInput=t.first)}},decls:14,vars:12,consts:[["mat-dialog-title",""],[1,"mat-typography"],["class","ya-form",3,"formGroup",4,"ngIf"],[4,"ngIf"],["align","end"],["mat-dialog-close","",1,"ya-button",3,"disabled"],[1,"ya-button","primary",3,"disabled","click"],[1,"ya-form",3,"formGroup"],["type","file","formControlName","files","accept",".xml","multiple",""],["files",""],["type","text","formControlName","path"]],template:function(t,e){1&t&&(m.TgZ(0,"h2",0),m._uU(1,"Import Stack"),m.qZA(),m.TgZ(2,"mat-dialog-content",1),m.YNc(3,Ko,10,1,"form",2),m.ALo(4,"async"),m.YNc(5,tc,1,0,"app-dots",3),m.ALo(6,"async"),m.qZA(),m.TgZ(7,"mat-dialog-actions",4),m.TgZ(8,"button",5),m.ALo(9,"async"),m._uU(10,"CANCEL"),m.qZA(),m.TgZ(11,"button",6),m.NdJ("click",function(){return e.save()}),m.ALo(12,"async"),m._uU(13,"IMPORT"),m.qZA(),m.qZA()),2&t&&(m.xp6(3),m.Q6J("ngIf",!m.lcZ(4,4,e.uploading$)),m.xp6(2),m.Q6J("ngIf",m.lcZ(6,6,e.uploading$)),m.xp6(3),m.Q6J("disabled",m.lcZ(9,8,e.uploading$)),m.xp6(3),m.Q6J("disabled",m.lcZ(12,10,e.uploading$)))},directives:[x.uh,x.xY,k.O5,x.H8,x.ZT,Z._Y,Z.JL,Z.sg,Z.Fj,Z.JJ,Z.u,ee.b],pipes:[k.Ov],encapsulation:2}),t})(),nc=(()=>{class t{constructor(t,e,n,i,a){this.dialogRef=t,this.data=a,this.storageClient=n.createStorageClient();const o=i.transform(this.data.name);this.filenameForm=e.group({name:[o,[Z.kI.required]]})}rename(){return t=this,void 0,n=function*(){let t;const e=this.data.name.lastIndexOf("/");-1!==e&&(t=this.data.name.substring(0,e+1));const n=yield this.storageClient.getObject("_global","stacks",this.data.name),i=yield n.blob(),a=(t||"")+this.filenameForm.get("name").value+".xml";yield this.storageClient.uploadObject("_global","stacks",a,i),yield this.storageClient.deleteObject("_global","stacks",this.data.name),this.dialogRef.close(a)},new((e=void 0)||(e=Promise))(function(i,a){function o(t){try{s(n.next(t))}catch(e){a(e)}}function c(t){try{s(n.throw(t))}catch(e){a(e)}}function s(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e(function(t){t(n)})).then(o,c)}s((n=n.apply(t,[])).next())});var t,e,n}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(x.so),m.Y36(Z.qu),m.Y36(h.C),m.Y36(_o.u),m.Y36(x.WI))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-rename-stack-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["filename",""],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(m.TgZ(0,"h2",0),m._uU(1,"Rename stack"),m.qZA(),m.TgZ(2,"mat-dialog-content",1),m.TgZ(3,"form",2),m.TgZ(4,"label"),m._uU(5," Name "),m._UZ(6,"input",3,4),m.qZA(),m.qZA(),m.qZA(),m.TgZ(8,"mat-dialog-actions",5),m.TgZ(9,"button",6),m._uU(10,"CANCEL"),m.qZA(),m.TgZ(11,"button",7),m.NdJ("click",function(){return e.rename()}),m._uU(12,"RENAME"),m.qZA(),m.qZA()),2&t){let t;m.xp6(3),m.Q6J("formGroup",e.filenameForm),m.xp6(1),m.ekj("invalid",null==(t=e.filenameForm.get("name"))?null:t.invalid),m.xp6(7),m.Q6J("disabled",!e.filenameForm.valid)}},directives:[x.uh,x.xY,Z._Y,Z.JL,Z.sg,Z.Fj,Z.JJ,Z.u,x.H8,x.ZT],encapsulation:2}),t})();const ic=["droparea"];function ac(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"button",9),m.NdJ("click",function(){return m.CHM(t),m.oxw().createStack()}),m.TgZ(1,"mat-icon"),m._uU(2,"add"),m.qZA(),m._uU(3," CREATE STACK "),m.qZA()}}function oc(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"button",9),m.NdJ("click",function(){return m.CHM(t),m.oxw().importStack()}),m.TgZ(1,"mat-icon"),m._uU(2,"cloud_upload"),m.qZA(),m._uU(3," IMPORT STACK "),m.qZA()}}function cc(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"button",10),m.NdJ("click",function(){return m.CHM(t),m.oxw().deleteSelectedStacks()}),m.TgZ(1,"mat-icon"),m._uU(2,"delete"),m.qZA(),m._uU(3," DELETE "),m.qZA()}if(2&t){const t=m.oxw();m.Q6J("disabled",!t.selection.hasValue())}}const sc=function(t){return{c:t}};function rc(t,e){if(1&t&&m._UZ(0,"app-breadcrumb",13),2&t){const t=e.$implicit,n=m.oxw(3);m.Q6J("link",t.route)("queryParams",m.VKq(3,sc,n.yamcs.context))("label",t.name)}}function lc(t,e){if(1&t&&(m.TgZ(0,"app-breadcrumb-trail"),m._UZ(1,"app-breadcrumb",11),m.YNc(2,rc,1,5,"app-breadcrumb",12),m.qZA()),2&t){const t=m.oxw().ngIf,e=m.oxw();m.xp6(1),m.Q6J("queryParams",m.VKq(2,sc,e.yamcs.context)),m.xp6(1),m.Q6J("ngForOf",t)}}function mc(t,e){if(1&t&&(m.ynx(0),m.YNc(1,lc,3,4,"app-breadcrumb-trail",6),m.BQk()),2&t){const t=e.ngIf;m.xp6(1),m.Q6J("ngIf",t.length)}}function uc(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"input",31),m.NdJ("change",function(e){m.CHM(t);const n=m.oxw(3);return e?n.masterToggle():null}),m.qZA()}if(2&t){const t=m.oxw(3);m.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())}}function dc(t,e){if(1&t&&(m.TgZ(0,"th",29),m.YNc(1,uc,1,1,"input",30),m.qZA()),2&t){const t=m.oxw(2);m.xp6(1),m.Q6J("ngIf",t.mayManageStacks())}}function pc(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"input",34),m.NdJ("click",function(t){return t.stopPropagation()})("change",function(e){m.CHM(t);const n=m.oxw().$implicit,i=m.oxw(2);return e?i.selection.toggle(n):null}),m.qZA()}if(2&t){const t=m.oxw().$implicit,e=m.oxw(2);m.Q6J("checked",e.selection.isSelected(t))}}function gc(t,e){if(1&t&&(m.TgZ(0,"td",32),m.YNc(1,pc,1,1,"input",33),m.qZA()),2&t){const t=m.oxw(2);m.xp6(1),m.Q6J("ngIf",t.mayManageStacks())}}function fc(t,e){1&t&&(m.TgZ(0,"th",35),m._uU(1,"Name"),m.qZA())}function hc(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"mat-icon",37),m._uU(2,"folder"),m.qZA(),m.TgZ(3,"a",38),m.NdJ("click",function(t){return t.stopPropagation()}),m._uU(4),m.ALo(5,"filename"),m.qZA(),m.BQk()),2&t){const t=m.oxw().$implicit,e=m.oxw(2);m.xp6(3),m.Q6J("routerLink","/commanding/stacks/browse/"+t.nameWithoutInstance)("queryParams",m.VKq(5,sc,e.yamcs.context)),m.xp6(1),m.hij(" ",m.lcZ(5,3,t.name)," ")}}function Zc(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"a",38),m.NdJ("click",function(t){return t.stopPropagation()}),m._uU(2),m.ALo(3,"basename"),m.ALo(4,"filename"),m.qZA(),m.BQk()),2&t){const t=m.oxw().$implicit,e=m.oxw(2);m.xp6(1),m.Q6J("routerLink","/commanding/stacks/files/"+t.nameWithoutInstance)("queryParams",m.VKq(7,sc,e.yamcs.context)),m.xp6(1),m.hij(" ",m.lcZ(3,3,m.lcZ(4,5,t.name))," ")}}function xc(t,e){if(1&t&&(m.TgZ(0,"td",36),m.YNc(1,hc,6,7,"ng-container",6),m.YNc(2,Zc,5,9,"ng-container",6),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf",t.folder),m.xp6(1),m.Q6J("ngIf",!t.folder)}}function yc(t,e){1&t&&(m.TgZ(0,"th",39),m._uU(1,"Visibility"),m.qZA())}function Ac(t,e){1&t&&(m.TgZ(0,"td",36),m._uU(1," Private "),m.qZA())}function bc(t,e){1&t&&(m.TgZ(0,"th",39),m._uU(1,"Date modified"),m.qZA())}function Tc(t,e){if(1&t&&(m.TgZ(0,"td",36),m._uU(1),m.ALo(2,"datetime"),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.hij(" ",m.lcZ(2,1,t.modified)||"-"," ")}}function vc(t,e){1&t&&m._UZ(0,"th",40)}function Cc(t,e){if(1&t&&(m.TgZ(0,"button",46),m.NdJ("click",function(t){return t.stopPropagation()}),m.TgZ(1,"mat-icon"),m._uU(2,"more_vert"),m.qZA(),m.qZA()),2&t){m.oxw();const t=m.MAs(2);m.Q6J("matMenuTriggerFor",t)}}function qc(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.TgZ(1,"mat-menu",41,42),m.TgZ(3,"button",43),m.NdJ("click",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw(2).renameFile(e)}),m._uU(4," Rename "),m.qZA(),m.TgZ(5,"a",44),m._uU(6," Download "),m.qZA(),m._UZ(7,"mat-divider"),m.TgZ(8,"button",43),m.NdJ("click",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw(2).deleteFile(e)}),m._uU(9," Delete "),m.qZA(),m.qZA(),m.YNc(10,Cc,3,1,"button",45),m.BQk()}if(2&t){const t=m.oxw().$implicit,e=m.oxw(2);m.xp6(5),m.Q6J("href",t.objectUrl,m.LSH),m.xp6(5),m.Q6J("ngIf",e.mayManageStacks())}}function _c(t,e){if(1&t&&(m.TgZ(0,"td",36),m.YNc(1,qc,11,2,"ng-container",6),m.qZA()),2&t){const t=e.$implicit;m.xp6(1),m.Q6J("ngIf",!t.folder)}}function wc(t,e){1&t&&m._UZ(0,"tr",47)}function kc(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"tr",48),m.NdJ("click",function(){const e=m.CHM(t).$implicit;return m.oxw(2).toggleOne(e)}),m.qZA()}if(2&t){const t=e.$implicit,n=m.oxw(2);m.ekj("selected",n.selection.isSelected(t))}}function Nc(t,e){if(1&t&&(m.TgZ(0,"table",14),m.ynx(1,15),m.YNc(2,dc,2,1,"th",16),m.YNc(3,gc,2,1,"td",17),m.BQk(),m.ynx(4,18),m.YNc(5,fc,2,0,"th",19),m.YNc(6,xc,3,2,"td",20),m.BQk(),m.ynx(7,21),m.YNc(8,yc,2,0,"th",22),m.YNc(9,Ac,2,0,"td",20),m.BQk(),m.ynx(10,23),m.YNc(11,bc,2,0,"th",22),m.YNc(12,Tc,3,3,"td",20),m.BQk(),m.ynx(13,24),m.YNc(14,vc,1,0,"th",25),m.YNc(15,_c,2,1,"td",26),m.BQk(),m.YNc(16,wc,1,0,"tr",27),m.YNc(17,kc,1,2,"tr",28),m.qZA()),2&t){const t=m.oxw();m.Q6J("dataSource",t.dataSource),m.xp6(16),m.Q6J("cdkHeaderRowDef",t.displayedColumns),m.xp6(1),m.Q6J("cdkRowDefColumns",t.displayedColumns)}}function Uc(t,e){1&t&&(m.TgZ(0,"app-empty-message"),m._uU(1," Empty directory. "),m.qZA())}function Qc(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"p"),m.TgZ(1,"button",51),m.NdJ("click",function(){return m.CHM(t),m.oxw(4).createStack()}),m._uU(2,"Create a stack"),m.qZA(),m._uU(3," or "),m.TgZ(4,"button",52),m.NdJ("click",function(){return m.CHM(t),m.oxw(4).importStack()}),m._uU(5,"Import a stack"),m.qZA(),m.qZA()}}function Sc(t,e){if(1&t&&(m.TgZ(0,"app-empty-message",50),m.TgZ(1,"p"),m._uU(2," Command stacks are used to interactively execute a prepared set of commands. To start, either: "),m.qZA(),m.YNc(3,Qc,6,0,"p",6),m.qZA()),2&t){const t=m.oxw(3);m.xp6(3),m.Q6J("ngIf",t.mayManageStacks())}}function Ic(t,e){if(1&t&&(m.ynx(0),m.YNc(1,Uc,2,0,"app-empty-message",6),m.YNc(2,Sc,4,1,"app-empty-message",49),m.BQk()),2&t){const t=e.ngIf;m.xp6(1),m.Q6J("ngIf",t.length),m.xp6(1),m.Q6J("ngIf",!t.length)}}function Jc(t,e){if(1&t&&(m.YNc(0,Ic,3,2,"ng-container",6),m.ALo(1,"async")),2&t){const t=m.oxw();m.Q6J("ngIf",m.lcZ(1,1,t.breadcrumb$))}}let Oc=(()=>{class t{constructor(t,e,n,i,o,c,s){this.dialog=t,this.yamcs=e,this.router=i,this.route=o,this.authService=c,this.breadcrumb$=new j.X([]),this.dragActive$=new j.X(!1),this.displayedColumns=["select","name","modified","actions"],this.dataSource=new f.by([]),this.selection=new d.Ov(!0,[]),n.setTitle("Stacks"),this.storageClient=e.createStorageClient(),this.folderPerInstance=s.getConfig().stackFolderPerInstance,this.loadCurrentFolder(),this.routerSubscription=i.events.pipe((0,Vo.h)(t=>t instanceof a.m2)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){const t={delimiter:"/"};let e="";this.folderPerInstance&&(e=this.yamcs.instance+"/");const n=this.route.snapshot.url;n.length?t.prefix=e+n.map(t=>t.path).join("/")+"/":e&&(t.prefix=e),this.storageClient.listObjects("_global","stacks",t).then(t=>{this.updateBrowsePath(),this.changedir(t)})}getNameWithoutInstance(t){return this.folderPerInstance?t.substr(this.yamcs.instance.length):t}changedir(t){this.selection.clear();const e=[];for(const n of t.prefixes||[])e.push({folder:!0,name:n,nameWithoutInstance:this.getNameWithoutInstance(n)});for(const n of t.objects||[])e.push({folder:!1,name:n.name,nameWithoutInstance:this.getNameWithoutInstance(n.name),modified:n.created,objectUrl:this.storageClient.getObjectURL("_global","stacks",n.name)});this.dataSource.data=e}isAllSelected(){const t=this.dataSource.data.length;return this.selection.selected.length===t&&t>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}createStack(){this.dialog.open(Xo,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(t=>{t&&this.router.navigateByUrl(`/commanding/stacks/files/${t}?c=${this.yamcs.context}`)})}importStack(){this.dialog.open(ec,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(t=>{t&&this.loadCurrentFolder()})}getCurrentPath(){let t="";for(const e of this.route.snapshot.url)t+="/"+e.path;return t||"/"}deleteSelectedStacks(){const t=[],e=[];for(const n of this.selection.selected)n.folder?e.push(this.storageClient.listObjects("_global","stacks",{prefix:n.name}).then(e=>{t.push(...(e.objects||[]).map(t=>t.name))})):t.push(n.name);Promise.all(e).then(()=>{if(confirm(`You are about to delete ${t.length} files. Are you sure you want to continue?`)){const e=[];for(const n of t)e.push(this.storageClient.deleteObject("_global","stacks",n));Promise.all(e).then(()=>{this.loadCurrentFolder()})}})}renameFile(t){this.dialog.open(nc,{data:{name:t.name},width:"400px"}).afterClosed().subscribe(t=>{t&&this.loadCurrentFolder()})}deleteFile(t){confirm(`Are you sure you want to delete ${t.nameWithoutInstance}?`)&&this.storageClient.deleteObject("_global","stacks",t.name).then(()=>{this.loadCurrentFolder()})}dragEnter(t){return this.dragActive$.next(!0),t.preventDefault(),t.stopPropagation(),!1}dragOver(t){return t.preventDefault(),t.stopPropagation(),!1}dragLeave(t){return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}drop(t){const e=t.dataTransfer||{};if(e){let t=this.getCurrentPath().substring(1);""!==t&&(t+="/"),Go.v(e).then(e=>{const n=[];for(const i of e){let e=t+i._fullPath;this.folderPerInstance&&(e=this.yamcs.instance+"/"+e);const a=this.storageClient.uploadObject("_global","stacks",e,i);n.push(a)}Promise.all(n).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}mayManageStacks(){const t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket","stacks")||t.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){const t=[];let e="";for(const n of this.route.snapshot.url)e+="/"+n.path,t.push({name:n.path,route:"/commanding/stacks/browse"+e});return this.breadcrumb$.next(t),e||"/"}ngOnDestroy(){this.routerSubscription&&this.routerSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(x.uw),m.Y36(h.C),m.Y36(b.Dx),m.Y36(a.F0),m.Y36(a.gz),m.Y36(G.e),m.Y36(l.E))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&m.Gf(ic,7),2&t){let t;m.iGM(t=m.CRH())&&(e.dropArea=t.first)}},decls:17,vars:16,consts:[["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[1,"droparea",3,"dragenter"],["droparea",""],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],[4,"ngIf"],["mat-table","","class","ya-data-table","style","width: 100%",3,"dataSource",4,"ngIf","ngIfElse"],["empty",""],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"disabled","click"],["link","/commanding/stacks/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table",2,"width","100%",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","","style","width: 400px",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","visibility"],["mat-header-cell","","style","width: 200px",4,"cdkHeaderCellDef"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change",4,"ngIf"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change",4,"ngIf"],["type","checkbox",3,"checked","click","change"],["mat-header-cell","",2,"width","400px"],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"routerLink","queryParams","click"],["mat-header-cell","",2,"width","200px"],["mat-header-cell",""],["overlapTrigger","false",1,"ya-menu"],["fileMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-button","","class","icon",3,"matMenuTriggerFor","click",4,"ngIf"],["mat-button","",1,"icon",3,"matMenuTriggerFor","click"],["mat-header-row",""],["mat-row","",3,"click"],["headerTitle","Command Stacks",4,"ngIf"],["headerTitle","Command Stacks"],[1,"ya-button","primary",3,"click"],[1,"ya-button",3,"click"]],template:function(t,e){if(1&t&&(m.TgZ(0,"app-instance-page"),m.TgZ(1,"app-instance-toolbar"),m._uU(2," Command Stacks \xa0\xa0\xa0 "),m.YNc(3,ac,4,0,"button",0),m.YNc(4,oc,4,0,"button",0),m.YNc(5,cc,4,1,"button",1),m.qZA(),m.TgZ(6,"div",2,3),m.NdJ("dragenter",function(t){return e.dragEnter(t)}),m.ALo(8,"async"),m.TgZ(9,"div",4),m.NdJ("dragover",function(t){return e.dragOver(t)})("dragleave",function(t){return e.dragLeave(t)})("drop",function(t){return e.drop(t)}),m.ALo(10,"async"),m.qZA(),m.TgZ(11,"div",5),m.YNc(12,mc,2,1,"ng-container",6),m.ALo(13,"async"),m.YNc(14,Nc,18,3,"table",7),m.YNc(15,Jc,2,3,"ng-template",null,8,m.W1O),m.qZA(),m.qZA(),m.qZA()),2&t){const t=m.MAs(16);m.xp6(3),m.Q6J("ngIf",e.mayManageStacks()),m.xp6(1),m.Q6J("ngIf",e.mayManageStacks()),m.xp6(1),m.Q6J("ngIf",e.mayManageStacks()),m.xp6(1),m.ekj("active",m.lcZ(8,10,e.dragActive$)),m.xp6(3),m.ekj("hide",!m.lcZ(10,12,e.dragActive$)),m.xp6(3),m.Q6J("ngIf",m.lcZ(13,14,e.breadcrumb$)),m.xp6(2),m.Q6J("ngIf",e.dataSource&&e.dataSource.data.length)("ngIfElse",t)}},directives:[T.a,v.k,k.O5,q.lW,_.Hw,vi.w,Ci.a,k.sg,f.BZ,N.fo,N.D5,N.O_,f.w1,f.fO,f.Dz,N.s$,N.Sq,f.ge,f.ev,a.yS,Ht.VK,Ht.OP,tt.d,Ht.p6,f.XQ,f.Gk,qi.M],pipes:[k.Ov,_i.X,_o.u,U.i],styles:[".droparea[_ngcontent-%COMP%]{overflow:auto}.droparea[_ngcontent-%COMP%], .droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.droparea-overlay[_ngcontent-%COMP%]{box-sizing:border-box;background:rgba(27,97,185,.1);border:1px solid #1b61b9;z-index:10}"],changeDetection:0}),t})(),Yc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&m._UZ(0,"router-outlet")},directives:[a.lC],encapsulation:2,changeDetection:0}),t})();const Mc=[{path:"",canActivate:[c.a,o.z],canActivateChild:[c.a],runGuardsAndResolvers:"always",component:r.K,children:[{path:"clearances",pathMatch:"full",component:R,canActivate:[u]},{path:"send",pathMatch:"full",component:Ki},{path:"send/:qualifiedName",component:Ai},{path:"report/:commandId",component:pn},{path:"history",component:sn},{path:"queues",component:no,canActivate:[s.k]},{path:"stacks",pathMatch:"full",redirectTo:"stacks/browse"},{path:"stacks/browse",component:(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&m._UZ(0,"router-outlet")},directives:[a.lC],encapsulation:2,changeDetection:0}),t})(),children:[{path:"**",component:Oc}]},{path:"stacks/files",component:Yc,children:[{path:"**",component:Fo,canDeactivate:[Ho]}]}]}];let $c=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({providers:[Ho],imports:[[a.Bz.forChild(Mc)],a.Bz]}),t})(),Dc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[i.m,$c]]}),t})()}}]);