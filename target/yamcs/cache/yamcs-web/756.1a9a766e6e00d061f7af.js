(self.webpackChunk_yamcs_webapp=self.webpackChunk_yamcs_webapp||[]).push([[756],{8756:(t,e,i)=>{"use strict";i.r(e),i.d(e,{TelemetryModule:()=>Ir});var n=i(7290),a=i(8293),s=i(5366),o=i(1116);function r(t,e){if(1&t&&s._UZ(0,"img",7),2&t){const t=s.oxw();s.Q6J("src",t.url,s.LSH)}}let c=(()=>{class t{constructor(t){this.storageClient=t.createStorageClient()}init(t){return this.url=this.storageClient.getObjectURL("_global","displays",t),Promise.resolve()}hasPendingChanges(){return!1}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-image-viewer"]],decls:7,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","version","1.1",1,"checkerboard"],["id","pattern","x","0","y","0","width","24","height","24","patternUnits","userSpaceOnUse"],["fill","rgba(204, 204, 204, 0.4)","x","0","width","12","height","12","y","0"],["fill","rgba(204, 204, 204, 0.4)","x","12","width","12","height","12","y","12"],["fill","url(#pattern)","x","0","y","0","width","100%","height","100%"],[1,"wrapper"],[3,"src",4,"ngIf"],[3,"src"]],template:function(t,e){1&t&&(s.O4$(),s.TgZ(0,"svg",0),s.TgZ(1,"pattern",1),s._UZ(2,"rect",2),s._UZ(3,"rect",3),s.qZA(),s._UZ(4,"rect",4),s.qZA(),s.kcU(),s.TgZ(5,"div",5),s.YNc(6,r,1,1,"img",6),s.qZA()),2&t&&(s.xp6(6),s.Q6J("ngIf",e.url))},directives:[o.O5],styles:[".checkerboard[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"],changeDetection:0}),t})();var l=i(1136),u=i(8509);class p{constructor(t,e){this.yamcs=t,this.messageService=e}issueCommand(t,e){const i=[];for(const n in e)i.push({name:n,value:e[n]});this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,t,{assignment:i}).catch(t=>this.messageService.showError(t))}}var m=i(3337),h=i(6243),g=i(2420);const d=["displayContainer"],f="MDB:OPS Name",Z="ops://";let y=(()=>{class t{constructor(t,e,i,n){this.yamcs=t,this.router=e,this.synchronizer=i,this.messageService=n,this.idMapping={},this.pvsByName=new Map,this.subscriptionDirty=!1,this.storageClient=t.createStorageClient()}updateSubscription(){if(this.subscriptionDirty){this.subscriptionDirty=!1,this.parameterSubscription&&this.parameterSubscription.cancel();const t=[];for(const e of this.pvsByName.keys())e.startsWith(Z)?t.push({namespace:f,name:e.substr(6)}):t.push({name:e});t.length&&(this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:t,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},t=>{t.mapping&&(this.idMapping=t.mapping);for(const e of t.invalid||[]){let t=e.name;e.namespace===f&&(t=Z+t);const i=this.display.getPV(t);i&&(i.disconnected=!0)}if(t.values&&t.values.length){const e=new Map;for(const i of t.values){i.id=this.idMapping[i.numericId];let t=i.id.name;i.id.namespace===f&&(t=Z+t),e.set(t,this.toSample(i))}this.display.setValues(e)}}))}}toSample(t){const e={time:u.ZU(t.generationTime),severity:this.toAlarmSeverity(t),value:void 0};return t.engValue&&(e.value=u.Ai(t.engValue),"ENUMERATED"===t.engValue.type&&(e.valueIndex=Number(t.engValue.sint64Value))),e}toAlarmSeverity(t){if("EXPIRED"===t.acquisitionStatus||"NOT_RECEIVED"==t.acquisitionStatus||"INVALID"===t.acquisitionStatus)return l.Xm.INVALID;if(!t.monitoringResult)return l.Xm.NONE;switch(t.monitoringResult){case"DISABLED":case"IN_LIMITS":return l.Xm.NONE;case"WATCH":case"WARNING":case"DISTRESS":return l.Xm.MINOR;case"CRITICAL":case"SEVERE":return l.Xm.MAJOR}}init(t){this.display=new l.sS(this.displayContainer.nativeElement);let e="";-1!==t.lastIndexOf("/")&&(e=t.substring(0,t.lastIndexOf("/")+1)),this.display.addScriptLibrary("Yamcs",new p(this.yamcs,this.messageService)),this.display.addEventListener("opendisplay",t=>{this.router.navigateByUrl(`/telemetry/displays/files/${e}${t.path}?c=${this.yamcs.context}`)}),this.display.addEventListener("closedisplay",t=>{this.router.navigateByUrl(`/telemetry/displays/browse?c=${this.yamcs.context}`)}),this.display.addEventListener("openpv",t=>{if(t.pvName.startsWith("/")){const e=encodeURIComponent(t.pvName);this.router.navigateByUrl(`/telemetry/parameters/${e}/summary?c=${this.yamcs.context}`)}else t.pvName.startsWith(Z)?this.yamcs.yamcsClient.getParameterById(this.yamcs.instance,{namespace:f,name:t.pvName.substr(6)}).then(t=>{const e=encodeURIComponent(t.qualifiedName);this.router.navigateByUrl(`/telemetry/parameters/${e}/summary?c=${this.yamcs.context}`)}):alert(`Can't navigate to PV ${t.pvName}`)}),this.display.addProvider(this);const i=this.storageClient.getObjectURL("_global","displays",t),n=i.lastIndexOf("/")+1;this.display.baseUrl=i.substring(0,n);const a=this.display.setSource(i.substring(n));return a.then(()=>{this.syncSubscription=this.synchronizer.sync(()=>this.updateSubscription())}),a}canProvide(t){return!0}startProviding(t){for(const e of t)this.pvsByName.set(e.name,e);this.subscriptionDirty=!0}stopProviding(t){for(const e of t)this.pvsByName.delete(e.name);this.subscriptionDirty=!0}isNavigable(){return!0}shutdown(){}hasPendingChanges(){return!1}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.parameterSubscription&&this.parameterSubscription.cancel()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(m.F0),s.Y36(h.j),s.Y36(g.e))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-opi-display-viewer"]],viewQuery:function(t,e){if(1&t&&s.Gf(d,7),2&t){let t;s.iGM(t=s.CRH())&&(e.displayContainer=t.first)}},decls:2,vars:0,consts:[[2,"width","100%","height","100%"],["displayContainer",""]],template:function(t,e){1&t&&s._UZ(0,"div",0,1)},encapsulation:2,changeDetection:0}),t})();var x=i(8378),v=i(8512),b=i(8981),w=i(7030);class A{constructor(t=10){this.pointer=0,this.latestValues=new Map,this.buf=Array(t).fill(void 0)}push(t,e){const i={};for(const n of t)i[e[n.numericId].name]=n;this.buf[this.pointer]=i,this.pointer=(this.pointer+1)%this.buf.length;for(const n of t)this.latestValues.set(e[n.numericId].name,n)}getLatestValue(t){return this.latestValues.get(t)}setSize(t){this.buf=Array(t).fill(void 0),this.pointer=0}snapshot(){return 0===this.pointer?[...this.buf]:[...this.buf.slice(this.pointer),...this.buf.slice(0,this.pointer)].reverse()}}var T=i(2935),S=i(7340),q=i(5722),C=i(4259),N=i(2401),_=i(4369),U=i(7307),I=i(9979),k=i(487);function Q(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",20),s.TgZ(1,"input",21),s.NdJ("change",function(e){s.CHM(t);const i=s.oxw(2);return e?i.masterToggle():null}),s.qZA(),s.qZA()}if(2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())}}function J(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",22),s.TgZ(1,"input",23),s.NdJ("click",function(t){return t.stopPropagation()})("change",function(e){const i=s.CHM(t).$implicit,n=s.oxw(2);return e?n.selection.toggle(i.name):null}),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,i=s.oxw(2);s.xp6(1),s.Q6J("checked",i.selection.isSelected(t.name))}}function Y(t,e){1&t&&(s.TgZ(0,"th",24),s._uU(1,"Name"),s.qZA())}const M=function(t){return["/telemetry/parameters",t]},O=function(t){return{c:t}};function D(t,e){if(1&t&&(s.TgZ(0,"td",25),s.TgZ(1,"a",26),s._uU(2),s.qZA(),s.qZA()),2&t){const t=e.$implicit,i=s.oxw(2);s.xp6(1),s.Q6J("routerLink",s.VKq(3,M,t.name))("queryParams",s.VKq(5,O,i.yamcs.context)),s.xp6(1),s.hij(" ",t.name," ")}}function P(t,e){1&t&&(s.TgZ(0,"th",27),s._uU(1,"Severity"),s.qZA())}function L(t,e){if(1&t&&s._UZ(0,"app-alarm-level",30),2&t){const t=s.oxw().$implicit;s.Q6J("level",null==t.pval?null:t.pval.monitoringResult)}}function R(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"-"),s.qZA())}function $(t,e){if(1&t&&(s.TgZ(0,"td",22),s.YNc(1,L,1,1,"app-alarm-level",28),s.YNc(2,R,2,0,"span",29),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",null==t.pval?null:t.pval.monitoringResult),s.xp6(1),s.Q6J("ngIf",!(null!=t.pval&&t.pval.monitoringResult))}}function E(t,e){1&t&&(s.TgZ(0,"th",31),s._uU(1,"Raw"),s.qZA())}function H(t,e){if(1&t&&(s.TgZ(0,"td",22),s._uU(1),s.ALo(2,"value"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,null==t.pval?null:t.pval.rawValue)||"-")}}function V(t,e){1&t&&(s.TgZ(0,"th",31),s._uU(1,"Eng"),s.qZA())}function F(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"\u2193"),s.qZA())}function B(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"\u2191"),s.qZA())}function j(t,e){if(1&t&&(s.TgZ(0,"app-expirable",33),s._uU(1),s.ALo(2,"value"),s.YNc(3,F,2,0,"span",29),s.YNc(4,B,2,0,"span",29),s.qZA()),2&t){const t=s.oxw().$implicit;s.Q6J("pval",t.pval),s.xp6(1),s.hij(" ",s.lcZ(2,4,null==t.pval?null:t.pval.engValue)||"-"," "),s.xp6(2),s.Q6J("ngIf","LOW"===(null==t.pval?null:t.pval.rangeCondition)),s.xp6(1),s.Q6J("ngIf","HIGH"===(null==t.pval?null:t.pval.rangeCondition))}}function z(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"-"),s.qZA())}function G(t,e){if(1&t&&(s.TgZ(0,"td",22),s.YNc(1,j,5,6,"app-expirable",32),s.YNc(2,z,2,0,"span",29),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",t.pval),s.xp6(1),s.Q6J("ngIf",!t.pval)}}function X(t,e){1&t&&(s.TgZ(0,"th",31),s._uU(1,"Reception time"),s.qZA())}function W(t,e){if(1&t&&(s.TgZ(0,"td",25),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,null==t.pval?null:t.pval.acquisitionTime)||"-","")}}function K(t,e){1&t&&(s.TgZ(0,"th",31),s._uU(1,"Generation time"),s.qZA())}function tt(t,e){if(1&t&&(s.TgZ(0,"td",25),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij("",s.lcZ(2,1,null==t.pval?null:t.pval.generationTime)||"-"," ")}}function et(t,e){1&t&&(s.TgZ(0,"th",34),s._uU(1,"Acquisition status"),s.qZA())}function it(t,e){if(1&t&&(s.TgZ(0,"td",22),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu((null==t.pval?null:t.pval.acquisitionStatus)||"-")}}function nt(t,e){1&t&&s._UZ(0,"th",24)}function at(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",22),s.TgZ(1,"button",35),s.NdJ("click",function(e){const i=s.CHM(t).index;return s.oxw(2).moveDown.emit(i),e.stopPropagation()}),s.TgZ(2,"mat-icon"),s._uU(3,"keyboard_arrow_down"),s.qZA(),s.qZA(),s.TgZ(4,"button",35),s.NdJ("click",function(e){const i=s.CHM(t).index;return s.oxw(2).moveUp.emit(i),e.stopPropagation()}),s.TgZ(5,"mat-icon"),s._uU(6,"keyboard_arrow_up"),s.qZA(),s.qZA(),s.qZA()}}function st(t,e){1&t&&s._UZ(0,"tr",36)}function ot(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr",37),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).toggleOne(e.name)}),s.qZA()}if(2&t){const t=e.$implicit,i=s.oxw(2);s.ekj("selected",i.selection.isSelected(t.name))}}function rt(t,e){if(1&t&&(s.TgZ(0,"table",1),s.ynx(1,2),s.YNc(2,Q,2,1,"th",3),s.YNc(3,J,2,1,"td",4),s.BQk(),s.ynx(4,5),s.YNc(5,Y,2,0,"th",6),s.YNc(6,D,3,7,"td",7),s.BQk(),s.ynx(7,8),s.YNc(8,P,2,0,"th",9),s.YNc(9,$,3,2,"td",4),s.BQk(),s.ynx(10,10),s.YNc(11,E,2,0,"th",11),s.YNc(12,H,3,3,"td",4),s.BQk(),s.ynx(13,12),s.YNc(14,V,2,0,"th",11),s.YNc(15,G,3,2,"td",4),s.BQk(),s.ynx(16,13),s.YNc(17,X,2,0,"th",11),s.YNc(18,W,3,3,"td",7),s.BQk(),s.ynx(19,14),s.YNc(20,K,2,0,"th",11),s.YNc(21,tt,3,3,"td",7),s.BQk(),s.ynx(22,15),s.YNc(23,et,2,0,"th",16),s.YNc(24,it,2,1,"td",4),s.BQk(),s.ynx(25,17),s.YNc(26,nt,1,0,"th",6),s.YNc(27,at,7,0,"td",4),s.BQk(),s.YNc(28,st,1,0,"tr",18),s.YNc(29,ot,1,2,"tr",19),s.qZA()),2&t){const t=s.oxw();s.ekj("paused",t.paused),s.Q6J("dataSource",t.dataSource),s.xp6(28),s.Q6J("cdkHeaderRowDef",t.displayedColumns),s.xp6(1),s.Q6J("cdkRowDefColumns",t.displayedColumns)}}let ct=(()=>{class t{constructor(t,e,i){this.yamcs=t,this.changeDetector=e,this.model={scroll:!1,columns:[],parameters:[]},this.moveUp=new s.vpe,this.moveDown=new s.vpe,this.dataSource=new S.by([]),this.defaultColumns=["severity","name","generationTime","rawValue","engValue","acquisitionStatus"],this.syncSubscription=i.syncFast(()=>{this.paused||this.refreshTable()})}ngOnInit(){this.refreshTable()}refreshTable(){const t=this.model.parameters.map(t=>({name:t}));for(const e of t)e.pval=this.buffer.getLatestValue(e.name);this.dataSource.data=t,this.changeDetector.detectChanges()}ngOnChanges(){this.displayedColumns=this.showActions?["select",...this.defaultColumns,"actions"]:this.defaultColumns}isAllSelected(){const t=this.dataSource.data.length;return this.selection.selected.length===t&&t>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t.name))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(s.sBO),s.Y36(h.j))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-multiple-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused",selection:"selection"},outputs:{moveUp:"moveUp",moveDown:"moveDown"},features:[s.TTD],decls:1,vars:1,consts:[["mat-table","","class","ya-data-table",3,"dataSource","paused",4,"ngIf"],["mat-table","",1,"ya-data-table",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","style","width: 40px; text-align: left",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"cdkCellDef"],["cdkColumnDef","severity"],["mat-header-cell","","style","width: 80px",4,"cdkHeaderCellDef"],["cdkColumnDef","rawValue"],["mat-header-cell","","style","width: 200px",4,"cdkHeaderCellDef"],["cdkColumnDef","engValue"],["cdkColumnDef","receptionTime"],["cdkColumnDef","generationTime"],["cdkColumnDef","acquisitionStatus"],["mat-header-cell","","style","width: 150px",4,"cdkHeaderCellDef"],["cdkColumnDef","actions"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",2,"width","40px","text-align","left"],["type","checkbox",3,"checked","change"],["mat-cell",""],["type","checkbox",3,"checked","click","change"],["mat-header-cell",""],["mat-cell","",2,"white-space","nowrap"],[3,"routerLink","queryParams"],["mat-header-cell","",2,"width","80px"],[3,"level",4,"ngIf"],[4,"ngIf"],[3,"level"],["mat-header-cell","",2,"width","200px"],[3,"pval",4,"ngIf"],[3,"pval"],["mat-header-cell","",2,"width","150px"],["mat-button","",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(t,e){1&t&&s.YNc(0,rt,30,5,"table",0),2&t&&s.Q6J("ngIf",e.dataSource.data.length)},directives:[o.O5,S.BZ,q.fo,q.D5,q.O_,q.s$,q.Sq,S.ge,S.ev,m.yS,C.i,N.Y,_.lW,U.Hw,S.XQ,S.Gk],pipes:[I.V,k.i],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-right:20px!important;line-height:20px}.paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"]}),t})();var lt=i(1041),ut=i(7070),pt=i(6278);function mt(t,e){1&t&&(s.TgZ(0,"th",9),s._uU(1,"Generation time"),s.qZA())}function ht(t,e){if(1&t&&(s.TgZ(0,"td",10),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,t.generationTime)||"-")}}function gt(t,e){if(1&t&&(s.TgZ(0,"button",20),s.NdJ("click",function(t){return t.stopPropagation()}),s.TgZ(1,"mat-icon"),s._uU(2,"more_vert"),s.qZA(),s.qZA()),2&t){s.oxw();const t=s.MAs(4);s.Q6J("matMenuTriggerFor",t)}}const dt=function(t){return["/telemetry/parameters",t]},ft=function(t){return{c:t}};function Zt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",14),s.TgZ(1,"a",15),s._uU(2),s.qZA(),s.TgZ(3,"mat-menu",16,17),s.TgZ(5,"button",18),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().index;return s.oxw(2).moveLeft.emit(e)}),s._uU(6,"Move left"),s.qZA(),s.TgZ(7,"button",18),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().index;return s.oxw(2).moveRight.emit(e)}),s._uU(8,"Move right"),s.qZA(),s._UZ(9,"mat-divider"),s.TgZ(10,"button",18),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw(2).removeColumn.emit(e)}),s._uU(11,"Remove column"),s.qZA(),s.qZA(),s.YNc(12,gt,3,1,"button",19),s.qZA()}if(2&t){const t=s.oxw().$implicit,e=s.oxw(2);s.xp6(1),s.Q6J("routerLink",s.VKq(4,dt,t))("queryParams",s.VKq(6,ft,e.yamcs.context)),s.xp6(1),s.hij(" ",t," "),s.xp6(10),s.Q6J("ngIf",e.showActions)}}function yt(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"\u2193"),s.qZA())}function xt(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"\u2191"),s.qZA())}function vt(t,e){if(1&t&&(s.TgZ(0,"app-expirable",23),s._uU(1),s.ALo(2,"value"),s.YNc(3,yt,2,0,"span",1),s.YNc(4,xt,2,0,"span",1),s.qZA()),2&t){const t=s.oxw().ngIf;s.Q6J("pval",t),s.xp6(1),s.hij(" ",s.lcZ(2,4,t.engValue)||"-"," "),s.xp6(2),s.Q6J("ngIf","LOW"===t.rangeCondition),s.xp6(1),s.Q6J("ngIf","HIGH"===t.rangeCondition)}}function bt(t,e){if(1&t&&(s.ynx(0),s.YNc(1,vt,5,6,"app-expirable",22),s.BQk()),2&t){const t=e.ngIf;s.xp6(1),s.Q6J("ngIf",t)}}function wt(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"-"),s.qZA())}function At(t,e){if(1&t&&(s.TgZ(0,"td",21),s.YNc(1,bt,2,1,"ng-container",1),s.YNc(2,wt,2,0,"span",1),s.qZA()),2&t){const t=e.$implicit,i=s.oxw().$implicit;s.xp6(1),s.Q6J("ngIf",t.pvals[i]),s.xp6(1),s.Q6J("ngIf",!t.pvals[i])}}function Tt(t,e){1&t&&(s.ynx(0,11),s.YNc(1,Zt,13,8,"th",12),s.YNc(2,At,3,2,"td",13),s.BQk()),2&t&&s.Q6J("cdkColumnDef",e.$implicit)}function St(t,e){1&t&&s._UZ(0,"tr",24)}function qt(t,e){1&t&&s._UZ(0,"tr",25)}function Ct(t,e){if(1&t&&(s.TgZ(0,"table",2),s.ynx(1,3),s.YNc(2,mt,2,0,"th",4),s.YNc(3,ht,3,3,"td",5),s.BQk(),s.YNc(4,Tt,3,1,"ng-container",6),s.YNc(5,St,1,0,"tr",7),s.YNc(6,qt,1,0,"tr",8),s.qZA()),2&t){const t=s.oxw();s.ekj("paused",t.paused),s.Q6J("dataSource",t.dataSource),s.xp6(4),s.Q6J("ngForOf",t.model.parameters),s.xp6(1),s.Q6J("cdkHeaderRowDef",t.displayedColumns),s.xp6(1),s.Q6J("cdkRowDefColumns",t.displayedColumns)}}function Nt(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"p"),s._uU(2,"\xa0"),s.qZA(),s._uU(3," Buffer size: "),s.TgZ(4,"select",26),s.TgZ(5,"option",27),s._uU(6,"10"),s.qZA(),s.TgZ(7,"option",28),s._uU(8,"25"),s.qZA(),s.TgZ(9,"option",29),s._uU(10,"50"),s.qZA(),s.TgZ(11,"option",30),s._uU(12,"75"),s.qZA(),s.TgZ(13,"option",31),s._uU(14,"100"),s.qZA(),s.qZA(),s.BQk()),2&t){const t=s.oxw();s.xp6(4),s.Q6J("formControl",t.bufferSizeControl)}}let _t=(()=>{class t{constructor(t,e,i){this.yamcs=t,this.changeDetector=e,this.model={scroll:!0,columns:[],parameters:[]},this.removeColumn=new s.vpe,this.moveLeft=new s.vpe,this.moveRight=new s.vpe,this.bufferSize=new s.vpe,this.dataSource=new S.by([]),this.bufferSizeControl=new lt.NI("10"),this.displayedColumns=["generationTime"],this.syncSubscription=i.syncFast(()=>{this.paused||this.refreshTable()}),this.bufferSizeControl.valueChanges.subscribe(()=>{const t=this.bufferSizeControl.value;t!==String(this.model.bufferSize)&&this.bufferSize.emit(parseInt(t,10))})}ngOnInit(){this.model.bufferSize&&(this.buffer.setSize(this.model.bufferSize),this.bufferSizeControl.setValue(String(this.model.bufferSize))),this.refreshTable()}refreshTable(){const t=[],e=this.buffer.snapshot();for(const i of e){const e=this.findAnyMatchingParameterValue(i);e&&t.push({generationTime:e.generationTime,pvals:i})}this.dataSource.data=t,this.changeDetector.detectChanges()}findAnyMatchingParameterValue(t){for(const e in t)if(t.hasOwnProperty(e)&&-1!==this.model.parameters.indexOf(e))return t[e]}ngOnChanges(){this.displayedColumns=["generationTime",...this.model.parameters]}ngOnDestroy(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.bufferSizeControlSubscription&&this.bufferSizeControlSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(s.sBO),s.Y36(h.j))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-scrolling-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused"},outputs:{removeColumn:"removeColumn",moveLeft:"moveLeft",moveRight:"moveRight",bufferSize:"bufferSize"},features:[s.TTD],decls:2,vars:2,consts:[["mat-table","","class","ya-data-table",3,"dataSource","paused",4,"ngIf"],[4,"ngIf"],["mat-table","",1,"ya-data-table",3,"dataSource"],["cdkColumnDef","generationTime"],["mat-header-cell","","style","width: 200px",4,"cdkHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"cdkCellDef"],[3,"cdkColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",2,"width","200px"],["mat-cell","",2,"white-space","nowrap"],[3,"cdkColumnDef"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["mat-header-cell",""],[3,"routerLink","queryParams"],["overlapTrigger","false",1,"ya-menu"],["colMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-button","",3,"matMenuTriggerFor","click",4,"ngIf"],["mat-button","",3,"matMenuTriggerFor","click"],["mat-cell",""],[3,"pval",4,"ngIf"],[3,"pval"],["mat-header-row",""],["mat-row",""],[3,"formControl"],["value","10"],["value","25"],["value","50"],["value","75"],["value","100"]],template:function(t,e){1&t&&(s.YNc(0,Ct,7,6,"table",0),s.YNc(1,Nt,15,1,"ng-container",1)),2&t&&(s.Q6J("ngIf",e.dataSource.data.length),s.xp6(1),s.Q6J("ngIf",e.showActions))},directives:[o.O5,S.BZ,q.fo,q.D5,q.O_,o.sg,q.s$,q.Sq,S.ge,S.ev,m.yS,ut.VK,ut.OP,pt.d,_.lW,ut.p6,U.Hw,N.Y,S.XQ,S.Gk,lt.EJ,lt.JJ,lt.oH,lt.YN,lt.Kr],pipes:[k.i,I.V],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-right:20px!important;line-height:20px}.paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"]}),t})();var Ut=i(4626);function It(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"app-multiple-parameter-table",6),s.NdJ("moveUp",function(e){return s.CHM(t),s.oxw(3).moveUp(e)})("moveDown",function(e){return s.CHM(t),s.oxw(3).moveDown(e)}),s.ALo(1,"async"),s.ALo(2,"async"),s.qZA()}if(2&t){const t=s.oxw(2).ngIf,e=s.oxw();s.Q6J("model",t)("buffer",e.buffer)("paused",s.lcZ(1,5,e.paused$))("showActions",s.lcZ(2,7,e.showActions$))("selection",e.selection)}}function kt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"app-scrolling-parameter-table",7),s.NdJ("moveLeft",function(e){return s.CHM(t),s.oxw(3).moveUp(e)})("moveRight",function(e){return s.CHM(t),s.oxw(3).moveDown(e)})("removeColumn",function(e){return s.CHM(t),s.oxw(3).removeParameter(e)})("bufferSize",function(e){return s.CHM(t),s.oxw(3).setBufferSize(e)}),s.ALo(1,"async"),s.ALo(2,"async"),s.qZA()}if(2&t){const t=s.oxw(2).ngIf,e=s.oxw();s.Q6J("model",t)("buffer",e.buffer)("paused",s.lcZ(1,4,e.paused$))("showActions",s.lcZ(2,6,e.showActions$))}}function Qt(t,e){if(1&t&&(s.ynx(0),s.YNc(1,It,3,9,"app-multiple-parameter-table",4),s.YNc(2,kt,3,8,"app-scrolling-parameter-table",5),s.BQk()),2&t){const t=s.oxw().ngIf;s.xp6(1),s.Q6J("ngIf",!t.scroll),s.xp6(1),s.Q6J("ngIf",t.scroll)}}function Jt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"app-empty-message"),s.TgZ(1,"div",8),s.TgZ(2,"p"),s._uU(3," This file is empty. "),s._UZ(4,"br"),s._uU(5,"Start by "),s.TgZ(6,"a",9),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).showAddParameterDialog()}),s._uU(7,"adding a parameter"),s.qZA(),s._uU(8,". "),s.qZA(),s.qZA(),s.qZA()}}function Yt(t,e){if(1&t&&(s.TgZ(0,"div",1),s.YNc(1,Qt,3,2,"ng-container",2),s.YNc(2,Jt,9,0,"ng-template",null,3,s.W1O),s.qZA()),2&t){const t=e.ngIf,i=s.MAs(3);s.xp6(1),s.Q6J("ngIf",t.parameters.length)("ngIfElse",i)}}let Mt=(()=>{class t{constructor(t,e,i,n){this.yamcs=t,this.changeDetector=e,this.dialog=i,this.configService=n,this.selection=new x.Ov(!0,[]),this.model$=new v.X(null),this.buffer=new A,this.paused$=new v.X(!1),this.hasUnsavedChanges$=new v.X(!1),this.showActions$=new v.X(!1),this.storageClient=t.createStorageClient()}init(t){return this.objectName=t,this.storageClient.getObject("_global","displays",t).then(t=>{t.text().then(t=>{const e=JSON.parse(t);this.model$.next(e),this.createOrModifySubscription()})}),Promise.resolve()}setEnableActions(){this.showActions$.next(!0)}hasPendingChanges(){return this.hasUnsavedChanges$.value}createOrModifySubscription(){const t=this.model$.value.parameters.map(t=>({name:t}));t.length&&(this.dataSubscription?this.dataSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:t,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"}):this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:t,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},t=>{t.mapping&&(this.idMapping=t.mapping),this.buffer.push(t.values||[],this.idMapping)}))}addParameter(t){const e=this.model$.value;e.parameters.push(t),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0),this.createOrModifySubscription()}emitModelUpdate(t){this.model$.next({scroll:t.scroll,bufferSize:t.bufferSize||10,columns:t.columns,parameters:t.parameters})}getModel(){return this.model$.value}pause(){this.paused$.next(!0)}unpause(){this.paused$.next(!1)}delete(){if(!this.selection.isEmpty()){const t=this.model$.value;t.parameters=t.parameters.filter(t=>!this.selection.isSelected(t)),this.emitModelUpdate(t),this.hasUnsavedChanges$.next(!0)}this.selection.clear()}enableScrollView(){this.selection.clear();const t=this.model$.value;t.scroll=!0,this.emitModelUpdate(t),this.hasUnsavedChanges$.next(!0)}enableStandardView(){this.selection.clear();const t=this.model$.value;t.scroll=!1,this.emitModelUpdate(t),this.hasUnsavedChanges$.next(!0)}removeParameter(t){const e=this.model$.value;e.parameters=e.parameters.filter(e=>e!==t),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}moveUp(t){const e=this.model$.value,i=e.parameters[t];0===t?(e.parameters[t]=e.parameters[e.parameters.length-1],e.parameters[e.parameters.length-1]=i):(e.parameters[t]=e.parameters[t-1],e.parameters[t-1]=i),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}moveDown(t){const e=this.model$.value,i=e.parameters[t];t===e.parameters.length-1?(e.parameters[t]=e.parameters[0],e.parameters[0]=i):(e.parameters[t]=e.parameters[t+1],e.parameters[t+1]=i),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}setBufferSize(t){this.buffer.setSize(t);const e=this.model$.value;e.bufferSize=t,this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}save(){const t=new Blob([JSON.stringify(this.model$.value,void 0,2)]);return this.storageClient.uploadObject("_global","displays",this.objectName,t).then(()=>{this.hasUnsavedChanges$.next(!1)})}showAddParameterDialog(){this.dialog.open(w.M,{width:"500px",data:{okLabel:"ADD",exclude:this.getModel().parameters}}).afterClosed().subscribe(t=>{t&&this.addParameter(t)})}ngOnDestroy(){this.dataSubscription&&this.dataSubscription.cancel()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(s.sBO),s.Y36(T.uw),s.Y36(b.E))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-parameter-table-viewer"]],decls:2,vars:3,consts:[["class","panel-content",4,"ngIf"],[1,"panel-content"],[4,"ngIf","ngIfElse"],["empty",""],[3,"model","buffer","paused","showActions","selection","moveUp","moveDown",4,"ngIf"],[3,"model","buffer","paused","showActions","moveLeft","moveRight","removeColumn","bufferSize",4,"ngIf"],[3,"model","buffer","paused","showActions","selection","moveUp","moveDown"],[3,"model","buffer","paused","showActions","moveLeft","moveRight","removeColumn","bufferSize"],[2,"text-align","left"],[1,"ya-link",2,"cursor","pointer",3,"click"]],template:function(t,e){1&t&&(s.YNc(0,Yt,4,2,"div",0),s.ALo(1,"async")),2&t&&s.Q6J("ngIf",s.lcZ(1,1,e.model$))},directives:[o.O5,ct,_t,Ut.M],pipes:[o.Ov],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-right:20px!important;line-height:20px}.paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0}),t})();var Ot=i(8561),Dt=i(6764),Pt=i(7487);let Lt=(()=>{class t{constructor(t,e,i){this.dialogRef=t,this.yamcs=e,this.data=i,this.downloadURL$=new v.X(null),this.form=new lt.cw({start:new lt.NI(null,lt.kI.required),stop:new lt.NI(null,lt.kI.required)});let n=i.start,a=i.stop;n&&a||(a=e.getMissionTime(),n=(0,u.rV)(a,"PT1H")),this.form.setValue({start:u.Y6(n),stop:u.Y6(a)}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){const t=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,{start:u.Y6(this.form.value.start),stop:u.Y6(this.form.value.stop),parameters:this.data.parameterIds});this.downloadURL$.next(t)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription&&this.formChangeSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.so),s.Y36(a.C),s.Y36(T.WI))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-export-archive-data-dialog"]],decls:16,vars:6,consts:[["mat-dialog-title",""],[1,"mat-typography","ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close","",1,"ya-button"],[3,"link","primary","disabled","click"]],template:function(t,e){1&t&&(s.TgZ(0,"h2",0),s._uU(1,"Export archive data"),s.qZA(),s.TgZ(2,"mat-dialog-content",1),s.TgZ(3,"form",2),s.TgZ(4,"label"),s._uU(5," Start "),s._UZ(6,"app-date-time-input",3),s.qZA(),s.TgZ(7,"label"),s._uU(8," Stop "),s._UZ(9,"app-date-time-input",4),s.qZA(),s.qZA(),s.qZA(),s.TgZ(10,"mat-dialog-actions",5),s.TgZ(11,"button",6),s._uU(12,"CANCEL"),s.qZA(),s.TgZ(13,"app-download-button",7),s.NdJ("click",function(){return e.closeDialog()}),s.ALo(14,"async"),s._uU(15," DOWNLOAD "),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("formGroup",e.form),s.xp6(10),s.Q6J("link",s.lcZ(14,4,e.downloadURL$))("primary",!0)("disabled",!e.form.valid))},directives:[T.uh,T.xY,lt._Y,lt.JL,lt.sg,Dt.Y,lt.JJ,lt.u,T.H8,T.ZT,Pt.o],pipes:[o.Ov],encapsulation:2}),t})();var Rt=i(3589),$t=i(4311);function Et(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",10),s.NdJ("click",function(){return s.CHM(t),s.oxw(3).save()}),s.ALo(1,"async"),s.TgZ(2,"mat-icon"),s._uU(3,"save"),s.qZA(),s._uU(4," SAVE "),s.qZA()}if(2&t){const t=s.oxw(3);s.Q6J("disabled",!s.lcZ(1,1,t.viewer.hasUnsavedChanges$))}}function Ht(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",11),s.NdJ("click",function(){return s.CHM(t),s.oxw(3).viewer.pause()}),s.TgZ(1,"mat-icon"),s._uU(2,"pause"),s.qZA(),s._uU(3," PAUSE "),s.qZA()}}function Vt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",12),s.NdJ("click",function(){return s.CHM(t),s.oxw(3).viewer.unpause()}),s.TgZ(1,"mat-icon"),s._uU(2,"play_arrow"),s.qZA(),s._uU(3," UNPAUSE "),s.qZA()}}function Ft(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",10),s.NdJ("click",function(){return s.CHM(t),s.oxw(3).viewer.delete()}),s.TgZ(1,"mat-icon"),s._uU(2,"delete"),s.qZA(),s._uU(3," DELETE "),s.qZA()}if(2&t){const t=s.oxw(3);s.Q6J("disabled",t.viewer.selection.isEmpty())}}function Bt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",4),s.NdJ("click",function(){return s.CHM(t),s.oxw(3).viewer.enableScrollView()}),s.TgZ(1,"mat-icon",13),s._uU(2,"view_headline"),s.qZA(),s._uU(3," SCROLL VIEW "),s.qZA()}}function jt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",4),s.NdJ("click",function(){return s.CHM(t),s.oxw(3).viewer.enableStandardView()}),s.TgZ(1,"mat-icon"),s._uU(2,"view_headline"),s.qZA(),s._uU(3," STANDARD VIEW "),s.qZA()}}function zt(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.YNc(1,Et,5,3,"button",1),s.YNc(2,Ht,4,0,"button",2),s.ALo(3,"async"),s.YNc(4,Vt,4,0,"button",3),s.ALo(5,"async"),s.TgZ(6,"button",4),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).addParameter()}),s.TgZ(7,"mat-icon"),s._uU(8,"playlist_add"),s.qZA(),s._uU(9," ADD "),s.qZA(),s.YNc(10,Ft,4,1,"button",1),s.YNc(11,Bt,4,0,"button",5),s.YNc(12,jt,4,0,"button",5),s.TgZ(13,"mat-menu",6,7),s.TgZ(15,"button",8),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).exportArchiveData()}),s._uU(16," Export archive data... "),s.qZA(),s.qZA(),s.TgZ(17,"button",9),s.NdJ("click",function(t){return t.stopPropagation()}),s.TgZ(18,"mat-icon"),s._uU(19,"more_vert"),s.qZA(),s.qZA(),s.BQk()}if(2&t){const t=e.ngIf,i=s.MAs(14),n=s.oxw(2);s.xp6(1),s.Q6J("ngIf",n.mayManageDisplays()),s.xp6(1),s.Q6J("ngIf",!s.lcZ(3,8,n.viewer.paused$)),s.xp6(2),s.Q6J("ngIf",s.lcZ(5,10,n.viewer.paused$)),s.xp6(6),s.Q6J("ngIf",!t.scroll),s.xp6(1),s.Q6J("ngIf",!t.scroll),s.xp6(1),s.Q6J("ngIf",t.scroll),s.xp6(3),s.Q6J("disabled",!t.parameters.length),s.xp6(2),s.Q6J("matMenuTriggerFor",i)}}function Gt(t,e){if(1&t&&(s.ynx(0),s.YNc(1,zt,20,12,"ng-container",0),s.ALo(2,"async"),s.BQk()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",s.lcZ(2,1,t.viewer.model$))}}let Xt=(()=>{class t{constructor(t,e,i){this.dialog=t,this.snackbar=e,this.authService=i,this.initialized$=new v.X(!1)}init(t){this.viewer=t,this.initialized$.next(!0)}addParameter(){this.dialog.open(w.M,{width:"500px",data:{okLabel:"ADD",exclude:this.viewer.getModel().parameters}}).afterClosed().subscribe(t=>{t&&this.viewer.addParameter(t)})}mayManageDisplays(){const t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket","displays")||t.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(t=>{this.snackbar.open("Failed to save changes: "+t)})}exportArchiveData(){let t=this.viewer.selection.selected;t.length||(t=this.viewer.getModel().parameters),this.dialog.open(Lt,{width:"400px",data:{parameterIds:t}})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.uw),s.Y36(Rt.ux),s.Y36(Ot.e))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-parameter-table-viewer-controls"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-button","","color","primary","matTooltip","Pause value updates",3,"click",4,"ngIf"],["mat-button","","color","primary","matTooltip","Unpause value updates",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"click",4,"ngIf"],["overlapTrigger","false"],["moreMenu","matMenu"],["mat-menu-item","",3,"disabled","click"],["mat-button","",3,"matMenuTriggerFor","click"],["mat-button","","color","primary",3,"disabled","click"],["mat-button","","color","primary","matTooltip","Pause value updates",3,"click"],["mat-button","","color","primary","matTooltip","Unpause value updates",3,"click"],[2,"transform","rotate(90deg)"]],template:function(t,e){1&t&&(s.YNc(0,Gt,3,3,"ng-container",0),s.ALo(1,"async")),2&t&&s.Q6J("ngIf",s.lcZ(1,1,e.initialized$))},directives:[o.O5,_.lW,U.Hw,ut.VK,ut.OP,ut.p6,$t.gM],pipes:[o.Ov],encapsulation:2}),t})();var Wt=i(9821);i(296),i(9125),i(3782);const Kt=["scriptContainer"];let te=(()=>{class t{constructor(t,e){this.changeDetector=e,this.storageClient=t.createStorageClient()}init(t){return this.storageClient.getObject("_global","displays",t).then(t=>{t.text().then(t=>{this.scriptContainer.nativeElement.innerHTML=t,this.editor=Wt.edit(this.scriptContainer.nativeElement),this.editor.setReadOnly(!0),this.editor.getSession().setMode("ace/mode/javascript"),this.changeDetector.detectChanges()})}),this.editor.setTheme("ace/theme/eclipse"),Promise.resolve()}hasPendingChanges(){return!1}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(s.sBO))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-script-viewer"]],viewQuery:function(t,e){if(1&t&&s.Gf(Kt,7),2&t){let t;s.iGM(t=s.CRH())&&(e.scriptContainer=t.first)}},decls:2,vars:0,consts:[[1,"script-container"],["scriptContainer",""]],template:function(t,e){1&t&&s._UZ(0,"div",0,1)},styles:[".script-container[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),t})();function ee(t,e){if(1&t&&(s.TgZ(0,"pre"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Oqu(t.text)}}let ie=(()=>{class t{constructor(t,e){this.changeDetector=e,this.storageClient=t.createStorageClient()}init(t){return this.storageClient.getObject("_global","displays",t).then(t=>{t.text().then(t=>{this.text=t,this.changeDetector.detectChanges()})}),Promise.resolve()}hasPendingChanges(){return!1}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(s.sBO))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-text-viewer"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,e){1&t&&s.YNc(0,ee,2,1,"pre",0),2&t&&s.Q6J("ngIf",e.text)},directives:[o.O5],styles:["pre[_ngcontent-%COMP%]{margin:1em}"],changeDetection:0}),t})(),ne=(()=>{class t{constructor(t){this.viewContainerRef=t}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(s.s_b))},t.\u0275dir=s.lG2({type:t,selectors:[["","app-viewer-controls-host",""]]}),t})(),ae=(()=>{class t{constructor(t){this.viewContainerRef=t}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(s.s_b))},t.\u0275dir=s.lG2({type:t,selectors:[["","app-viewer-host",""]]}),t})(),se=(()=>{class t{transform(t){if(!t)return null;const e=t.toLowerCase();return e.endsWith(".opi")?"Operator Interface":e.endsWith(".par")?"Parameter Table":e.endsWith(".js")?"Script File":-1!==e.indexOf(".")?e.substr(e.lastIndexOf(".")+1).toUpperCase()+" File":null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Yjl({name:"displayType",type:t,pure:!0}),t})(),oe=(()=>{class t{constructor(t){this.yamcs=t}transform(t){return t?this.yamcs.yamcsClient.getPacketDownloadURL(this.yamcs.instance,t.generationTime,t.sequenceNumber):null}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C,16))},t.\u0275pipe=s.Yjl({name:"packetDownloadLink",type:t,pure:!0}),t})();var re=i(7102),ce=i(4017),le=i(9385),ue=i(3835),pe=i(9624),me=i(9451),he=i(6972);const ge=["viewerContainer"];function de(t,e){}function fe(t,e){}const Ze=function(t){return{c:t}};let ye=(()=>{class t{constructor(t,e,i,n,a,s){this.yamcs=t,this.route=e,this.componentFactoryResolver=n,this.title=a,this.folderPerInstance=s.getConfig().displayFolderPerInstance;const o=this.getObjectNameFromUrl();this.loadFile(o),this.routerSubscription=i.events.pipe((0,ue.h)(t=>t instanceof m.m2)).subscribe(()=>{const t=this.getObjectNameFromUrl();t!==this.objectName&&this.loadFile(t,!0)})}getObjectNameFromUrl(){const t=this.route.snapshot.url;let e="";this.folderPerInstance&&(e+=this.yamcs.instance);for(const i of t)e&&(e+="/"),e+=i.path;return e}getNameWithoutInstance(t){return this.folderPerInstance?t.substr(this.yamcs.instance.length):t}loadFile(t,e=!1){this.objectName=t;const i=this.objectName.lastIndexOf("/");if(-1===i)this.folderLink="/telemetry/displays/browse/",this.filename=this.objectName;else{const t=this.getNameWithoutInstance(this.objectName.substring(0,i));this.folderLink="/telemetry/displays/browse/"+t,this.filename=this.objectName.substring(i+1)}this.title.setTitle(this.filename),e&&this.ngAfterViewInit()}ngAfterViewInit(){if(this.filename.toLowerCase().endsWith(".opi")){const t=this.createViewer(y);this.viewer=t}else if(this.filename.toLowerCase().endsWith(".par")){const t=this.createViewer(Mt);this.createViewerControls(Xt).init(t),t.setEnableActions(),this.viewer=t}else this.viewer=this.isImage()?this.createViewer(c):this.filename.toLocaleLowerCase().endsWith(".js")?this.createViewer(te):this.createViewer(ie);this.viewer.init(this.objectName)}createViewer(t){const e=this.componentFactoryResolver.resolveComponentFactory(t),i=this.viewerHost.viewContainerRef;return i.clear(),i.createComponent(e).instance}createViewerControls(t){const e=this.componentFactoryResolver.resolveComponentFactory(t),i=this.controlsHost.viewContainerRef;return i.clear(),i.createComponent(e).instance}isImage(){const t=this.filename.toLowerCase();return t.endsWith(".png")||t.endsWith(".gif")||t.endsWith(".jpg")||t.endsWith("jpeg")||t.endsWith("bmp")}hasPendingChanges(){return this.viewer.hasPendingChanges()}ngOnDestroy(){this.routerSubscription&&this.routerSubscription.unsubscribe(),this.syncSubscription&&this.syncSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(m.gz),s.Y36(m.F0),s.Y36(s._Vd),s.Y36(pe.Dx),s.Y36(b.E))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&(s.Gf(ne,5),s.Gf(ge,5),s.Gf(ae,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.controlsHost=t.first),s.iGM(t=s.CRH())&&(e.viewerContainer=t.first),s.iGM(t=s.CRH())&&(e.viewerHost=t.first)}},decls:10,vars:5,consts:[["mat-icon-button","","color","primary",3,"routerLink","queryParams"],["app-viewer-controls-host",""],[2,"height","100%","width","100%"],["viewerContainer",""],["app-viewer-host",""]],template:function(t,e){1&t&&(s.TgZ(0,"app-instance-page"),s.TgZ(1,"app-instance-toolbar"),s.TgZ(2,"a",0),s.TgZ(3,"mat-icon"),s._uU(4,"arrow_back"),s.qZA(),s.qZA(),s._uU(5),s.YNc(6,de,0,0,"ng-template",1),s.qZA(),s.TgZ(7,"div",2,3),s.YNc(9,fe,0,0,"ng-template",4),s.qZA(),s.qZA()),2&t&&(s.xp6(2),s.Q6J("routerLink",e.folderLink)("queryParams",s.VKq(3,Ze,e.yamcs.context)),s.xp6(3),s.hij(" ",e.filename," "))},directives:[me.a,he.k,_.zs,m.yS,U.Hw,ne,ae],encapsulation:2,changeDetection:0}),t})();var xe=i(8318),ve=i(878);let be=(()=>{class t{constructor(t){this.dialogRef=t}confirmDiscard(){this.dialogRef.close(!0)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.so))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-display-file-page-dirty-dialog"]],decls:8,vars:0,consts:[[1,"mat-typography"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"click"]],template:function(t,e){1&t&&(s.TgZ(0,"mat-dialog-content",0),s.TgZ(1,"p"),s._uU(2,"You have unsaved changes on the current page. Do you want to discard them?"),s.qZA(),s.qZA(),s.TgZ(3,"mat-dialog-actions",1),s.TgZ(4,"button",2),s._uU(5,"CANCEL"),s.qZA(),s.TgZ(6,"button",3),s.NdJ("click",function(){return e.confirmDiscard()}),s._uU(7," DISCARD "),s.qZA(),s.qZA())},directives:[T.xY,T.H8,T.ZT],encapsulation:2}),t})(),we=(()=>{class t{constructor(t,e){this.dialog=t,this.authService=e,this.dialogOpen$=new v.X(!1)}canDeactivate(t){return this.dialogOpen$.value?xe.y.create(t=>{this.dialogRef.afterClosed().subscribe(e=>{t.next(e),t.complete()},e=>{t.next(!1),t.complete()})}):t.hasPendingChanges()&&this.mayManageDisplays()?xe.y.create(t=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(be,{width:"400px"}),this.dialogRef.afterClosed().subscribe(e=>{this.dialogOpen$.next(!1),t.next(e),t.complete()},e=>{this.dialogOpen$.next(!1),t.next(!1),t.complete()})}):(0,ve.of)(!0)}mayManageDisplays(){const t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket","displays")||t.hasSystemPrivilege("ManageAnyBucket")}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(T.uw),s.LFG(Ot.e))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac}),t})();var Ae=i(1641);const Te=["filename"];function Se(t,e){if(1&t&&(s.TgZ(0,"form",7),s.TgZ(1,"label"),s._uU(2," Type "),s.TgZ(3,"select",8),s.TgZ(4,"option",9),s._uU(5,"Parameter Table"),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.Q6J("formGroup",t.typeForm)}}function qe(t,e){1&t&&(s.TgZ(0,"span",14),s._uU(1,"File name must end with "),s.TgZ(2,"code"),s._uU(3,".par"),s.qZA(),s.qZA())}function Ce(t,e){if(1&t&&(s.TgZ(0,"form",7),s.TgZ(1,"label"),s._uU(2," Name "),s._UZ(3,"input",10,11),s.YNc(5,qe,4,0,"span",12),s.qZA(),s._UZ(6,"br"),s.TgZ(7,"label"),s._uU(8," Path "),s._UZ(9,"input",13),s.qZA(),s.qZA()),2&t){const t=s.oxw();let e,i;s.Q6J("formGroup",t.filenameForm),s.xp6(1),s.ekj("invalid",null==(e=t.filenameForm.get("name"))?null:e.invalid),s.xp6(4),s.Q6J("ngIf",null==(i=t.filenameForm.get("name"))?null:i.invalid)}}function Ne(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",15),s.NdJ("click",function(){return s.CHM(t),s.oxw().selectType()}),s._uU(1,"NEXT \xbb"),s.qZA()}if(2&t){const t=s.oxw();s.Q6J("disabled",!t.typeForm.valid)}}function _e(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",16),s.NdJ("click",function(){return s.CHM(t),s.oxw().save()}),s._uU(1,"SAVE"),s.qZA()}if(2&t){const t=s.oxw();s.Q6J("disabled",!t.filenameForm.valid)}}let Ue=(()=>{class t{constructor(t,e,i,n,a){this.dialogRef=t,this.data=n,this.changeDetector=a,this.page=1,this.storageClient=i.createStorageClient(),this.typeForm=e.group({type:["par",lt.kI.required]}),this.filenameForm=e.group({path:[n.path,lt.kI.required],name:["",[lt.kI.required,lt.kI.pattern(/.*\.par/i)]]})}selectType(){const t=this.typeForm.value.type;this.filenameForm.get("name").setValue(`NewFile.${t}`),this.page=2,this.changeDetector.detectChanges(),this.filenameInput.nativeElement.select()}save(){let t=this.filenameForm.get("path").value.trim();const e=this.filenameForm.get("name").value.trim();t.startsWith("/")&&(t=t.substring(1)),t.endsWith("/")&&(t=t.substring(0,t.length-1));const i=t?t+"/"+e:e,n=new Blob([JSON.stringify({scroll:!1,parameters:[]},void 0,2)],{type:"application/json"});this.storageClient.uploadObject("_global","displays",this.data.prefix+i,n).then(()=>{this.dialogRef.close(i)})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.so),s.Y36(lt.qu),s.Y36(a.C),s.Y36(T.WI),s.Y36(s.sBO))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-create-display-dialog"]],viewQuery:function(t,e){if(1&t&&s.Gf(Te,5),2&t){let t;s.iGM(t=s.CRH())&&(e.filenameInput=t.first)}},decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],["class","ya-form",3,"formGroup",4,"ngIf"],["align","end"],["mat-dialog-close","",1,"ya-button"],["class","ya-button",3,"disabled","click",4,"ngIf"],["class","ya-button primary",3,"disabled","click",4,"ngIf"],[1,"ya-form",3,"formGroup"],["formControlName","type"],["value","par"],["type","text","formControlName","name"],["filename",""],["class","error-message",4,"ngIf"],["type","text","formControlName","path"],[1,"error-message"],[1,"ya-button",3,"disabled","click"],[1,"ya-button","primary",3,"disabled","click"]],template:function(t,e){1&t&&(s.TgZ(0,"h2",0),s._uU(1,"Create display"),s.qZA(),s.TgZ(2,"mat-dialog-content",1),s.YNc(3,Se,6,1,"form",2),s.YNc(4,Ce,10,4,"form",2),s.qZA(),s.TgZ(5,"mat-dialog-actions",3),s.TgZ(6,"button",4),s._uU(7,"CANCEL"),s.qZA(),s.YNc(8,Ne,2,1,"button",5),s.YNc(9,_e,2,1,"button",6),s.qZA()),2&t&&(s.xp6(3),s.Q6J("ngIf",1===e.page),s.xp6(1),s.Q6J("ngIf",2===e.page),s.xp6(4),s.Q6J("ngIf",1===e.page),s.xp6(1),s.Q6J("ngIf",2===e.page))},directives:[T.uh,T.xY,o.O5,T.H8,T.ZT,lt._Y,lt.JL,lt.sg,lt.EJ,lt.JJ,lt.u,lt.YN,lt.Kr,lt.Fj],encapsulation:2}),t})();var Ie=i(1576);let ke=(()=>{class t{constructor(t,e,i,n,a,s){this.dialogRef=t,this.data=s,this.storageClient=i.createStorageClient();const o=a.transform(this.data.name);this.filenameForm=e.group({name:[o,[lt.kI.required]]})}rename(){return t=this,void 0,i=function*(){let t;const e=this.data.name.lastIndexOf("/");-1!==e&&(t=this.data.name.substring(0,e+1));const i=yield this.storageClient.getObject("_global","displays",this.data.name),n=yield i.blob(),a=(t||"")+this.filenameForm.get("name").value;yield this.storageClient.uploadObject("_global","displays",a,n),yield this.storageClient.deleteObject("_global","displays",this.data.name),this.dialogRef.close(a)},new((e=void 0)||(e=Promise))(function(n,a){function s(t){try{r(i.next(t))}catch(e){a(e)}}function o(t){try{r(i.throw(t))}catch(e){a(e)}}function r(t){var i;t.done?n(t.value):(i=t.value,i instanceof e?i:new e(function(t){t(i)})).then(s,o)}r((i=i.apply(t,[])).next())});var t,e,i}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.so),s.Y36(lt.qu),s.Y36(a.C),s.Y36(b.E),s.Y36(Ie.X),s.Y36(T.WI))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-rename-display-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["filename",""],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(s.TgZ(0,"h2",0),s._uU(1,"Rename file"),s.qZA(),s.TgZ(2,"mat-dialog-content",1),s.TgZ(3,"form",2),s.TgZ(4,"label"),s._uU(5," Name "),s._UZ(6,"input",3,4),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"mat-dialog-actions",5),s.TgZ(9,"button",6),s._uU(10,"CANCEL"),s.qZA(),s.TgZ(11,"button",7),s.NdJ("click",function(){return e.rename()}),s._uU(12,"RENAME"),s.qZA(),s.qZA()),2&t){let t;s.xp6(3),s.Q6J("formGroup",e.filenameForm),s.xp6(1),s.ekj("invalid",null==(t=e.filenameForm.get("name"))?null:t.invalid),s.xp6(7),s.Q6J("disabled",!e.filenameForm.valid)}},directives:[T.uh,T.xY,lt._Y,lt.JL,lt.sg,lt.Fj,lt.JJ,lt.u,T.H8,T.ZT],encapsulation:2}),t})();var Qe=i(7408);const Je=["files"];function Ye(t,e){if(1&t&&(s.TgZ(0,"form",7),s.TgZ(1,"label"),s._uU(2," Files"),s._UZ(3,"br"),s._UZ(4,"input",8,9),s.qZA(),s._UZ(6,"br"),s.TgZ(7,"label"),s._uU(8," Path "),s._UZ(9,"input",10),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.Q6J("formGroup",t.formGroup)}}function Me(t,e){1&t&&s._UZ(0,"app-dots")}let Oe=(()=>{class t{constructor(t,e,i,n,a){this.dialogRef=t,this.messageService=e,this.data=a,this.uploading$=new v.X(!1),this.storageClient=n.createStorageClient(),this.formGroup=i.group({path:[a.path,lt.kI.required],files:[null,lt.kI.required]})}save(){let t=this.formGroup.get("path").value.trim();t.startsWith("/")&&(t=t.substring(1)),t.endsWith("/")&&(t=t.substring(0,t.length-1));const e=this.filesInput.nativeElement.files,i=[];this.uploading$.next(!0);for(const n in e)if(!isNaN(parseInt(n,10))){const a=e[n],s=this.storageClient.uploadObject("_global","displays",this.data.prefix+(t?t+"/"+a.name:a.name),a);i.push(s)}Promise.all(i).then(()=>{this.uploading$.next(!1),this.dialogRef.close(!0)}).catch(t=>{this.messageService.showError(t),this.uploading$.next(!1),this.dialogRef.close(!0)})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.so),s.Y36(g.e),s.Y36(lt.qu),s.Y36(a.C),s.Y36(T.WI))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-upload-files-dialog"]],viewQuery:function(t,e){if(1&t&&s.Gf(Je,5),2&t){let t;s.iGM(t=s.CRH())&&(e.filesInput=t.first)}},decls:14,vars:12,consts:[["mat-dialog-title",""],[1,"mat-typography"],["class","ya-form",3,"formGroup",4,"ngIf"],[4,"ngIf"],["align","end"],["mat-dialog-close","",1,"ya-button",3,"disabled"],[1,"ya-button","primary",3,"disabled","click"],[1,"ya-form",3,"formGroup"],["type","file","formControlName","files","multiple",""],["files",""],["type","text","formControlName","path"]],template:function(t,e){1&t&&(s.TgZ(0,"h2",0),s._uU(1,"Upload files"),s.qZA(),s.TgZ(2,"mat-dialog-content",1),s.YNc(3,Ye,10,1,"form",2),s.ALo(4,"async"),s.YNc(5,Me,1,0,"app-dots",3),s.ALo(6,"async"),s.qZA(),s.TgZ(7,"mat-dialog-actions",4),s.TgZ(8,"button",5),s.ALo(9,"async"),s._uU(10,"CANCEL"),s.qZA(),s.TgZ(11,"button",6),s.NdJ("click",function(){return e.save()}),s.ALo(12,"async"),s._uU(13,"UPLOAD"),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("ngIf",!s.lcZ(4,4,e.uploading$)),s.xp6(2),s.Q6J("ngIf",s.lcZ(6,6,e.uploading$)),s.xp6(3),s.Q6J("disabled",s.lcZ(9,8,e.uploading$)),s.xp6(3),s.Q6J("disabled",s.lcZ(12,10,e.uploading$)))},directives:[T.uh,T.xY,o.O5,T.H8,T.ZT,lt._Y,lt.JL,lt.sg,lt.Fj,lt.JJ,lt.u,Qe.b],pipes:[o.Ov],encapsulation:2}),t})();var De=i(2679),Pe=i(3061);const Le=["droparea"];function Re(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",9),s.NdJ("click",function(){return s.CHM(t),s.oxw().createDisplay()}),s.TgZ(1,"mat-icon"),s._uU(2,"add"),s.qZA(),s._uU(3," CREATE DISPLAY "),s.qZA()}}function $e(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",9),s.NdJ("click",function(){return s.CHM(t),s.oxw().uploadFiles()}),s.TgZ(1,"mat-icon"),s._uU(2,"cloud_upload"),s.qZA(),s._uU(3," UPLOAD FILES "),s.qZA()}}function Ee(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",10),s.NdJ("click",function(){return s.CHM(t),s.oxw().deleteSelectedDisplays()}),s.TgZ(1,"mat-icon"),s._uU(2,"delete"),s.qZA(),s._uU(3," DELETE "),s.qZA()}if(2&t){const t=s.oxw();s.Q6J("disabled",!t.selection.hasValue())}}const He=function(t){return{c:t}};function Ve(t,e){if(1&t&&s._UZ(0,"app-breadcrumb",13),2&t){const t=e.$implicit,i=s.oxw(3);s.Q6J("link",t.route)("queryParams",s.VKq(3,He,i.yamcs.context))("label",t.name)}}function Fe(t,e){if(1&t&&(s.TgZ(0,"app-breadcrumb-trail"),s._UZ(1,"app-breadcrumb",11),s.YNc(2,Ve,1,5,"app-breadcrumb",12),s.qZA()),2&t){const t=s.oxw().ngIf,e=s.oxw();s.xp6(1),s.Q6J("queryParams",s.VKq(2,He,e.yamcs.context)),s.xp6(1),s.Q6J("ngForOf",t)}}function Be(t,e){if(1&t&&(s.ynx(0),s.YNc(1,Fe,3,4,"app-breadcrumb-trail",6),s.BQk()),2&t){const t=e.ngIf;s.xp6(1),s.Q6J("ngIf",t.length)}}function je(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"input",32),s.NdJ("change",function(e){s.CHM(t);const i=s.oxw(3);return e?i.masterToggle():null}),s.qZA()}if(2&t){const t=s.oxw(3);s.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())}}function ze(t,e){if(1&t&&(s.TgZ(0,"th",30),s.YNc(1,je,1,1,"input",31),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",t.mayManageDisplays())}}function Ge(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"input",35),s.NdJ("click",function(t){return t.stopPropagation()})("change",function(e){s.CHM(t);const i=s.oxw().$implicit,n=s.oxw(2);return e?n.selection.toggle(i):null}),s.qZA()}if(2&t){const t=s.oxw().$implicit,e=s.oxw(2);s.Q6J("checked",e.selection.isSelected(t))}}function Xe(t,e){if(1&t&&(s.TgZ(0,"td",33),s.YNc(1,Ge,1,1,"input",34),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",t.mayManageDisplays())}}function We(t,e){1&t&&(s.TgZ(0,"th",36),s._uU(1,"Name"),s.qZA())}function Ke(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"mat-icon",38),s._uU(2,"folder"),s.qZA(),s.TgZ(3,"a",39),s.NdJ("click",function(t){return t.stopPropagation()}),s._uU(4),s.ALo(5,"filename"),s.qZA(),s.BQk()),2&t){const t=s.oxw().$implicit,e=s.oxw(2);s.xp6(3),s.Q6J("routerLink","/telemetry/displays/browse/"+t.nameWithoutInstance)("queryParams",s.VKq(5,He,e.yamcs.context)),s.xp6(1),s.hij(" ",s.lcZ(5,3,t.name)," ")}}function ti(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"mat-icon",38),s._uU(2,"description"),s.qZA(),s.TgZ(3,"a",39),s.NdJ("click",function(t){return t.stopPropagation()}),s._uU(4),s.ALo(5,"filename"),s.qZA(),s.BQk()),2&t){const t=s.oxw().$implicit,e=s.oxw(2);s.xp6(3),s.Q6J("routerLink","/telemetry/displays/files/"+t.nameWithoutInstance)("queryParams",s.VKq(5,He,e.yamcs.context)),s.xp6(1),s.hij(" ",s.lcZ(5,3,t.name)," ")}}function ei(t,e){if(1&t&&(s.TgZ(0,"td",37),s.YNc(1,Ke,6,7,"ng-container",6),s.YNc(2,ti,6,7,"ng-container",6),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",t.folder),s.xp6(1),s.Q6J("ngIf",!t.folder)}}function ii(t,e){1&t&&(s.TgZ(0,"th",40),s._uU(1,"Type"),s.qZA())}function ni(t,e){1&t&&(s.ynx(0),s._uU(1,"Folder"),s.BQk())}function ai(t,e){if(1&t&&(s.ynx(0),s._uU(1),s.ALo(2,"displayType"),s.BQk()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,t.name)||"-"," ")}}function si(t,e){if(1&t&&(s.TgZ(0,"td",37),s.YNc(1,ni,2,0,"ng-container",6),s.YNc(2,ai,3,3,"ng-container",6),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",t.folder),s.xp6(1),s.Q6J("ngIf",!t.folder)}}function oi(t,e){1&t&&(s.TgZ(0,"th",40),s._uU(1,"Visibility"),s.qZA())}function ri(t,e){1&t&&(s.TgZ(0,"td",37),s._uU(1," Private "),s.qZA())}function ci(t,e){1&t&&(s.TgZ(0,"th",40),s._uU(1,"Date modified"),s.qZA())}function li(t,e){if(1&t&&(s.TgZ(0,"td",37),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,t.modified)||"-"," ")}}function ui(t,e){1&t&&s._UZ(0,"th",41)}function pi(t,e){if(1&t&&(s.TgZ(0,"button",47),s.NdJ("click",function(t){return t.stopPropagation()}),s.TgZ(1,"mat-icon"),s._uU(2,"more_vert"),s.qZA(),s.qZA()),2&t){s.oxw();const t=s.MAs(2);s.Q6J("matMenuTriggerFor",t)}}function mi(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.TgZ(1,"mat-menu",42,43),s.TgZ(3,"button",44),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw(2).renameFile(e)}),s._uU(4," Rename "),s.qZA(),s.TgZ(5,"a",45),s._uU(6," Download "),s.qZA(),s._UZ(7,"mat-divider"),s.TgZ(8,"button",44),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw(2).deleteFile(e)}),s._uU(9," Delete "),s.qZA(),s.qZA(),s.YNc(10,pi,3,1,"button",46),s.BQk()}if(2&t){const t=s.oxw().$implicit,e=s.oxw(2);s.xp6(5),s.Q6J("href",t.objectUrl,s.LSH),s.xp6(5),s.Q6J("ngIf",e.mayManageDisplays())}}function hi(t,e){if(1&t&&(s.TgZ(0,"td",37),s.YNc(1,mi,11,2,"ng-container",6),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",!t.folder)}}function gi(t,e){1&t&&s._UZ(0,"tr",48)}function di(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr",49),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).toggleOne(e)}),s.qZA()}if(2&t){const t=e.$implicit,i=s.oxw(2);s.ekj("selected",i.selection.isSelected(t))}}function fi(t,e){if(1&t&&(s.TgZ(0,"table",14),s.ynx(1,15),s.YNc(2,ze,2,1,"th",16),s.YNc(3,Xe,2,1,"td",17),s.BQk(),s.ynx(4,18),s.YNc(5,We,2,0,"th",19),s.YNc(6,ei,3,2,"td",20),s.BQk(),s.ynx(7,21),s.YNc(8,ii,2,0,"th",22),s.YNc(9,si,3,2,"td",20),s.BQk(),s.ynx(10,23),s.YNc(11,oi,2,0,"th",22),s.YNc(12,ri,2,0,"td",20),s.BQk(),s.ynx(13,24),s.YNc(14,ci,2,0,"th",22),s.YNc(15,li,3,3,"td",20),s.BQk(),s.ynx(16,25),s.YNc(17,ui,1,0,"th",26),s.YNc(18,hi,2,1,"td",27),s.BQk(),s.YNc(19,gi,1,0,"tr",28),s.YNc(20,di,1,2,"tr",29),s.qZA()),2&t){const t=s.oxw();s.Q6J("dataSource",t.dataSource),s.xp6(19),s.Q6J("cdkHeaderRowDef",t.displayedColumns),s.xp6(1),s.Q6J("cdkRowDefColumns",t.displayedColumns)}}function Zi(t,e){1&t&&(s.TgZ(0,"app-empty-message"),s._uU(1,"Empty directory."),s.qZA())}let yi=(()=>{class t{constructor(t,e,i,n,a,s,o){this.dialog=t,this.yamcs=e,this.router=n,this.route=a,this.authService=s,this.breadcrumb$=new v.X([]),this.dragActive$=new v.X(!1),this.displayedColumns=["select","name","type","modified","actions"],this.dataSource=new S.by([]),this.selection=new x.Ov(!0,[]),i.setTitle("Displays"),this.storageClient=e.createStorageClient(),this.folderPerInstance=o.getConfig().displayFolderPerInstance,this.loadCurrentFolder(),this.routerSubscription=n.events.pipe((0,ue.h)(t=>t instanceof m.m2)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){const t={delimiter:"/"};let e="";this.folderPerInstance&&(e=this.yamcs.instance+"/");const i=this.route.snapshot.url;i.length?t.prefix=e+i.map(t=>t.path).join("/")+"/":e&&(t.prefix=e),this.storageClient.listObjects("_global","displays",t).then(t=>{this.updateBrowsePath(),this.changedir(t)})}getNameWithoutInstance(t){return this.folderPerInstance?t.substr(this.yamcs.instance.length):t}changedir(t){this.selection.clear();const e=[];for(const i of t.prefixes||[])e.push({folder:!0,name:i,nameWithoutInstance:this.getNameWithoutInstance(i)});for(const i of t.objects||[])e.push({folder:!1,name:i.name,nameWithoutInstance:this.getNameWithoutInstance(i.name),modified:i.created,objectUrl:this.storageClient.getObjectURL("_global","displays",i.name)});this.dataSource.data=e}isAllSelected(){const t=this.dataSource.data.length;return this.selection.selected.length===t&&t>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t))}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}createDisplay(){this.dialog.open(Ue,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(t=>{t&&this.router.navigateByUrl(`/telemetry/displays/files/${t}?c=${this.yamcs.context}`)})}uploadFiles(){this.dialog.open(Oe,{width:"400px",data:{path:this.getCurrentPath(),prefix:this.folderPerInstance?this.yamcs.instance+"/":""}}).afterClosed().subscribe(t=>{t&&this.loadCurrentFolder()})}getCurrentPath(){let t="";for(const e of this.route.snapshot.url)t+="/"+e.path;return t||"/"}deleteSelectedDisplays(){const t=[],e=[];for(const i of this.selection.selected)i.folder?e.push(this.storageClient.listObjects("_global","displays",{prefix:i.name}).then(e=>{t.push(...(e.objects||[]).map(t=>t.name))})):t.push(i.name);Promise.all(e).then(()=>{if(confirm(`You are about to delete ${t.length} files. Are you sure you want to continue?`)){const e=[];for(const i of t)e.push(this.storageClient.deleteObject("_global","displays",i));Promise.all(e).then(()=>{this.loadCurrentFolder()})}})}renameFile(t){this.dialog.open(ke,{data:{name:t.name},width:"400px"}).afterClosed().subscribe(t=>{t&&this.loadCurrentFolder()})}deleteFile(t){confirm(`Are you sure you want to delete ${t.nameWithoutInstance}?`)&&this.storageClient.deleteObject("_global","displays",t.name).then(()=>{this.loadCurrentFolder()})}dragEnter(t){return this.dragActive$.next(!0),t.preventDefault(),t.stopPropagation(),!1}dragOver(t){return t.preventDefault(),t.stopPropagation(),!1}dragLeave(t){return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}drop(t){const e=t.dataTransfer||{};if(e){let t=this.getCurrentPath().substring(1);""!==t&&(t+="/"),Ae.v(e).then(e=>{const i=[];for(const n of e){let e=t+n._fullPath;this.folderPerInstance&&(e=this.yamcs.instance+"/"+e);const a=this.storageClient.uploadObject("_global","displays",e,n);i.push(a)}Promise.all(i).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}mayManageDisplays(){const t=this.authService.getUser();return t.hasObjectPrivilege("ManageBucket","displays")||t.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){const t=[];let e="";for(const i of this.route.snapshot.url)e+="/"+i.path,t.push({name:i.path,route:"/telemetry/displays/browse"+e});return this.breadcrumb$.next(t),e||"/"}ngOnDestroy(){this.routerSubscription&&this.routerSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.uw),s.Y36(a.C),s.Y36(pe.Dx),s.Y36(m.F0),s.Y36(m.gz),s.Y36(Ot.e),s.Y36(b.E))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&s.Gf(Le,7),2&t){let t;s.iGM(t=s.CRH())&&(e.dropArea=t.first)}},decls:17,vars:16,consts:[["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],[1,"droparea",3,"dragenter"],["droparea",""],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],[4,"ngIf"],["mat-table","","class","ya-data-table","style","width: 100%",3,"dataSource",4,"ngIf","ngIfElse"],["empty",""],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"disabled","click"],["link","/telemetry/displays/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table",2,"width","100%",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","","style","width: 400px",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","type"],["mat-header-cell","","style","width: 200px",4,"cdkHeaderCellDef"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked","change",4,"ngIf"],["type","checkbox",3,"checked","change"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"checked","click","change",4,"ngIf"],["type","checkbox",3,"checked","click","change"],["mat-header-cell","",2,"width","400px"],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"routerLink","queryParams","click"],["mat-header-cell","",2,"width","200px"],["mat-header-cell",""],["overlapTrigger","false",1,"ya-menu"],["fileMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-button","","class","icon",3,"matMenuTriggerFor","click",4,"ngIf"],["mat-button","",1,"icon",3,"matMenuTriggerFor","click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(t,e){if(1&t&&(s.TgZ(0,"app-instance-page"),s.TgZ(1,"app-instance-toolbar"),s._uU(2," Displays \xa0\xa0\xa0 "),s.YNc(3,Re,4,0,"button",0),s.YNc(4,$e,4,0,"button",0),s.YNc(5,Ee,4,1,"button",1),s.qZA(),s.TgZ(6,"div",2,3),s.NdJ("dragenter",function(t){return e.dragEnter(t)}),s.ALo(8,"async"),s.TgZ(9,"div",4),s.NdJ("dragover",function(t){return e.dragOver(t)})("dragleave",function(t){return e.dragLeave(t)})("drop",function(t){return e.drop(t)}),s.ALo(10,"async"),s.qZA(),s.TgZ(11,"div",5),s.YNc(12,Be,2,1,"ng-container",6),s.ALo(13,"async"),s.YNc(14,fi,21,3,"table",7),s.YNc(15,Zi,2,0,"ng-template",null,8,s.W1O),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.MAs(16);s.xp6(3),s.Q6J("ngIf",e.mayManageDisplays()),s.xp6(1),s.Q6J("ngIf",e.mayManageDisplays()),s.xp6(1),s.Q6J("ngIf",e.mayManageDisplays()),s.xp6(1),s.ekj("active",s.lcZ(8,10,e.dragActive$)),s.xp6(3),s.ekj("hide",!s.lcZ(10,12,e.dragActive$)),s.xp6(3),s.Q6J("ngIf",s.lcZ(13,14,e.breadcrumb$)),s.xp6(2),s.Q6J("ngIf",e.dataSource&&e.dataSource.data.length)("ngIfElse",t)}},directives:[me.a,he.k,o.O5,_.lW,U.Hw,De.w,Pe.a,o.sg,S.BZ,q.fo,q.D5,q.O_,S.w1,S.fO,S.Dz,q.s$,q.Sq,S.ge,S.ev,m.yS,ut.VK,ut.OP,pt.d,ut.p6,S.XQ,S.Gk,Ut.M],pipes:[o.Ov,Ie.X,se,k.i],styles:[".droparea[_ngcontent-%COMP%]{overflow:auto}.droparea[_ngcontent-%COMP%], .droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.droparea-overlay[_ngcontent-%COMP%]{box-sizing:border-box;background:rgba(27,97,185,.1);border:1px solid #1b61b9;z-index:10}"],changeDetection:0}),t})(),xi=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&s._UZ(0,"router-outlet")},directives:[m.lC],encapsulation:2,changeDetection:0}),t})(),vi=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&s._UZ(0,"router-outlet")},directives:[m.lC],encapsulation:2,changeDetection:0}),t})();var bi=i(6801);class wi{constructor(){this.dirty=!1,this.archivePackets=[]}addArchiveData(t){this.archivePackets=this.archivePackets.concat(t),this.dirty=!0}reset(){this.archivePackets=[],this.dirty=!0}snapshot(){return this.archivePackets}}class Ai extends x.o2{constructor(t,e){super(),this.yamcs=t,this.pageSize=100,this.blockHasMore=!1,this.packets$=new v.X([]),this.loading$=new v.X(!1),this.syncSubscription=e.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.packets$.next(this.buffer.snapshot()),this.buffer.dirty=!1)}),this.buffer=new wi}connect(){return this.packets$}loadEntries(t,e){return this.loading$.next(!0),this.loadPage(Object.assign(Object.assign({},e),{limit:this.pageSize})).then(t=>{this.loading$.next(!1),this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(t)})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(t){return this.yamcs.yamcsClient.getPackets(this.yamcs.instance,t).then(t=>(this.continuationToken=t.continuationToken,t.packet||[]))}loadMoreData(t){this.continuationToken&&this.loadPage(Object.assign(Object.assign({},t),{next:this.continuationToken,limit:this.pageSize})).then(t=>{this.buffer.addArchiveData(t)})}disconnect(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.packets$.complete(),this.loading$.complete()}isEmpty(){return!this.packets$.getValue().length}}var Ti=i(5725),Si=i(2656),qi=i(221),Ci=i(808),Ni=i(7112),_i=i(864),Ui=i(4930),Ii=i(8888),ki=i(3116),Qi=i(3113),Ji=i(1329);const Yi=["intervalSelect"];function Mi(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"app-detail-toolbar"),s._uU(2," Packet Detail "),s.qZA(),s.TgZ(3,"div",31),s.TgZ(4,"div",32),s._uU(5,"Generation time"),s.qZA(),s.TgZ(6,"div",33),s._uU(7),s.ALo(8,"datetime"),s.qZA(),s.TgZ(9,"div",32),s._uU(10,"Reception time"),s.qZA(),s.TgZ(11,"div",33),s._uU(12),s.ALo(13,"datetime"),s.ALo(14,"deltaWith"),s.qZA(),s.TgZ(15,"div",32),s._uU(16,"Size"),s.qZA(),s.TgZ(17,"div",33),s._uU(18),s.ALo(19,"formatBytes"),s.ALo(20,"binarySize"),s.qZA(),s.TgZ(21,"div",32),s._uU(22,"Data"),s.qZA(),s.TgZ(23,"div",33),s._UZ(24,"app-hex",34),s.qZA(),s.qZA(),s.BQk()),2&t){const t=e.ngIf;s.xp6(7),s.hij(" ",s.lcZ(8,5,t.generationTime)," "),s.xp6(5),s.AsE(" ",s.lcZ(13,7,t.receptionTime)," (",s.xi3(14,9,t.receptionTime,t.generationTime),") "),s.xp6(6),s.hij(" ",s.lcZ(19,12,s.lcZ(20,14,t.packet))," "),s.xp6(6),s.Q6J("base64String",t.packet)}}function Oi(t,e){1&t&&(s.TgZ(0,"app-detail-toolbar"),s._uU(1," Select a packet "),s.qZA())}function Di(t,e){if(1&t){const t=s.EpF();s.ynx(0),s._UZ(1,"app-date-time-input",35),s._UZ(2,"app-date-time-input",36),s.TgZ(3,"button",30),s.NdJ("click",function(){return s.CHM(t),s.oxw().applyCustomDates()}),s._uU(4,"Apply"),s.qZA(),s.BQk()}if(2&t){const t=s.oxw();s.xp6(3),s.Q6J("disabled",t.filterForm.invalid)}}function Pi(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.TgZ(1,"button",37),s.NdJ("click",function(){return s.CHM(t),s.oxw().jumpToNow()}),s._uU(2," Jump to now "),s.qZA(),s.BQk()}}function Li(t,e){1&t&&s._UZ(0,"app-dots")}function Ri(t,e){1&t&&(s.TgZ(0,"th",38),s._uU(1,"Packet Name"),s.qZA())}function $i(t,e){if(1&t&&(s.TgZ(0,"td",39),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",t.id.name," ")}}function Ei(t,e){1&t&&(s.TgZ(0,"th",38),s._uU(1,"Generation Time"),s.qZA())}function Hi(t,e){if(1&t&&(s.TgZ(0,"td",39),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,t.generationTime)," ")}}function Vi(t,e){1&t&&(s.TgZ(0,"th",38),s._uU(1,"Reception Time"),s.qZA())}function Fi(t,e){if(1&t&&(s.TgZ(0,"td",39),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,t.receptionTime)," ")}}function Bi(t,e){1&t&&(s.TgZ(0,"th",38),s._uU(1,"Size"),s.qZA())}function ji(t,e){if(1&t&&(s.TgZ(0,"td",39),s._uU(1),s.ALo(2,"formatBytes"),s.ALo(3,"binarySize"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,s.lcZ(3,3,t.packet))," ")}}function zi(t,e){1&t&&(s.TgZ(0,"th",38),s._uU(1,"Data"),s.qZA())}function Gi(t,e){if(1&t&&(s.TgZ(0,"td",40),s._uU(1),s.ALo(2,"hex"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,t.packet)," ")}}function Xi(t,e){1&t&&s._UZ(0,"th",38)}function Wi(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",41),s.TgZ(1,"mat-menu",42,43),s.TgZ(3,"button",44),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().copyHex(e)}),s._uU(4," Copy Hex "),s.qZA(),s.TgZ(5,"button",44),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().copyBinary(e)}),s._uU(6," Copy Binary "),s.qZA(),s._UZ(7,"mat-divider"),s.TgZ(8,"app-download-menu-item",3),s.ALo(9,"packetDownloadLink"),s._uU(10," Download "),s.qZA(),s.qZA(),s.TgZ(11,"button",45),s.NdJ("click",function(t){return t.stopPropagation()}),s.TgZ(12,"mat-icon"),s._uU(13,"more_vert"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,i=s.MAs(2);s.xp6(8),s.Q6J("link",s.lcZ(9,2,t)),s.xp6(3),s.Q6J("matMenuTriggerFor",i)}}function Ki(t,e){1&t&&s._UZ(0,"tr",46)}function tn(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"tr",47),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().selectPacket(e)}),s.ALo(1,"async"),s.qZA()}if(2&t){const t=e.$implicit,i=s.oxw();s.ekj("selected",s.lcZ(1,3,i.detailPacket$)===t),s.Q6J("@rowAnimation",t.animate)}}const en="PT1H";let nn=(()=>{class t{constructor(t,e,i,n,a,s){this.yamcs=t,this.router=e,this.route=i,this.clipboard=s,this.displayedColumns=["packetName","generationTime","receptionTime","data","size","actions"],this.filterForm=new lt.cw({name:new lt.NI("ANY"),interval:new lt.NI(en),customStart:new lt.NI(null),customStop:new lt.NI(null)}),this.detailPacket$=new v.X(null),this.nameOptions$=new v.X([{id:"ANY",label:"Any name"}]),this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}],this.downloadURL$=new v.X(null),n.setTitle("Packets"),this.dataSource=new Ai(this.yamcs,a),t.yamcsClient.getPacketNames(t.instance).then(t=>{for(const e of t)this.nameOptions$.next([...this.nameOptions$.value,{id:e,label:e}])}),this.initializeOptions(),this.loadData(),this.filterForm.get("name").valueChanges.forEach(t=>{this.name="ANY"!==t?t:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(e=>{if("CUSTOM"===e){const t=this.validStart||this.yamcs.getMissionTime(),e=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(u.Y6(t)),this.filterForm.get("customStop").setValue(u.Y6(e))}else"NO_LIMIT"===e?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=t.getMissionTime(),this.validStart=(0,u.rV)(this.validStop,e),this.appliedInterval=e,this.loadData())})}initializeOptions(){const t=this.route.snapshot.queryParamMap;if(t.has("name")&&(this.name=t.get("name")||"",this.filterForm.get("name").setValue(this.name)),t.has("interval"))if(this.appliedInterval=t.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),"CUSTOM"===this.appliedInterval){const e=t.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);const i=t.get("customStop");this.filterForm.get("customStop").setValue(i),this.validStop=new Date(i)}else"NO_LIMIT"===this.appliedInterval?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,u.rV)(this.validStop,this.appliedInterval));else this.appliedInterval=en,this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,u.rV)(this.validStop,en)}jumpToNow(){const t=this.filterForm.value.interval;"NO_LIMIT"===t||"CUSTOM"===t?this.filterForm.get("interval").setValue(en):(this.validStop=this.yamcs.getMissionTime(),this.validStart=(0,u.rV)(this.validStop,t),this.loadData())}applyCustomDates(){this.validStart=u.ZU(this.filterForm.value.customStart),this.validStop=u.ZU(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();const t={};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.name&&(t.name=this.name);const e={};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.name&&(e.name=this.name),this.dataSource.loadEntries("realtime",t).then(t=>{const i=this.yamcs.yamcsClient.getPacketsDownloadURL(this.yamcs.instance,e);this.downloadURL$.next(i)})}loadMoreData(){const t={};this.validStart&&(t.start=this.validStart.toISOString()),this.name&&(t.name=this.name),this.dataSource.loadMoreData(t)}copyHex(t){const e=u.TR(t.packet);this.clipboard.copy(e)}copyBinary(t){const e=atob(t.packet);this.clipboard.copy(e)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{name:this.name||null,interval:this.appliedInterval,customStart:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStart:null,customStop:"CUSTOM"===this.appliedInterval?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}selectPacket(t){this.detailPacket$.next(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(m.F0),s.Y36(m.gz),s.Y36(pe.Dx),s.Y36(h.j),s.Y36(Ti.TU))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&s.Gf(Yi,5),2&t){let t;s.iGM(t=s.CRH())&&(e.intervalSelect=t.first)}},decls:59,vars:26,consts:[[3,"hasDetailPane"],[1,"ya-menu"],["exportMenu","matMenu"],[3,"link"],["mat-button","","color","primary",3,"matMenuTriggerFor","disabled"],["mat-icon-button","","matTooltip","Jump to now","color","primary",3,"click"],[4,"ngIf","ngIfElse"],["noSelection",""],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","name",3,"options"],["icon","access_time","formControlName","interval",3,"options"],["intervalSelect",""],[4,"ngIf"],["mat-table","",1,"ya-data-table",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","receptionTime"],["matColumnDef","size"],["matColumnDef","data"],["mat-cell","","class","mono",4,"matCellDef"],["matColumnDef","actions"],["mat-cell","","style","text-align: right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1 1 auto"],[1,"ya-button",3,"disabled","click"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],[3,"base64String"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"mono"],["mat-cell","",2,"text-align","right"],["overlapTrigger","false",1,"ya-menu"],["packetMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-button","",1,"icon",3,"matMenuTriggerFor","click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(t,e){if(1&t&&(s.TgZ(0,"app-instance-page"),s.TgZ(1,"app-instance-toolbar",0),s._uU(2," Packets \xa0\xa0\xa0 "),s.TgZ(3,"mat-menu",1,2),s.TgZ(5,"app-download-menu-item",3),s.ALo(6,"async"),s._uU(7," Raw dump "),s.qZA(),s.qZA(),s.TgZ(8,"button",4),s.ALo(9,"async"),s.TgZ(10,"mat-icon"),s._uU(11,"save_alt"),s.qZA(),s._uU(12," EXPORT "),s.qZA(),s.TgZ(13,"button",5),s.NdJ("click",function(){return e.jumpToNow()}),s.TgZ(14,"mat-icon"),s._uU(15,"refresh"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(16,"app-detail-pane"),s.YNc(17,Mi,25,16,"ng-container",6),s.ALo(18,"async"),s.YNc(19,Oi,2,0,"ng-template",null,7,s.W1O),s.qZA(),s.TgZ(21,"div",8),s.TgZ(22,"div",9),s.TgZ(23,"form",10),s.TgZ(24,"div",11),s._UZ(25,"app-select",12),s.ALo(26,"async"),s._UZ(27,"app-select",13,14),s.YNc(29,Di,5,1,"ng-container",15),s.YNc(30,Pi,3,0,"ng-container",15),s.YNc(31,Li,1,0,"app-dots",15),s.ALo(32,"async"),s.qZA(),s.qZA(),s.TgZ(33,"table",16),s.ynx(34,17),s.YNc(35,Ri,2,0,"th",18),s.YNc(36,$i,2,1,"td",19),s.BQk(),s.ynx(37,20),s.YNc(38,Ei,2,0,"th",18),s.YNc(39,Hi,3,3,"td",19),s.BQk(),s.ynx(40,21),s.YNc(41,Vi,2,0,"th",18),s.YNc(42,Fi,3,3,"td",19),s.BQk(),s.ynx(43,22),s.YNc(44,Bi,2,0,"th",18),s.YNc(45,ji,4,5,"td",19),s.BQk(),s.ynx(46,23),s.YNc(47,zi,2,0,"th",18),s.YNc(48,Gi,3,3,"td",24),s.BQk(),s.ynx(49,25),s.YNc(50,Xi,1,0,"th",18),s.YNc(51,Wi,14,4,"td",26),s.BQk(),s.YNc(52,Ki,1,0,"tr",27),s.YNc(53,tn,2,5,"tr",28),s.qZA(),s.TgZ(54,"mat-toolbar"),s._UZ(55,"span",29),s.TgZ(56,"button",30),s.NdJ("click",function(){return e.loadMoreData()}),s._uU(57,"Load More"),s.qZA(),s._UZ(58,"span",29),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.MAs(4),i=s.MAs(20);let n;s.xp6(1),s.Q6J("hasDetailPane",!0),s.xp6(4),s.Q6J("link",s.lcZ(6,16,e.downloadURL$)),s.xp6(3),s.Q6J("matMenuTriggerFor",t)("disabled",!(null!=(n=s.lcZ(9,18,e.dataSource.packets$))&&n.length)),s.xp6(9),s.Q6J("ngIf",s.lcZ(18,20,e.detailPacket$))("ngIfElse",i),s.xp6(6),s.Q6J("formGroup",e.filterForm),s.xp6(2),s.Q6J("options",s.lcZ(26,22,e.nameOptions$)),s.xp6(2),s.Q6J("options",e.intervalOptions),s.xp6(2),s.Q6J("ngIf","CUSTOM"===e.filterForm.value.interval),s.xp6(1),s.Q6J("ngIf","CUSTOM"!==e.filterForm.value.interval),s.xp6(1),s.Q6J("ngIf",s.lcZ(32,24,e.dataSource.loading$)),s.xp6(2),s.Q6J("dataSource",e.dataSource),s.xp6(19),s.Q6J("matHeaderRowDef",e.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",e.displayedColumns),s.xp6(3),s.Q6J("disabled",!e.dataSource.hasMore())}},directives:[me.a,he.k,ut.VK,Si.t,_.lW,ut.p6,U.Hw,$t.gM,qi.Z,o.O5,lt._Y,lt.JL,lt.sg,Ci.P,lt.JJ,lt.u,S.BZ,S.w1,S.fO,S.Dz,S.as,S.nj,Ni.Ye,_i.j,Ui.p,Dt.Y,Qe.b,S.ge,S.ev,ut.OP,pt.d,S.XQ,S.Gk],pipes:[o.Ov,k.i,Ii.m,ki.b,Qi.n,Ji.l,oe],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;width:450px;border-left:1px solid #d3d3d3;box-sizing:border-box}.detail[_ngcontent-%COMP%], .table-wrapper[_ngcontent-%COMP%]{height:100%;overflow:auto}.table-wrapper[_ngcontent-%COMP%]{position:relative}mat-row[_ngcontent-%COMP%]{cursor:pointer}"],data:{animation:[bi.q]},changeDetection:0}),t})();class an extends x.o2{constructor(t,e){super(),this.yamcs=t,this.qualifiedName=e,this.pageSize=100,this.alarms$=new v.X([]),this.loading$=new v.X(!1)}connect(t){return this.alarms$}isEmpty(){return 0===this.alarms$.value.length}loadAlarms(t){return this.loading$.next(!0),this.loadPage(Object.assign(Object.assign({},t),{limit:this.pageSize+1})).then(t=>{this.loading$.next(!1),this.alarms$.next(t)})}hasMore(){return null!=this.offscreenRecord}loadPage(t){return this.yamcs.yamcsClient.getAlarmsForParameter(this.yamcs.instance,this.qualifiedName,t).then(t=>(this.offscreenRecord=t.length>this.pageSize?t.splice(t.length-1,1)[0]:null,t))}loadMoreData(t){this.offscreenRecord&&this.loadPage(Object.assign(Object.assign({},t),{stop:this.offscreenRecord.triggerTime,limit:this.pageSize+1})).then(t=>{const e=this.alarms$.getValue().concat(t);this.alarms$.next(e)})}disconnect(t){this.alarms$.complete(),this.loading$.complete()}}function sn(t,e){1&t&&(s.TgZ(0,"th",11),s._uU(1,"Severity"),s.qZA())}function on(t,e){if(1&t&&(s.TgZ(0,"td",12),s._UZ(1,"app-alarm-level",13),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("level",t.severity)}}function rn(t,e){1&t&&(s.TgZ(0,"th",14),s._uU(1,"Time"),s.qZA())}function cn(t,e){if(1&t&&(s.TgZ(0,"td",12),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,t.triggerTime)||"-")}}function ln(t,e){1&t&&(s.TgZ(0,"th",14),s._uU(1,"Trip value"),s.qZA())}function un(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"\u2193"),s.qZA())}function pn(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"\u2191"),s.qZA())}function mn(t,e){if(1&t&&(s.ynx(0),s._uU(1),s.ALo(2,"value"),s.YNc(3,un,2,0,"span",15),s.YNc(4,pn,2,0,"span",15),s.BQk()),2&t){const t=e.ngIf;s.xp6(1),s.hij(" ",s.lcZ(2,3,t.triggerValue.engValue)," "),s.xp6(2),s.Q6J("ngIf","LOW"===t.triggerValue.rangeCondition),s.xp6(1),s.Q6J("ngIf","HIGH"===t.triggerValue.rangeCondition)}}function hn(t,e){if(1&t&&(s.TgZ(0,"td",12),s.YNc(1,mn,5,5,"ng-container",15),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",t.parameterDetail)}}function gn(t,e){1&t&&(s.TgZ(0,"th",14),s._uU(1,"Duration"),s.qZA())}function dn(t,e){if(1&t&&(s.TgZ(0,"mat-icon",17),s._uU(1,"comment"),s.qZA()),2&t){const t=s.oxw(3).$implicit;s.Q6J("matTooltip",null==t.clearInfo?null:t.clearInfo.clearMessage)}}function fn(t,e){if(1&t&&(s.ynx(0),s._uU(1),s.YNc(2,dn,2,1,"mat-icon",16),s.BQk()),2&t){const t=s.oxw(2).$implicit;s.xp6(1),s.hij(" (cleared by ",null==t.clearInfo?null:t.clearInfo.clearedBy,") "),s.xp6(1),s.Q6J("ngIf",null==t.clearInfo?null:t.clearInfo.clearMessage)}}function Zn(t,e){if(1&t&&(s.ynx(0),s._uU(1),s.YNc(2,fn,3,2,"ng-container",15),s.BQk()),2&t){const t=s.oxw().$implicit,e=s.oxw(2);s.xp6(1),s.hij(" ",e.printDuration(t)||"-"," "),s.xp6(1),s.Q6J("ngIf",null==t.clearInfo?null:t.clearInfo.clearedBy)}}function yn(t,e){1&t&&(s.ynx(0),s._uU(1,"-"),s.BQk())}function xn(t,e){if(1&t&&(s.TgZ(0,"td",12),s.YNc(1,Zn,3,2,"ng-container",15),s.YNc(2,yn,2,0,"ng-container",15),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",null==t.clearInfo?null:t.clearInfo.clearTime),s.xp6(1),s.Q6J("ngIf",!(null!=t.clearInfo&&t.clearInfo.clearTime))}}function vn(t,e){1&t&&s._UZ(0,"tr",18)}function bn(t,e){1&t&&s._UZ(0,"tr",19)}function wn(t,e){if(1&t&&(s.TgZ(0,"table",1),s.ynx(1,2),s.YNc(2,sn,2,0,"th",3),s.YNc(3,on,2,1,"td",4),s.BQk(),s.ynx(4,5),s.YNc(5,rn,2,0,"th",6),s.YNc(6,cn,3,3,"td",4),s.BQk(),s.ynx(7,7),s.YNc(8,ln,2,0,"th",6),s.YNc(9,hn,2,1,"td",4),s.BQk(),s.ynx(10,8),s.YNc(11,gn,2,0,"th",6),s.YNc(12,xn,3,2,"td",4),s.BQk(),s.YNc(13,vn,1,0,"tr",9),s.YNc(14,bn,1,0,"tr",10),s.qZA()),2&t){const t=s.oxw();s.Q6J("dataSource",t.dataSource),s.xp6(13),s.Q6J("matHeaderRowDef",t.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns)}}let An=(()=>{class t{constructor(){this.displayedColumns=["severity","triggerTime","triggerValue","duration"]}printDuration(t){if(t.clearInfo){const e=u.ZU(t.triggerTime).getTime(),i=u.ZU(t.clearInfo.clearTime).getTime(),n=Math.floor((i-e)/1e3);let a=Math.floor(n/31536e3);return a>1?a+" years":(a=Math.floor(n/2592e3),a>1?a+" months":(a=Math.floor(n/86400),a>1?a+" days":(a=Math.floor(n/3600),a>1?a+" hours":(a=Math.floor(n/60),a>1?a+" minutes":(a=Math.floor(n),a>60?"about a minute":"less than a minute")))))}return null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-parameter-alarms-table"]],inputs:{dataSource:"dataSource"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table",3,"dataSource",4,"ngIf"],["mat-table","",1,"ya-data-table",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","","style","width: 80px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","triggerTime"],["mat-header-cell","","style","width: 200px",4,"matHeaderCellDef"],["matColumnDef","triggerValue"],["matColumnDef","duration"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"width","80px"],["mat-cell",""],[3,"level"],["mat-header-cell","",2,"width","200px"],[4,"ngIf"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&s.YNc(0,wn,15,3,"table",0),2&t&&s.Q6J("ngIf",e.dataSource)},directives:[o.O5,S.BZ,S.w1,S.fO,S.Dz,S.as,S.nj,S.ge,S.ev,C.i,U.Hw,$t.gM,S.XQ,S.Gk],pipes:[k.i,I.V],encapsulation:2,changeDetection:0}),t})();function Tn(t,e){if(1&t){const t=s.EpF();s.ynx(0),s._UZ(1,"app-date-time-input",9),s._UZ(2,"app-date-time-input",10),s.TgZ(3,"button",11),s.NdJ("click",function(){return s.CHM(t),s.oxw().applyCustomDates()}),s._uU(4,"Apply"),s.qZA(),s.BQk()}if(2&t){const t=s.oxw();s.xp6(3),s.Q6J("disabled",t.filter.invalid)}}function Sn(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.TgZ(1,"button",12),s.NdJ("click",function(){return s.CHM(t),s.oxw().jumpToNow()}),s._uU(2," Jump to now "),s.qZA(),s.BQk()}}function qn(t,e){1&t&&s._UZ(0,"app-dots")}function Cn(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3,"the last month"),s.qZA(),s._uU(4," ending at "),s.TgZ(5,"b"),s._uU(6),s.ALo(7,"datetime"),s.qZA(),s._uU(8," (Mission Time) "),s.qZA()),2&t){const t=s.oxw();s.xp6(6),s.Oqu(s.lcZ(7,1,t.validStop))}}function Nn(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3,"the last year"),s.qZA(),s._uU(4," ending at "),s.TgZ(5,"b"),s._uU(6),s.ALo(7,"datetime"),s.qZA(),s._uU(8," (Mission Time) "),s.qZA()),2&t){const t=s.oxw();s.xp6(6),s.Oqu(s.lcZ(7,1,t.validStop))}}function _n(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3,"all time"),s.qZA(),s.qZA())}function Un(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3),s.ALo(4,"datetime"),s.qZA(),s._uU(5," to "),s.TgZ(6,"b"),s._uU(7),s.ALo(8,"datetime"),s.qZA(),s._uU(9," (Mission Time) "),s.qZA()),2&t){const t=s.oxw();s.xp6(3),s.Oqu(s.lcZ(4,2,t.validStart)),s.xp6(4),s.Oqu(s.lcZ(8,4,t.validStop))}}function In(t,e){1&t&&(s.TgZ(0,"small"),s._uU(1,"No records found matching current filter in the selected time range."),s.qZA())}function kn(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",13),s.YNc(1,In,2,0,"small",4),s.TgZ(2,"button",11),s.NdJ("click",function(){return s.CHM(t),s.oxw().loadMoreData()}),s._uU(3,"Load More"),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",t.dataSource.isEmpty()),s.xp6(1),s.Q6J("disabled",!t.dataSource.hasMore())}}const Qn="P1M";let Jn=(()=>{class t{constructor(t,e){this.yamcs=e,this.intervalOptions=[{id:"P1M",label:"Last Month"},{id:"P1Y",label:"Last Year"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filter=new lt.cw({interval:new lt.NI(Qn),customStart:new lt.NI(null),customStop:new lt.NI(null)}),this.qualifiedName=t.parent.snapshot.paramMap.get("qualifiedName"),this.dataSource=new an(e,this.qualifiedName),this.validStop=e.getMissionTime(),this.validStart=u.rV(this.validStop,Qn),this.appliedInterval=Qn,this.loadData(),this.filter.get("interval").valueChanges.forEach(t=>{if("CUSTOM"===t){const t=this.validStart||this.yamcs.getMissionTime(),e=this.validStop||this.yamcs.getMissionTime();this.filter.get("customStart").setValue(u.Y6(t)),this.filter.get("customStop").setValue(u.Y6(e))}else"NO_LIMIT"===t?(this.validStart=null,this.validStop=null,this.appliedInterval=t,this.loadData()):(this.validStop=e.getMissionTime(),this.validStart=u.rV(this.validStop,t),this.appliedInterval=t,this.loadData())})}jumpToNow(){const t=this.filter.value.interval;"NO_LIMIT"===t?this.filter.get("interval").setValue(Qn):(this.validStop=this.yamcs.getMissionTime(),this.validStart=u.rV(this.validStop,t),this.loadData())}applyCustomDates(){this.validStart=u.ZU(this.filter.value.customStart),this.validStop=u.ZU(this.filter.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){const t={detail:!0};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString()),this.dataSource.loadAlarms(t)}loadMoreData(){const t={detail:!0};this.validStart&&(t.start=this.validStart.toISOString()),this.dataSource.loadMoreData(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(m.gz),s.Y36(a.C))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],decls:16,vars:16,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","interval","icon","access_time",3,"options"],[4,"ngIf"],[1,"table-status",3,"ngSwitch"],[4,"ngSwitchCase"],[3,"dataSource"],["class","table-footer",4,"ngIf"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],[1,"table-footer"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"form",1),s.TgZ(2,"div",2),s._UZ(3,"app-select",3),s.YNc(4,Tn,5,1,"ng-container",4),s.YNc(5,Sn,3,0,"ng-container",4),s.YNc(6,qn,1,0,"app-dots",4),s.ALo(7,"async"),s.qZA(),s.qZA(),s.TgZ(8,"div",5),s.YNc(9,Cn,9,3,"span",6),s.YNc(10,Nn,9,3,"span",6),s.YNc(11,_n,4,0,"span",6),s.YNc(12,Un,10,6,"span",6),s.qZA(),s._UZ(13,"app-parameter-alarms-table",7),s.YNc(14,kn,4,2,"div",8),s.ALo(15,"async"),s.qZA()),2&t&&(s.xp6(1),s.Q6J("formGroup",e.filter),s.xp6(2),s.Q6J("options",e.intervalOptions),s.xp6(1),s.Q6J("ngIf","CUSTOM"===e.filter.value.interval),s.xp6(1),s.Q6J("ngIf","CUSTOM"!==e.filter.value.interval),s.xp6(1),s.Q6J("ngIf",s.lcZ(7,12,e.dataSource.loading$)),s.xp6(2),s.Q6J("ngSwitch",e.appliedInterval),s.xp6(1),s.Q6J("ngSwitchCase","P1M"),s.xp6(1),s.Q6J("ngSwitchCase","P1Y"),s.xp6(1),s.Q6J("ngSwitchCase","NO_LIMIT"),s.xp6(1),s.Q6J("ngSwitchCase","CUSTOM"),s.xp6(1),s.Q6J("dataSource",e.dataSource),s.xp6(1),s.Q6J("ngIf",!s.lcZ(15,14,e.dataSource.loading$)))},directives:[lt._Y,lt.JL,lt.sg,Ci.P,lt.JJ,lt.u,o.O5,o.RF,o.n9,An,Dt.Y,Qe.b],pipes:[o.Ov,k.i],styles:[".table-status[_ngcontent-%COMP%]{font-size:12px;padding-left:6px;margin-bottom:12px}.table-footer[_ngcontent-%COMP%], .table-status[_ngcontent-%COMP%]{background-color:#f2f2f2;height:24px;line-height:24px}.table-footer[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),t})();class Yn{constructor(t){this.watermarkObserver=t,this.dirty=!1,this.valueRange=[null,null],this.archiveSamples=[],this.bufferSize=500,this.bufferWatermark=400,this.pointer=0,this.alreadyWarned=!1,this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}setArchiveData(t){this.archiveSamples=t,this.dirty=!0}setValueRange(t){this.valueRange=t}addRealtimeValue(t){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=t,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.watermarkObserver(),this.alreadyWarned=!0),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveSamples=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.valueRange=[null,null],this.dirty=!0}snapshot(){const t=this.realtimeBuffer.filter(t=>void 0!==t);let e=null;t.length>0&&(e=t[0][0].getTime());const i=this.archiveSamples.filter(t=>null===e||t[0].getTime()<e).concat(t).sort((t,e)=>t[0].getTime()-e[0].getTime());return{valueRange:this.valueRange,samples:i}}}class Mn{constructor(t,e){this.yamcs=t,this.loading$=new v.X(!1),this.data$=new v.X({valueRange:[null,null],samples:[]}),this.parameters$=new v.X([]),this.latestRealtimeValues=new Map,this.syncSubscription=e.sync(()=>{if(this.plotBuffer.dirty&&!this.loading$.getValue()){const t=this.plotBuffer.snapshot();this.data$.next({samples:t.samples,valueRange:t.valueRange}),this.plotBuffer.dirty=!1}}),this.plotBuffer=new Yn(()=>{this.reloadVisibleRange()})}addParameter(...t){if(this.parameters$.next([...this.parameters$.value,...t]),this.realtimeSubscription){const e=t.map(t=>({name:t.qualifiedName}));this.addToRealtimeSubscription(e)}else this.connectRealtime()}removeParameter(t){const e=this.parameters$.value.filter(e=>e.qualifiedName!==t);this.parameters$.next(e)}reloadVisibleRange(){return this.updateWindow(this.visibleStart,this.visibleStop,[null,null])}updateWindowOnly(t,e){this.visibleStart=t,this.visibleStop=e}updateWindow(t,e,i){this.loading$.next(!0);const n=e.getTime()-t.getTime(),a=new Date(t.getTime()-n),s=new Date(e.getTime()+n),o=[];for(const c of this.parameters$.value)o.push(this.yamcs.yamcsClient.getParameterSamples(this.yamcs.instance,c.qualifiedName,{start:a.toISOString(),stop:s.toISOString(),count:6e3}));const r=Promise.all(o);return this.lastLoadPromise=r,r.then(n=>{if(this.lastLoadPromise===r){this.loading$.next(!1),this.plotBuffer.reset(),this.latestRealtimeValues.clear(),this.visibleStart=t,this.visibleStop=e,this.minValue=void 0,this.maxValue=void 0;const a=[];for(let t=0;t<n.length;t++)a[t]=this.processSamples(n[t]);let s=this.mergeSeries(...a);this.plotBuffer.setArchiveData(s),this.plotBuffer.setValueRange(i),this.lastLoadPromise=null}})}connectRealtime(){const t=this.parameters$.value.map(t=>({name:t.qualifiedName}));this.realtimeSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:t,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"REPLACE"},t=>{t.mapping&&(this.idMapping=Object.assign(Object.assign({},this.idMapping),t.mapping)),t.values&&t.values.length&&this.processRealtimeDelivery(t.values)})}addToRealtimeSubscription(t){this.realtimeSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:t,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"ADD"})}processRealtimeDelivery(t){for(const n of t){let t=null;const e=(0,u.t3)(n.engValue);null!==e&&("EXPIRED"===n.acquisitionStatus?t=null:"ACQUIRED"===n.acquisitionStatus&&(t=[e,e,e])),this.latestRealtimeValues.set(this.idMapping[n.numericId].name,t)}const e=new Date;e.setTime(Date.parse(t[0].generationTime));const i=[e,...this.parameters$.value.map(t=>this.latestRealtimeValues.get(t.qualifiedName)||null)];this.plotBuffer.addRealtimeValue(i)}disconnect(){this.data$.complete(),this.loading$.complete(),this.realtimeSubscription&&this.realtimeSubscription.cancel(),this.syncSubscription&&this.syncSubscription.unsubscribe()}processSamples(t){const e=[];for(const i of t){const t=new Date;if(t.setTime(Date.parse(i.time)),i.n>0){const n=i.avg,a=i.min,s=i.max;void 0===this.minValue?(this.minValue=a,this.maxValue=s):(this.minValue>a&&(this.minValue=a),this.maxValue<s&&(this.maxValue=s)),e.push([t,[a,n,s]])}else e.push([t,null])}return e}mergeSeries(...t){if(1===t.length)return t[0];let e=t[0];for(let i=1;i<t.length;i++){const n=[];let a=0,s=0,o=[],r=null;const c=e,l=t[i];for(;a<c.length||s<l.length;){const t=a<c.length?c[a]:null,e=s<l.length?l[s]:null;t&&e?t[0].getTime()===e[0].getTime()?(o=t.slice(1),r=e[1],n.push([t[0],...o,r]),a++,s++):t[0].getTime()<e[0].getTime()?(o=t.slice(1),n.push([t[0],...o,r]),a++):(r=e[1],n.push([e[0],...o,r]),s++):t?(o=t.slice(1),n.push([t[0],...o,r]),a++):e&&(r=e[1],n.push([e[0],...o,r]),s++)}e=n}return e}}var On=i(1941),Dn=i(2654),Pn=i(7701),Ln=i(4689),Rn=i(9996),$n=i(4698),En=i(9961),Hn=i(5732),Vn=i(1686),Fn=i(7064);const Bn=["palette"],jn=["thickness"];function zn(t,e){if(1&t&&(s.TgZ(0,"mat-option",12),s.ALo(1,"memberPath"),s._uU(2),s.ALo(3,"memberPath"),s.qZA()),2&t){const t=e.$implicit;s.Q6J("value",s.lcZ(1,2,t)),s.xp6(2),s.hij(" ",s.lcZ(3,4,t)," ")}}let Gn=(()=>{class t{constructor(t,e,i,n){this.dialogRef=t,this.yamcs=e,this.data=i,this.memberPathPipe=n,this.parameter=new lt.NI(null,[lt.kI.required])}ngOnInit(){const t=this.data.exclude;this.filteredOptions=this.parameter.valueChanges.pipe((0,Pn.b)(300),(0,Ln.w)(t=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:t,limit:10,searchMembers:!0})),(0,Rn.U)(t=>t.parameters||[]),(0,Rn.U)(e=>e.filter(e=>{for(const i of t){const t=this.memberPathPipe.transform(e);if(i.qualifiedName===t)return!1}return!0})))}select(){this.dialogRef.close({qualifiedName:this.parameter.value,color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.so),s.Y36(a.C),s.Y36(T.WI),s.Y36($n.e))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-compare-parameter-dialog"]],viewQuery:function(t,e){if(1&t&&(s.Gf(Bn,7),s.Gf(jn,7)),2&t){let t;s.iGM(t=s.CRH())&&(e.palette=t.first),s.iGM(t=s.CRH())&&(e.thickness=t.first)}},decls:23,vars:7,consts:[[1,"mat-typography","ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],["auto",""],[3,"value",4,"ngFor","ngForOf"],[1,"mat-typography"],["palette",""],[3,"color"],["thickness",""],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"],[3,"value"]],template:function(t,e){if(1&t&&(s.TgZ(0,"mat-dialog-content",0),s.TgZ(1,"label"),s._uU(2," Search parameter for comparison "),s._UZ(3,"input",1),s.TgZ(4,"mat-autocomplete",2,3),s.YNc(6,zn,4,6,"mat-option",4),s.ALo(7,"async"),s.qZA(),s.qZA(),s._UZ(8,"br"),s.TgZ(9,"label",5),s._uU(10,"Color"),s.qZA(),s._UZ(11,"app-color-palette",null,6),s._UZ(13,"br"),s.TgZ(14,"label",5),s._uU(15,"Thickness"),s.qZA(),s._UZ(16,"app-thickness",7,8),s.qZA(),s.TgZ(18,"mat-dialog-actions",9),s.TgZ(19,"button",10),s._uU(20,"CANCEL"),s.qZA(),s.TgZ(21,"button",11),s.NdJ("click",function(){return e.select()}),s._uU(22,"ADD"),s.qZA(),s.qZA()),2&t){const t=s.MAs(5),i=s.MAs(12);s.xp6(3),s.Q6J("formControl",e.parameter)("matAutocomplete",t),s.xp6(3),s.Q6J("ngForOf",s.lcZ(7,5,e.filteredOptions)),s.xp6(10),s.Q6J("color",i.selectedColor),s.xp6(5),s.Q6J("disabled",!e.parameter.valid)}},directives:[T.xY,lt.Fj,En.ZL,lt.JJ,lt.oH,En.XC,o.sg,Hn.V,Vn.z,T.H8,T.ZT,Fn.ey],pipes:[o.Ov,$n.e],encapsulation:2,changeDetection:0}),t})(),Xn=(()=>{class t{constructor(t,e,i){this.dialogRef=t,this.yamcs=i,this.form=new lt.cw({start:new lt.NI(null,lt.kI.required),stop:new lt.NI(null,lt.kI.required)});let n=e.start,a=e.stop;n&&a||(a=this.yamcs.getMissionTime(),n=(0,u.rV)(a,"PT1H")),this.form.setValue({start:u.Y6(n),stop:u.Y6(a)})}select(){const t=u.ZU(this.form.value.start),e=u.ZU(this.form.value.stop);this.dialogRef.close({start:t,stop:e})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.so),s.Y36(T.WI),s.Y36(a.C))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-select-range-dialog"]],decls:15,vars:2,consts:[["mat-dialog-title",""],[1,"mat-typography","ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(t,e){1&t&&(s.TgZ(0,"h2",0),s._uU(1,"Select Range"),s.qZA(),s.TgZ(2,"mat-dialog-content",1),s.TgZ(3,"form",2),s.TgZ(4,"label"),s._uU(5," Start "),s._UZ(6,"app-date-time-input",3),s.qZA(),s.TgZ(7,"label"),s._uU(8," Stop "),s._UZ(9,"app-date-time-input",4),s.qZA(),s.qZA(),s.qZA(),s.TgZ(10,"mat-dialog-actions",5),s.TgZ(11,"button",6),s._uU(12,"CANCEL"),s.qZA(),s.TgZ(13,"button",7),s.NdJ("click",function(){return e.select()}),s._uU(14,"OK"),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("formGroup",e.form),s.xp6(10),s.Q6J("disabled",!e.form.valid))},directives:[T.uh,T.xY,lt._Y,lt.JL,lt.sg,Dt.Y,lt.JJ,lt.u,T.H8,T.ZT],encapsulation:2}),t})();var Wn=i(3357);function Kn(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"Date Range"),s.qZA())}function ta(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"datetime"),s.ALo(3,"datetime"),s.qZA()),2&t){const t=s.oxw().ngIf,e=s.oxw().ngIf;s.xp6(1),s.AsE(" ",s.lcZ(2,2,e)," - ",s.lcZ(3,4,t)," ")}}function ea(t,e){if(1&t&&(s.ynx(0),s.YNc(1,ta,4,6,"span",0),s.BQk()),2&t){const t=s.oxw(2).ngIf;s.xp6(1),s.Q6J("ngIf","CUSTOM"===t)}}function ia(t,e){if(1&t&&(s.ynx(0),s.YNc(1,ea,2,1,"ng-container",0),s.ALo(2,"async"),s.BQk()),2&t){const t=s.oxw(3);s.xp6(1),s.Q6J("ngIf",s.lcZ(2,1,t.customStop$))}}function na(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",11),s.TgZ(1,"app-text-action",12),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).compareParameter()}),s._uU(2," Comparison "),s.qZA(),s._UZ(3,"span",10),s.TgZ(4,"app-text-action",13),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).chooseRange()}),s.YNc(5,Kn,2,0,"span",0),s.YNc(6,ia,3,3,"ng-container",0),s.ALo(7,"async"),s.qZA(),s.TgZ(8,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("PT1M")}),s._uU(9," 1 minute "),s.qZA(),s.TgZ(10,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("PT5M")}),s._uU(11," 5 minutes "),s.qZA(),s.TgZ(12,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("PT15M")}),s._uU(13," 15 minutes "),s.qZA(),s.TgZ(14,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("PT30M")}),s._uU(15," 30 minutes "),s.qZA(),s.TgZ(16,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("PT1H")}),s._uU(17," 1 hour "),s.qZA(),s.TgZ(18,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("PT6H")}),s._uU(19," 6 hours "),s.qZA(),s.TgZ(20,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("PT12H")}),s._uU(21," 12 hours "),s.qZA(),s.TgZ(22,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("P1D")}),s._uU(23," 1 day "),s.qZA(),s.TgZ(24,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("P2D")}),s._uU(25," 2 days "),s.qZA(),s.TgZ(26,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("P1W")}),s._uU(27," 7 days "),s.qZA(),s.TgZ(28,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("P2W")}),s._uU(29," 14 days "),s.qZA(),s.TgZ(30,"app-text-action",14),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).loadLatest("P1M")}),s._uU(31," 30 days "),s.qZA(),s.qZA()}if(2&t){const t=e.ngIf,i=s.oxw(2);s.xp6(4),s.Q6J("active","CUSTOM"===t),s.xp6(1),s.Q6J("ngIf","CUSTOM"!==t),s.xp6(1),s.Q6J("ngIf",s.lcZ(7,15,i.customStart$)),s.xp6(2),s.Q6J("active","PT1M"===t),s.xp6(2),s.Q6J("active","PT5M"===t),s.xp6(2),s.Q6J("active","PT15M"===t),s.xp6(2),s.Q6J("active","PT30M"===t),s.xp6(2),s.Q6J("active","PT1H"===t),s.xp6(2),s.Q6J("active","PT6H"===t),s.xp6(2),s.Q6J("active","PT12H"===t),s.xp6(2),s.Q6J("active","P1D"===t),s.xp6(2),s.Q6J("active","P2D"===t),s.xp6(2),s.Q6J("active","P1W"===t),s.xp6(2),s.Q6J("active","P2W"===t),s.xp6(2),s.Q6J("active","P1M"===t)}}function aa(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last minute"),s.qZA())}function sa(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last 5 minutes"),s.qZA())}function oa(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last 15 minutes"),s.qZA())}function ra(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last 30 minutes"),s.qZA())}function ca(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last hour"),s.qZA())}function la(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last 6 hours"),s.qZA())}function ua(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last 12 hours"),s.qZA())}function pa(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last 24 hours"),s.qZA())}function ma(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last 2 days"),s.qZA())}function ha(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last week"),s.qZA())}function ga(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last 2 weeks"),s.qZA())}function da(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the last month"),s.qZA())}function fa(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"the selected range"),s.qZA())}function Za(t,e){if(1&t&&(s.TgZ(0,"span",18),s._uU(1," There is no data for this chart in "),s.ynx(2,19),s.YNc(3,aa,2,0,"span",20),s.YNc(4,sa,2,0,"span",20),s.YNc(5,oa,2,0,"span",20),s.YNc(6,ra,2,0,"span",20),s.YNc(7,ca,2,0,"span",20),s.YNc(8,la,2,0,"span",20),s.YNc(9,ua,2,0,"span",20),s.YNc(10,pa,2,0,"span",20),s.YNc(11,ma,2,0,"span",20),s.YNc(12,ha,2,0,"span",20),s.YNc(13,ga,2,0,"span",20),s.YNc(14,da,2,0,"span",20),s.YNc(15,fa,2,0,"span",21),s.BQk(),s.qZA()),2&t){const t=e.ngIf;s.xp6(2),s.Q6J("ngSwitch",t),s.xp6(1),s.Q6J("ngSwitchCase","PT1M"),s.xp6(1),s.Q6J("ngSwitchCase","PT5M"),s.xp6(1),s.Q6J("ngSwitchCase","PT15M"),s.xp6(1),s.Q6J("ngSwitchCase","PT30M"),s.xp6(1),s.Q6J("ngSwitchCase","PT1H"),s.xp6(1),s.Q6J("ngSwitchCase","PT6H"),s.xp6(1),s.Q6J("ngSwitchCase","PT12H"),s.xp6(1),s.Q6J("ngSwitchCase","P1D"),s.xp6(1),s.Q6J("ngSwitchCase","P2D"),s.xp6(1),s.Q6J("ngSwitchCase","P1W"),s.xp6(1),s.Q6J("ngSwitchCase","P2W"),s.xp6(1),s.Q6J("ngSwitchCase","P1M")}}function ya(t,e){if(1&t&&(s.TgZ(0,"div",16),s.YNc(1,Za,16,13,"span",17),s.ALo(2,"async"),s.qZA()),2&t){const t=s.oxw(4);s.xp6(1),s.Q6J("ngIf",s.lcZ(2,1,t.range$))}}function xa(t,e){if(1&t&&(s.ynx(0),s.YNc(1,ya,3,3,"div",15),s.BQk()),2&t){const t=s.oxw().ngIf;s.xp6(1),s.Q6J("ngIf",0===t.samples.length)}}function va(t,e){if(1&t&&(s.ynx(0),s.YNc(1,xa,2,1,"ng-container",0),s.ALo(2,"async"),s.BQk()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",!s.lcZ(2,1,t.dataSource.loading$))}}function ba(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.TgZ(1,"div",1),s.YNc(2,na,32,17,"div",2),s.ALo(3,"async"),s.qZA(),s.TgZ(4,"div",3),s.TgZ(5,"app-parameter-plot",4,5),s.NdJ("onVisibleRange",function(e){return s.CHM(t),s.oxw().onVisibleRange(e)})("onManualRangeChange",function(){return s.CHM(t),s.oxw().onManualRangeChange()}),s._UZ(7,"app-parameter-series",6),s.qZA(),s.TgZ(8,"div",7),s.TgZ(9,"div",8),s.TgZ(10,"button",9),s.NdJ("click",function(){return s.CHM(t),s.MAs(6).zoomIn()}),s.TgZ(11,"mat-icon"),s._uU(12,"add"),s.qZA(),s.qZA(),s._UZ(13,"span",10),s.TgZ(14,"button",9),s.NdJ("click",function(){return s.CHM(t),s.MAs(6).zoomOut()}),s.TgZ(15,"mat-icon"),s._uU(16,"remove"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(17,va,3,3,"ng-container",0),s.ALo(18,"async"),s.qZA(),s.BQk()}if(2&t){const t=e.ngIf,i=s.oxw();s.xp6(2),s.Q6J("ngIf",s.lcZ(3,9,i.range$)),s.xp6(3),s.Q6J("xGrid",!0)("xAxisHeight",24)("dataSource",i.dataSource)("stop",i.missionTime)("removableSeries",!0),s.xp6(2),s.Q6J("parameter",t.qualifiedName)("grid",!0),s.xp6(10),s.Q6J("ngIf",s.lcZ(18,11,i.dataSource.data$))}}let wa=(()=>{class t{constructor(t,e,i,n){this.yamcs=e,this.dialog=i,this.range$=new v.X("PT15M"),this.customStart$=new v.X(null),this.customStop$=new v.X(null),this.missionTime=e.getMissionTime();const a=t.parent.snapshot.paramMap.get("qualifiedName");this.dataSource=new Mn(e,n),this.parameter$=e.yamcsClient.getParameter(e.instance,a),this.parameter$.then(t=>{t.qualifiedName=a,this.dataSource.addParameter(t)}),this.timeSubscription=e.time$.subscribe(()=>{var t;if("CUSTOM"!==this.range$.value){const e=this.yamcs.getMissionTime(),i=(0,u.rV)(e,this.range$.value);null===(t=this.plot)||void 0===t||t.updateWindowOnly(i,e)}})}onVisibleRange(t){this.customStart$.next(t[0]),this.customStop$.next(t[1])}onManualRangeChange(){this.range$.next("CUSTOM")}loadLatest(t){this.range$.next(t);const e=this.yamcs.getMissionTime(),i=(0,u.rV)(e,t);this.dataSource.updateWindow(i,e,[null,null])}chooseRange(){const t=this.plot.getDateRange();t&&this.dialog.open(Xn,{width:"400px",data:{start:t[0],stop:t[1]}}).afterClosed().subscribe(t=>{t&&(this.range$.next("CUSTOM"),this.customStart$.next(t.start),this.customStop$.next(t.stop),this.dataSource.updateWindow(t.start,t.stop,[null,null]))})}compareParameter(){this.dialog.open(Gn,{width:"600px",data:{exclude:this.plot.getParameters()}}).afterClosed().subscribe(t=>{t&&this.yamcs.yamcsClient.getParameter(this.yamcs.instance,t.qualifiedName).then(e=>{const i=new Dn.z;i.parameter=t.qualifiedName,i.color=t.color,i.strokeWidth=t.thickness,e.qualifiedName=t.qualifiedName,this.plot.addParameter(e,i)})})}ngOnDestroy(){this.timeSubscription&&this.timeSubscription.unsubscribe(),this.dataSource.disconnect()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(m.gz),s.Y36(a.C),s.Y36(T.uw),s.Y36(h.j))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&s.Gf(On.G,5),2&t){let t;s.iGM(t=s.CRH())&&(e.plot=t.first)}},decls:2,vars:3,consts:[[4,"ngIf"],[2,"padding-left","12px","padding-right","12px","padding-top","12px"],["class","plot-top-actions",4,"ngIf"],[1,"plot-container"],["duration","PT15M",3,"xGrid","xAxisHeight","dataSource","stop","removableSeries","onVisibleRange","onManualRangeChange"],["plot",""],[3,"parameter","grid"],[1,"zoom-actions"],[1,"zoom-actions-inner","mat-elevation-z1"],["mat-button","",3,"click"],[1,"separator"],[1,"plot-top-actions"],["icon","add_circle_outline",3,"click"],["icon","date_range",3,"active","click"],[3,"active","click"],["class","no-data-message",4,"ngIf"],[1,"no-data-message"],["class","mat-caption","style","color: #777;",4,"ngIf"],[1,"mat-caption",2,"color","#777"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(t,e){1&t&&(s.YNc(0,ba,19,13,"ng-container",0),s.ALo(1,"async")),2&t&&s.Q6J("ngIf",s.lcZ(1,1,e.parameter$))},directives:[o.O5,On.G,Dn.z,_.lW,U.Hw,Wn.l,o.RF,o.n9,o.ED],pipes:[o.Ov,k.i],styles:[".plot-container[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.12);top:48px;bottom:0}.plot-container[_ngcontent-%COMP%], .zoom-actions[_ngcontent-%COMP%]{position:absolute;left:0;right:0}.zoom-actions[_ngcontent-%COMP%]{bottom:35px;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.no-data-message[_ngcontent-%COMP%]{position:absolute;top:50%;bottom:0;left:0;right:0;margin:0 auto;text-align:center;pointer-events:none}.plot-top-actions[_ngcontent-%COMP%]{height:24px;line-height:24px}.separator[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12)}"],changeDetection:0}),t})();class Aa extends x.o2{constructor(t,e){super(),this.yamcs=t,this.qualifiedName=e,this.pageSize=100,this.pvals$=new v.X([]),this.loading$=new v.X(!1)}connect(t){return this.pvals$}isEmpty(){return 0===this.pvals$.value.length}loadParameterValues(t){return this.loading$.next(!0),this.loadPage(Object.assign(Object.assign({},t),{limit:this.pageSize+1})).then(t=>{this.loading$.next(!1),this.pvals$.next(t)})}hasMore(){return null!=this.offscreenRecord}loadPage(t){return this.yamcs.yamcsClient.getParameterValues(this.yamcs.instance,this.qualifiedName,t).then(t=>(this.offscreenRecord=t.length>this.pageSize?t.splice(t.length-1,1)[0]:null,t))}loadMoreData(t){this.offscreenRecord&&this.loadPage(Object.assign(Object.assign({},t),{stop:this.offscreenRecord.generationTime,limit:this.pageSize+1})).then(t=>{const e=this.pvals$.getValue().concat(t);this.pvals$.next(e)})}disconnect(t){this.pvals$.complete(),this.loading$.complete()}}var Ta=i(5790);function Sa(t,e){1&t&&(s.TgZ(0,"th",15),s._uU(1,"Severity"),s.qZA())}function qa(t,e){if(1&t&&s._UZ(0,"app-alarm-level",19),2&t){const t=s.oxw().$implicit;s.Q6J("level",t.monitoringResult)}}function Ca(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"-"),s.qZA())}function Na(t,e){if(1&t&&(s.TgZ(0,"td",16),s.YNc(1,qa,1,1,"app-alarm-level",17),s.YNc(2,Ca,2,0,"span",18),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",t.monitoringResult),s.xp6(1),s.Q6J("ngIf",!t.monitoringResult)}}function _a(t,e){1&t&&(s.TgZ(0,"th",20),s._uU(1,"Generation Time"),s.qZA())}function Ua(t,e){if(1&t&&(s.TgZ(0,"td",16),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,t.generationTime)||"-")}}function Ia(t,e){1&t&&(s.TgZ(0,"th",20),s._uU(1,"Reception Time"),s.qZA())}function ka(t,e){if(1&t&&(s.TgZ(0,"td",16),s._uU(1),s.ALo(2,"datetime"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,t.acquisitionTime)||"-")}}function Qa(t,e){1&t&&(s.TgZ(0,"th",20),s._uU(1,"Raw"),s.qZA())}function Ja(t,e){if(1&t&&(s.TgZ(0,"td",16),s._uU(1),s.ALo(2,"value"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,t.rawValue)||"-")}}function Ya(t,e){1&t&&(s.TgZ(0,"th",20),s._uU(1,"Eng"),s.qZA())}function Ma(t,e){if(1&t&&(s.TgZ(0,"td",16),s._uU(1),s.ALo(2,"value"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,t.engValue)||"-")}}function Oa(t,e){1&t&&(s.TgZ(0,"th",21),s._uU(1,"Range Condition"),s.qZA())}function Da(t,e){if(1&t&&(s.TgZ(0,"td",16),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(t.rangeCondition||"-")}}function Pa(t,e){1&t&&(s.TgZ(0,"th",21),s._uU(1,"Acquisition Status"),s.qZA())}function La(t,e){if(1&t&&(s.TgZ(0,"td",16),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(t.acquisitionStatus||"-")}}function Ra(t,e){1&t&&s._UZ(0,"tr",22)}function $a(t,e){1&t&&s._UZ(0,"tr",23)}function Ea(t,e){if(1&t&&(s.TgZ(0,"table",1),s.ynx(1,2),s.YNc(2,Sa,2,0,"th",3),s.YNc(3,Na,3,2,"td",4),s.BQk(),s.ynx(4,5),s.YNc(5,_a,2,0,"th",6),s.YNc(6,Ua,3,3,"td",4),s.BQk(),s.ynx(7,7),s.YNc(8,Ia,2,0,"th",6),s.YNc(9,ka,3,3,"td",4),s.BQk(),s.ynx(10,8),s.YNc(11,Qa,2,0,"th",6),s.YNc(12,Ja,3,3,"td",4),s.BQk(),s.ynx(13,9),s.YNc(14,Ya,2,0,"th",6),s.YNc(15,Ma,3,3,"td",4),s.BQk(),s.ynx(16,10),s.YNc(17,Oa,2,0,"th",11),s.YNc(18,Da,2,1,"td",4),s.BQk(),s.ynx(19,12),s.YNc(20,Pa,2,0,"th",11),s.YNc(21,La,2,1,"td",4),s.BQk(),s.YNc(22,Ra,1,0,"tr",13),s.YNc(23,$a,1,0,"tr",14),s.qZA()),2&t){const t=s.oxw();s.Q6J("dataSource",t.dataSource),s.xp6(22),s.Q6J("matHeaderRowDef",t.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns)}}let Ha=(()=>{class t{constructor(){this.displayedColumns=["severity","generationTime","rawValue","engValue","rangeCondition","acquisitionStatus"]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-parameter-values-table"]],inputs:{dataSource:"dataSource"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table",3,"dataSource",4,"ngIf"],["mat-table","",1,"ya-data-table",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","","style","width: 80px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["mat-header-cell","","style","width: 200px",4,"matHeaderCellDef"],["matColumnDef","receptionTime"],["matColumnDef","rawValue"],["matColumnDef","engValue"],["matColumnDef","rangeCondition"],["mat-header-cell","","style","width: 150px",4,"matHeaderCellDef"],["matColumnDef","acquisitionStatus"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"width","80px"],["mat-cell",""],[3,"level",4,"ngIf"],[4,"ngIf"],[3,"level"],["mat-header-cell","",2,"width","200px"],["mat-header-cell","",2,"width","150px"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&s.YNc(0,Ea,24,3,"table",0),2&t&&s.Q6J("ngIf",e.dataSource)},directives:[o.O5,S.BZ,S.w1,S.fO,S.Dz,S.as,S.nj,S.ge,S.ev,C.i,S.XQ,S.Gk],pipes:[k.i,I.V],encapsulation:2,changeDetection:0}),t})();function Va(t,e){if(1&t){const t=s.EpF();s.ynx(0),s._UZ(1,"app-date-time-input",11),s._UZ(2,"app-date-time-input",12),s.TgZ(3,"button",13),s.NdJ("click",function(){return s.CHM(t),s.oxw().applyCustomDates()}),s._uU(4,"Apply"),s.qZA(),s.BQk()}if(2&t){const t=s.oxw();s.xp6(3),s.Q6J("disabled",t.filter.invalid)}}function Fa(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.TgZ(1,"button",14),s.NdJ("click",function(){return s.CHM(t),s.oxw().jumpToNow()}),s._uU(2," Jump to now "),s.qZA(),s.BQk()}}function Ba(t,e){1&t&&s._UZ(0,"app-dots")}function ja(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3,"the last hour"),s.qZA(),s._uU(4," ending at "),s.TgZ(5,"b"),s._uU(6),s.ALo(7,"datetime"),s.qZA(),s._uU(8," (Mission Time) "),s.qZA()),2&t){const t=s.oxw();s.xp6(6),s.Oqu(s.lcZ(7,1,t.validStop))}}function za(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3,"the last 6 hours"),s.qZA(),s._uU(4," ending at "),s.TgZ(5,"b"),s._uU(6),s.ALo(7,"datetime"),s.qZA(),s._uU(8," (Mission Time) "),s.qZA()),2&t){const t=s.oxw();s.xp6(6),s.Oqu(s.lcZ(7,1,t.validStop))}}function Ga(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3,"the last 24 hours"),s.qZA(),s._uU(4," ending at "),s.TgZ(5,"b"),s._uU(6),s.ALo(7,"datetime"),s.qZA(),s._uU(8," (Mission Time) "),s.qZA()),2&t){const t=s.oxw();s.xp6(6),s.Oqu(s.lcZ(7,1,t.validStop))}}function Xa(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3,"all time"),s.qZA(),s.qZA())}function Wa(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1," Showing data from "),s.TgZ(2,"b"),s._uU(3),s.ALo(4,"datetime"),s.qZA(),s._uU(5," to "),s.TgZ(6,"b"),s._uU(7),s.ALo(8,"datetime"),s.qZA(),s._uU(9," (Mission Time) "),s.qZA()),2&t){const t=s.oxw();s.xp6(3),s.Oqu(s.lcZ(4,2,t.validStart)),s.xp6(4),s.Oqu(s.lcZ(8,4,t.validStop))}}function Ka(t,e){1&t&&(s.TgZ(0,"small"),s._uU(1,"No records found matching current filter in the selected time range."),s.qZA())}function ts(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",15),s.YNc(1,Ka,2,0,"small",4),s.TgZ(2,"button",13),s.NdJ("click",function(){return s.CHM(t),s.oxw().loadMoreData()}),s._uU(3,"Load More"),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",t.dataSource.isEmpty()),s.xp6(1),s.Q6J("disabled",!t.dataSource.hasMore())}}const es="PT1H";let is=(()=>{class t{constructor(t,e){this.yamcs=e,this.intervalOptions=[{id:"PT1H",label:"Last Hour"},{id:"PT6H",label:"Last 6 Hours"},{id:"P1D",label:"Last 24 Hours"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}],this.filter=new lt.cw({interval:new lt.NI(es),customStart:new lt.NI(null),customStop:new lt.NI(null)}),this.downloadURL$=new v.X(null),this.qualifiedName=t.parent.snapshot.paramMap.get("qualifiedName"),this.dataSource=new Aa(e,this.qualifiedName),this.validStop=e.getMissionTime(),this.validStart=u.rV(this.validStop,es),this.appliedInterval=es,this.loadData(),this.filter.get("interval").valueChanges.forEach(t=>{if("CUSTOM"===t){const t=this.validStart||this.yamcs.getMissionTime(),e=this.validStop||this.yamcs.getMissionTime();this.filter.get("customStart").setValue(u.Y6(t)),this.filter.get("customStop").setValue(u.Y6(e))}else"NO_LIMIT"===t?(this.validStart=null,this.validStop=null,this.appliedInterval=t,this.loadData()):(this.validStop=e.getMissionTime(),this.validStart=u.rV(this.validStop,t),this.appliedInterval=t,this.loadData())})}jumpToNow(){const t=this.filter.value.interval;"NO_LIMIT"===t?this.filter.get("interval").setValue(es):(this.validStop=this.yamcs.getMissionTime(),this.validStart=u.rV(this.validStop,t),this.loadData())}applyCustomDates(){this.validStart=u.ZU(this.filter.value.customStart),this.validStop=u.ZU(this.filter.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){const t={};this.validStart&&(t.start=this.validStart.toISOString()),this.validStop&&(t.stop=this.validStop.toISOString());const e={parameters:[this.qualifiedName]};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.dataSource.loadParameterValues(t).then(t=>{const i=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,e);this.downloadURL$.next(i)})}loadMoreData(){const t={};this.validStart&&(t.start=this.validStart.toISOString()),this.dataSource.loadMoreData(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(m.gz),s.Y36(a.C))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],decls:21,vars:21,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[4,"ngIf"],[1,"table-status",3,"ngSwitch"],[1,"message-zone"],[3,"link","download"],[4,"ngSwitchCase"],[3,"dataSource"],["class","table-footer",4,"ngIf"],["formControlName","customStart"],["formControlName","customStop"],[1,"ya-button",3,"disabled","click"],[1,"ya-button",3,"click"],[1,"table-footer"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"form",1),s.TgZ(2,"div",2),s._UZ(3,"app-select",3),s.YNc(4,Va,5,1,"ng-container",4),s.YNc(5,Fa,3,0,"ng-container",4),s.YNc(6,Ba,1,0,"app-dots",4),s.ALo(7,"async"),s.qZA(),s.qZA(),s.TgZ(8,"div",5),s.TgZ(9,"div",6),s.TgZ(10,"app-action-link",7),s.ALo(11,"async"),s._uU(12,"Download Data"),s.qZA(),s.qZA(),s.YNc(13,ja,9,3,"span",8),s.YNc(14,za,9,3,"span",8),s.YNc(15,Ga,9,3,"span",8),s.YNc(16,Xa,4,0,"span",8),s.YNc(17,Wa,10,6,"span",8),s.qZA(),s._UZ(18,"app-parameter-values-table",9),s.YNc(19,ts,4,2,"div",10),s.ALo(20,"async"),s.qZA()),2&t&&(s.xp6(1),s.Q6J("formGroup",e.filter),s.xp6(2),s.Q6J("options",e.intervalOptions),s.xp6(1),s.Q6J("ngIf","CUSTOM"===e.filter.value.interval),s.xp6(1),s.Q6J("ngIf","CUSTOM"!==e.filter.value.interval),s.xp6(1),s.Q6J("ngIf",s.lcZ(7,15,e.dataSource.loading$)),s.xp6(2),s.Q6J("ngSwitch",e.appliedInterval),s.xp6(2),s.Q6J("link",s.lcZ(11,17,e.downloadURL$))("download","Parameter Data"),s.xp6(3),s.Q6J("ngSwitchCase","PT1H"),s.xp6(1),s.Q6J("ngSwitchCase","PT6H"),s.xp6(1),s.Q6J("ngSwitchCase","P1D"),s.xp6(1),s.Q6J("ngSwitchCase","NO_LIMIT"),s.xp6(1),s.Q6J("ngSwitchCase","CUSTOM"),s.xp6(1),s.Q6J("dataSource",e.dataSource),s.xp6(1),s.Q6J("ngIf",!s.lcZ(20,19,e.dataSource.loading$)))},directives:[lt._Y,lt.JL,lt.sg,Ci.P,lt.JJ,lt.u,o.O5,o.RF,Ta.v,o.n9,Ha,Dt.Y,Qe.b],pipes:[o.Ov,k.i],styles:[".table-status[_ngcontent-%COMP%]{background-color:#f2f2f2;padding-left:6px;margin-bottom:12px}.table-status[_ngcontent-%COMP%], .table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{height:24px;line-height:24px;font-size:12px}.table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{float:right;padding-right:6px}.table-footer[_ngcontent-%COMP%]{background-color:#f2f2f2;height:24px;line-height:24px;text-align:center}"],changeDetection:0}),t})();var ns=i(1508),as=i(5381),ss=i(6298),os=i(7673);function rs(t,e){if(1&t&&(s.TgZ(0,"option",10),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.Q6J("value",t.label),s.xp6(1),s.hij(" ",t.label,"")}}function cs(t,e){if(1&t&&(s.TgZ(0,"label"),s.TgZ(1,"div",4),s.TgZ(2,"div",5),s._uU(3),s.qZA(),s.qZA(),s._uU(4),s._UZ(5,"app-errors",6),s.TgZ(6,"select",7),s.TgZ(7,"option",8),s._uU(8," -- select an option -- "),s.qZA(),s.YNc(9,rs,2,2,"option",9),s.qZA(),s.qZA()),2&t){const t=s.oxw().ngIf,e=s.oxw();s.xp6(3),s.Oqu(e.parameter.type.engType),s.xp6(1),s.hij(" ",e.parameter.name," "),s.xp6(1),s.Q6J("controlName",t),s.xp6(1),s.Q6J("formControlName",t),s.xp6(3),s.Q6J("ngForOf",e.parameter.type.enumValue)}}function ls(t,e){if(1&t&&(s.TgZ(0,"label"),s._uU(1),s._UZ(2,"app-errors",6),s._UZ(3,"br"),s._UZ(4,"input",11),s._uU(5," true"),s._UZ(6,"br"),s._UZ(7,"input",12),s._uU(8," false "),s.qZA()),2&t){const t=s.oxw().ngIf,e=s.oxw();s.xp6(1),s.hij(" ",e.parameter.name," "),s.xp6(1),s.Q6J("controlName",t),s.xp6(2),s.Q6J("formControlName",t),s.xp6(3),s.Q6J("formControlName",t)}}function us(t,e){if(1&t&&(s.TgZ(0,"label"),s._uU(1),s._UZ(2,"app-errors",6),s._UZ(3,"app-date-time-input",7),s.qZA()),2&t){const t=s.oxw().ngIf,e=s.oxw();s.xp6(1),s.hij(" ",e.parameter.name," "),s.xp6(1),s.Q6J("controlName",t),s.xp6(1),s.Q6J("formControlName",t)}}function ps(t,e){if(1&t&&(s.TgZ(0,"label"),s.TgZ(1,"div",4),s.TgZ(2,"div",5),s.ALo(3,"async"),s._uU(4),s.qZA(),s.qZA(),s._uU(5),s._UZ(6,"app-errors",6,13),s._UZ(8,"app-binary-input",7),s.qZA()),2&t){const t=s.MAs(7),e=s.oxw().ngIf,i=s.oxw();s.xp6(2),s.ekj("error",s.lcZ(3,6,t.invalid$)),s.xp6(2),s.Oqu(i.parameter.type.engType),s.xp6(1),s.hij(" ",i.parameter.name," "),s.xp6(1),s.Q6J("controlName",e),s.xp6(2),s.Q6J("formControlName",e)}}function ms(t,e){if(1&t&&(s.ynx(0),s._UZ(1,"app-parameter-form",16),s._UZ(2,"br"),s.BQk()),2&t){const t=e.$implicit,i=s.oxw(3);s.xp6(1),s.Q6J("parameter",t)("formGroup",i.formGroup)("parent",i.parent?i.parent+"."+i.parameter.name:i.parameter.name)}}function hs(t,e){if(1&t&&(s.TgZ(0,"label"),s.TgZ(1,"div",4),s.TgZ(2,"div",5),s._uU(3),s.qZA(),s.qZA(),s._uU(4),s.TgZ(5,"div",14),s.YNc(6,ms,3,3,"ng-container",15),s.qZA(),s.qZA()),2&t){const t=s.oxw(2);s.xp6(3),s.Oqu(t.parameter.type.engType),s.xp6(1),s.hij(" ",t.parameter.name," "),s.xp6(2),s.Q6J("ngForOf",null==t.parameter.type?null:t.parameter.type.member)}}function gs(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function ds(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function fs(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function Zs(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function ys(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function xs(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function vs(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function bs(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function ws(t,e){1&t&&(s.ynx(0),s._uU(1," Setting array values via this website is not yet supported. "),s.BQk())}function As(t,e){if(1&t&&(s.TgZ(0,"div",5),s._uU(1),s.ALo(2,"units"),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.hij(" ",s.lcZ(2,1,null==t.parameter.type?null:t.parameter.type.unitSet)," ")}}function Ts(t,e){if(1&t&&(s.TgZ(0,"label"),s.TgZ(1,"div",4),s.ALo(2,"async"),s.YNc(3,As,3,3,"div",17),s.TgZ(4,"div",5),s._uU(5),s.qZA(),s.qZA(),s._uU(6),s._UZ(7,"app-errors",6,13),s._UZ(9,"input",18),s.qZA()),2&t){const t=s.MAs(8),e=s.oxw().ngIf,i=s.oxw();s.xp6(1),s.ekj("error",s.lcZ(2,7,t.invalid$)),s.xp6(2),s.Q6J("ngIf",null==i.parameter.type?null:i.parameter.type.unitSet),s.xp6(2),s.Oqu(i.parameter.type.engType),s.xp6(1),s.hij(" ",i.parameter.name," "),s.xp6(1),s.Q6J("controlName",e),s.xp6(2),s.Q6J("formControlName",e)}}function Ss(t,e){if(1&t&&(s.ynx(0,1),s.YNc(1,cs,10,5,"label",2),s.YNc(2,ls,9,4,"label",2),s.YNc(3,us,4,3,"label",2),s.YNc(4,ps,9,8,"label",2),s.YNc(5,hs,7,3,"label",2),s.YNc(6,gs,2,0,"ng-container",2),s.YNc(7,ds,2,0,"ng-container",2),s.YNc(8,fs,2,0,"ng-container",2),s.YNc(9,Zs,2,0,"ng-container",2),s.YNc(10,ys,2,0,"ng-container",2),s.YNc(11,xs,2,0,"ng-container",2),s.YNc(12,vs,2,0,"ng-container",2),s.YNc(13,bs,2,0,"ng-container",2),s.YNc(14,ws,2,0,"ng-container",2),s.YNc(15,Ts,10,9,"label",3),s.BQk()),2&t){const t=s.oxw();s.Q6J("formGroup",t.formGroup)("ngSwitch",null==t.parameter.type?null:t.parameter.type.engType),s.xp6(1),s.Q6J("ngSwitchCase","enumeration"),s.xp6(1),s.Q6J("ngSwitchCase","boolean"),s.xp6(1),s.Q6J("ngSwitchCase","time"),s.xp6(1),s.Q6J("ngSwitchCase","binary"),s.xp6(1),s.Q6J("ngSwitchCase","aggregate"),s.xp6(1),s.Q6J("ngSwitchCase","float[]"),s.xp6(1),s.Q6J("ngSwitchCase","double[]"),s.xp6(1),s.Q6J("ngSwitchCase","integer[]"),s.xp6(1),s.Q6J("ngSwitchCase","enumeration[]"),s.xp6(1),s.Q6J("ngSwitchCase","string[]"),s.xp6(1),s.Q6J("ngSwitchCase","boolean[]"),s.xp6(1),s.Q6J("ngSwitchCase","time[]"),s.xp6(1),s.Q6J("ngSwitchCase","binary[]"),s.xp6(1),s.Q6J("ngSwitchCase","aggregate[]")}}let qs=(()=>{class t{constructor(){this.controlName$=new v.X(null)}ngOnInit(){this.controlName$.next(this.parent?this.parent+"."+this.parameter.name:this.parameter.name)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-parameter-form"]],inputs:{formGroup:"formGroup",parameter:"parameter",parent:"parent"},decls:2,vars:3,consts:[[3,"formGroup","ngSwitch",4,"ngIf"],[3,"formGroup","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControlName"],["hidden","","disabled","","selected","","value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],["err",""],[1,"members"],[4,"ngFor","ngForOf"],[3,"parameter","formGroup","parent"],["class","item",4,"ngIf"],["type","text",3,"formControlName"]],template:function(t,e){1&t&&(s.YNc(0,Ss,16,16,"ng-container",0),s.ALo(1,"async")),2&t&&s.Q6J("ngIf",s.lcZ(1,1,e.controlName$))},directives:[o.O5,lt.JL,lt.sg,o.RF,o.n9,o.ED,as.D,lt.EJ,lt.JJ,lt.u,lt.YN,lt.Kr,o.sg,lt._,lt.Fj,Dt.Y,ss.Y,t],pipes:[o.Ov,os.H],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:rgba(0,0,0,.65);padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#dc143c;color:#fff}.members[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px}"],changeDetection:0}),t})(),Cs=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.form=new lt.cw({}),this.parameter=e.parameter;const i=this.getValidatorsForType(this.parameter.type);"aggregate"===this.parameter.type.engType?this.addMemberControls(this.parameter.name+".",this.parameter.type.member||[]):this.form.addControl(this.parameter.name,new lt.NI(null,i))}addMemberControls(t,e){for(const i of e)if("aggregate"===i.type.engType)this.addMemberControls(t+i.name+".",i.type.member||[]);else{const e=t+i.name,n=this.getValidatorsForType(i.type);this.form.addControl(e,new lt.NI("",n))}}getValidatorsForType(t){const e=[lt.kI.required];return"integer"===t.engType?e.push(ns.V):"float"===t.engType&&e.push(ns.H),e}save(){const t=this.toValue("",this.parameter);this.dialogRef.close(t)}toValue(t,e){const i=this.form.value[t+e.name];switch(e.type.engType){case"boolean":return{type:"BOOLEAN",booleanValue:"true"===i};case"float":return{type:"FLOAT",floatValue:i};case"double":return{type:"DOUBLE",doubleValue:i};case"enumeration":return{type:"STRING",stringValue:i};case"integer":return{type:"SINT32",sint32Value:i};case"string":return{type:"STRING",stringValue:i};case"time":return{type:"TIMESTAMP",stringValue:u.Y6(i)};case"binary":return{type:"BINARY",binaryValue:u.MU(i)};case"aggregate":const n=[],a=[];for(const i of e.type.member||[])n.push(i.name),a.push(this.toValue(t+e.name+".",i));return{type:"AGGREGATE",aggregateValue:{name:n,value:a}};default:throw new Error(`Unexpected type: ${e.type.engType}`)}}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(T.so),s.Y36(T.WI))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-set-parameter-dialog"]],decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"ya-form",3,"formGroup"],[3,"parameter","formGroup"],["align","end"],["mat-dialog-close","",1,"ya-button"],[1,"ya-button","primary",3,"disabled","click"]],template:function(t,e){1&t&&(s.TgZ(0,"h2",0),s._uU(1,"Set parameter value"),s.qZA(),s.TgZ(2,"mat-dialog-content",1),s.TgZ(3,"form",2),s._UZ(4,"app-parameter-form",3),s.qZA(),s.qZA(),s.TgZ(5,"mat-dialog-actions",4),s.TgZ(6,"button",5),s._uU(7,"CANCEL"),s.qZA(),s.TgZ(8,"button",6),s.NdJ("click",function(){return e.save()}),s._uU(9,"SAVE"),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("formGroup",e.form),s.xp6(1),s.Q6J("parameter",e.parameter)("formGroup",e.form),s.xp6(4),s.Q6J("disabled",!e.form.valid))},directives:[T.uh,T.xY,lt._Y,lt.JL,lt.sg,qs,T.H8,T.ZT],encapsulation:2}),t})();var Ns=i(7173),_s=i(3123),Us=i(6927);const Is=function(t,e){return{c:t,system:e}};function ks(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"a",11),s._uU(2),s.qZA(),s._uU(3),s.ALo(4,"shortName"),s.ALo(5,"async"),s.BQk()),2&t){const t=e.ngIf,i=s.oxw().ngIf,n=s.oxw();s.xp6(1),s.Q6J("queryParams",s.WLB(8,Is,n.yamcs.context,t)),s.xp6(1),s.hij(" ",t," "),s.xp6(1),s.AsE("/",s.lcZ(4,4,i.qualifiedName),"",s.lcZ(5,6,n.offset$)," ")}}function Qs(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",12),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).setParameter()}),s.TgZ(1,"mat-icon"),s._uU(2,"edit"),s.qZA(),s._uU(3," SET VALUE "),s.qZA()}}const Js=function(t){return["/mdb/parameters",t]},Ys=function(t){return{c:t}};function Ms(t,e){if(1&t&&(s.TgZ(0,"a",13),s.TgZ(1,"mat-icon"),s._uU(2,"style"),s.qZA(),s._uU(3," VIEW IN MDB "),s.qZA()),2&t){const t=s.oxw().ngIf,e=s.oxw();s.Q6J("routerLink",s.VKq(2,Js,t.qualifiedName))("queryParams",s.VKq(4,Ys,e.yamcs.context))}}function Os(t,e){if(1&t&&(s.TgZ(0,"a",14,15),s._uU(2," Chart "),s.qZA()),2&t){const t=s.MAs(1),e=s.oxw(2);s.Q6J("active",t.isActive)("queryParams",s.VKq(2,Ys,e.yamcs.context))}}function Ds(t,e){if(1&t&&(s.TgZ(0,"a",16,17),s._uU(2," Alarm History "),s.qZA()),2&t){const t=s.MAs(1),e=s.oxw(2);s.Q6J("active",t.isActive)("queryParams",s.VKq(2,Ys,e.yamcs.context))}}function Ps(t,e){if(1&t&&(s.TgZ(0,"a",18,19),s._uU(2," Historical Data "),s.qZA()),2&t){const t=s.MAs(1),e=s.oxw(2);s.Q6J("active",t.isActive)("queryParams",s.VKq(2,Ys,e.yamcs.context))}}function Ls(t,e){if(1&t&&(s.TgZ(0,"app-instance-page"),s.TgZ(1,"app-instance-toolbar"),s.YNc(2,ks,6,11,"ng-container",0),s.ALo(3,"spaceSystemName"),s._uU(4," \xa0\xa0\xa0 "),s.YNc(5,Qs,4,0,"button",1),s.ALo(6,"async"),s.YNc(7,Ms,4,6,"a",2),s.qZA(),s.TgZ(8,"nav",3,4),s.TgZ(10,"a",5,6),s._uU(12," Summary "),s.qZA(),s.YNc(13,Os,3,4,"a",7),s.YNc(14,Ds,3,4,"a",8),s.YNc(15,Ps,3,4,"a",9),s.qZA(),s.TgZ(16,"div",10),s._UZ(17,"router-outlet"),s.qZA(),s.qZA()),2&t){const t=e.ngIf,i=s.MAs(9),n=s.MAs(11),a=s.oxw();s.xp6(2),s.Q6J("ngIf",s.lcZ(3,10,t.qualifiedName)),s.xp6(3),s.Q6J("ngIf",a.isWritable()&&a.maySetParameter()&&!s.lcZ(6,12,a.offset$)),s.xp6(2),s.Q6J("ngIf",a.mayReadMissionDatabase()),s.xp6(3),s.Q6J("active",n.isActive)("queryParams",s.VKq(14,Ys,a.yamcs.context)),s.xp6(3),s.Q6J("ngIf",a.config.tmArchive),s.xp6(1),s.Q6J("ngIf",a.mayReadAlarms()),s.xp6(1),s.Q6J("ngIf",a.config.tmArchive),s.xp6(1),s.ekj("noscroll",1===i.selectedIndex)}}let Rs=(()=>{class t{constructor(t,e,i,n,a,s,o,r,c){this.yamcs=e,this.authService=i,this.messageService=n,this.dialog=a,this.title=s,this.valuePipe=o,this.unitsPipe=r,this.parameter$=new v.X(null),this.offset$=new v.X(null),this.parameterValue$=new v.X(null),this.config=c.getConfig(),t.paramMap.subscribe(t=>{const e=t.get("qualifiedName");this.changeParameter(e)})}changeParameter(t){this.yamcs.yamcsClient.getParameter(this.yamcs.instance,t).then(e=>{this.parameter$.next(e),this.offset$.next(t!==e.qualifiedName?t.substring(e.qualifiedName.length):null),this.updateTitle()}),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:t}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},t=>{this.parameterValue$.next(t.values?t.values[0]:null),this.updateTitle()})}updateTitle(){const t=this.parameter$.getValue(),e=this.offset$.getValue();if(t){let i=t.name;e&&(i+=e);const n=this.parameterValue$.getValue();n&&(i+=": "+this.valuePipe.transform(n.engValue),t.type&&t.type.unitSet&&(i+=" "+this.unitsPipe.transform(t.type.unitSet)),n.rangeCondition&&"LOW"===n.rangeCondition?i+=" \u2193":n.rangeCondition&&"HIGH"===n.rangeCondition&&(i+=" \u2191")),this.title.setTitle(i)}}isWritable(){const t=this.parameter$.value;return!!t&&("LOCAL"===t.dataSource||"EXTERNAL1"===t.dataSource||"EXTERNAL2"===t.dataSource||"EXTERNAL3"===t.dataSource)}maySetParameter(){const t=this.parameter$.value;return!!t&&this.authService.getUser().hasObjectPrivilege("WriteParameter",t.qualifiedName)}mayReadAlarms(){return this.authService.getUser().hasSystemPrivilege("ReadAlarms")}mayReadMissionDatabase(){return this.authService.getUser().hasSystemPrivilege("GetMissionDatabase")}setParameter(){const t=this.parameter$.value;this.dialog.open(Cs,{width:"400px",data:{parameter:this.parameter$.value}}).afterClosed().subscribe(e=>{e&&this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,t.qualifiedName,e).catch(t=>this.messageService.showError(t))})}ngOnDestroy(){this.parameterValueSubscription&&this.parameterValueSubscription.cancel()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(m.gz),s.Y36(a.C),s.Y36(Ot.e),s.Y36(g.e),s.Y36(T.uw),s.Y36(pe.Dx),s.Y36(I.V),s.Y36(os.H),s.Y36(b.E))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"routerLink","queryParams",4,"ngIf"],["mat-tab-nav-bar",""],["tabs",""],["mat-tab-link","","routerLink","summary","routerLinkActive","",3,"active","queryParams"],["rla","routerLinkActive"],["mat-tab-link","","routerLink","chart","routerLinkActive","",3,"active","queryParams",4,"ngIf"],["mat-tab-link","","routerLink","alarms","routerLinkActive","",3,"active","queryParams",4,"ngIf"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams",4,"ngIf"],[1,"tab-content-wrapper"],["routerLink","/telemetry/parameters",1,"ya-link","ya-header-link",3,"queryParams"],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"routerLink","queryParams"],["mat-tab-link","","routerLink","chart","routerLinkActive","",3,"active","queryParams"],["rlb","routerLinkActive"],["mat-tab-link","","routerLink","alarms","routerLinkActive","",3,"active","queryParams"],["rlc","routerLinkActive"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams"],["rld","routerLinkActive"]],template:function(t,e){1&t&&(s.YNc(0,Ls,18,16,"app-instance-page",0),s.ALo(1,"async")),2&t&&s.Q6J("ngIf",s.lcZ(1,1,e.parameter$))},directives:[o.O5,me.a,he.k,Ns.BU,m.yS,Ns.Nj,m.Od,m.lC,_.lW,U.Hw,_.zs],pipes:[o.Ov,_s.B,Us.y],styles:[".tab-content-wrapper[_ngcontent-%COMP%]{position:absolute;top:49px;left:0;right:0;bottom:0;overflow:auto}.tab-content-wrapper.noscroll[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0}),t})();var $s=i(5609);class Es extends x.o2{constructor(t,e){super(),this.yamcs=t,this.synchronizer=e,this.items$=new v.X([]),this.totalSize$=new v.X(0),this.loading$=new v.X(!1),this.idMapping={},this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}loadParameters(t){return e=this,void 0,n=function*(){this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0),this.yamcs.yamcsClient.getParameters(this.yamcs.instance,t).then(t=>{this.loading$.next(!1),this.totalSize$.next(t.totalSize);const e=[];for(const i of t.spaceSystems||[])e.push({spaceSystem:!0,name:i});for(const i of t.parameters||[])e.push({spaceSystem:!1,name:i.qualifiedName,parameter:i});this.items$.next(e),this.startSubscription(t.parameters||[])})},new((i=void 0)||(i=Promise))(function(t,a){function s(t){try{r(n.next(t))}catch(e){a(e)}}function o(t){try{r(n.throw(t))}catch(e){a(e)}}function r(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i(function(t){t(n)})).then(s,o)}r((n=n.apply(e,[])).next())});var e,i,n}refreshTable(){const t=this.items$.value;for(const e of t)e.spaceSystem||(e.pval=this.latestValues.get(e.name));this.items$.next([...t])}startSubscription(t){const e=t.map(t=>({name:t.qualifiedName}));e.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:e,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},t=>{t.mapping&&(this.idMapping=t.mapping,this.latestValues.clear()),this.processDelivery(t.values||[])}))}processDelivery(t){for(const e of t){const t=this.idMapping[e.numericId];t&&this.latestValues.set(t.name,e)}}disconnect(){this.syncSubscription&&this.syncSubscription.unsubscribe(),this.dataSubscription&&this.dataSubscription.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}}var Hs=i(8784),Vs=i(4580);const Fs=["top"];function Bs(t,e){if(1&t&&s._UZ(0,"app-breadcrumb",15),2&t){const t=e.$implicit;s.Q6J("link",t.route)("queryParams",t.queryParams)("label",t.name)}}const js=function(t){return{c:t}};function zs(t,e){if(1&t&&(s.TgZ(0,"div",4),s.TgZ(1,"app-breadcrumb-trail"),s._UZ(2,"app-breadcrumb",13),s.YNc(3,Bs,1,3,"app-breadcrumb",14),s.qZA(),s.qZA()),2&t){const t=s.oxw().ngIf,e=s.oxw();s.xp6(2),s.Q6J("queryParams",s.VKq(2,js,e.yamcs.context)),s.xp6(1),s.Q6J("ngForOf",t)}}function Gs(t,e){if(1&t&&(s.ynx(0),s.YNc(1,zs,4,4,"div",12),s.BQk()),2&t){const t=e.ngIf;s.xp6(1),s.Q6J("ngIf",t.length)}}function Xs(t,e){1&t&&(s.TgZ(0,"th",35),s._uU(1,"Name"),s.qZA())}const Ws=function(){return["/telemetry/parameters"]},Ks=function(t,e){return{c:t,system:e}};function to(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"mat-icon",37),s._uU(2,"folder"),s.qZA(),s.TgZ(3,"a",38),s._uU(4),s.ALo(5,"filename"),s.qZA(),s.BQk()),2&t){const t=s.oxw().$implicit,e=s.oxw(2);s.xp6(3),s.Q6J("routerLink",s.DdM(5,Ws))("queryParams",s.WLB(6,Ks,e.yamcs.context,t.name)),s.xp6(1),s.hij(" ",s.lcZ(5,3,t.name),"/ ")}}function eo(t,e){if(1&t&&s._UZ(0,"app-highlight",40),2&t){const t=s.oxw(2).$implicit,e=s.oxw(2);s.Q6J("text",t.parameter.qualifiedName)("term",e.filterForm.value.filter)}}function io(t,e){if(1&t&&(s._UZ(0,"app-highlight",40),s.ALo(1,"slice")),2&t){const t=s.oxw(2).$implicit,e=s.oxw(2);s.Q6J("text",s.xi3(1,2,t.parameter.qualifiedName,e.system.length+1))("term",e.filterForm.value.filter)}}const no=function(t){return["/telemetry/parameters",t]};function ao(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"mat-icon",37),s._uU(2,"toll"),s.qZA(),s.TgZ(3,"a",38),s.YNc(4,eo,1,2,"app-highlight",39),s.YNc(5,io,2,5,"app-highlight",39),s.qZA(),s.BQk()),2&t){const t=s.oxw().$implicit,e=s.oxw(2);s.xp6(3),s.Q6J("routerLink",s.VKq(4,no,t.parameter.qualifiedName))("queryParams",s.VKq(6,js,e.yamcs.context)),s.xp6(1),s.Q6J("ngIf",!e.system),s.xp6(1),s.Q6J("ngIf",e.system)}}function so(t,e){if(1&t&&(s.TgZ(0,"td",36),s.YNc(1,to,6,9,"ng-container",3),s.YNc(2,ao,6,8,"ng-container",3),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",t.spaceSystem),s.xp6(1),s.Q6J("ngIf",!t.spaceSystem)}}function oo(t,e){1&t&&(s.TgZ(0,"th",41),s._uU(1,"Raw value"),s.qZA())}function ro(t,e){if(1&t&&(s.TgZ(0,"td",42),s._uU(1),s.ALo(2,"value"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,null==t.pval?null:t.pval.rawValue)||"-"," ")}}function co(t,e){1&t&&(s.TgZ(0,"th",43),s._uU(1,"Value"),s.qZA())}function lo(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"units"),s.qZA()),2&t){const t=s.oxw(2).$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,null==t.parameter||null==t.parameter.type?null:t.parameter.type.unitSet))}}function uo(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"\u2193"),s.qZA())}function po(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"\u2191"),s.qZA())}function mo(t,e){if(1&t&&(s.TgZ(0,"app-expirable",45),s._uU(1),s.ALo(2,"value"),s.YNc(3,lo,3,3,"span",3),s.YNc(4,uo,2,0,"span",3),s.YNc(5,po,2,0,"span",3),s.qZA()),2&t){const t=s.oxw().$implicit;s.Q6J("pval",t.pval),s.xp6(1),s.hij(" ",s.lcZ(2,5,null==t.pval?null:t.pval.engValue)||"-"," "),s.xp6(2),s.Q6J("ngIf",null==t.parameter||null==t.parameter.type?null:t.parameter.type.unitSet),s.xp6(1),s.Q6J("ngIf","LOW"===(null==t.pval?null:t.pval.rangeCondition)),s.xp6(1),s.Q6J("ngIf","HIGH"===(null==t.pval?null:t.pval.rangeCondition))}}function ho(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"-"),s.qZA())}function go(t,e){if(1&t&&(s.TgZ(0,"td",42),s.YNc(1,mo,6,7,"app-expirable",44),s.YNc(2,ho,2,0,"span",3),s.qZA()),2&t){const t=e.$implicit;s.ekj("alert",(null==t.pval?null:t.pval.monitoringResult)&&"IN_LIMITS"!==(null==t.pval?null:t.pval.monitoringResult)),s.xp6(1),s.Q6J("ngIf",t.pval),s.xp6(1),s.Q6J("ngIf",!t.pval)}}function fo(t,e){1&t&&(s.TgZ(0,"th",46),s._uU(1,"Type"),s.qZA())}function Zo(t,e){if(1&t&&(s.TgZ(0,"span",48),s._uU(1),s.qZA()),2&t){const t=e.ngIf;s.xp6(1),s.hij(" ",t," ")}}function yo(t,e){if(1&t&&(s.TgZ(0,"td",42),s.YNc(1,Zo,2,1,"span",47),s.qZA()),2&t){const t=e.$implicit;s.oxw(2);const i=s.MAs(19);s.xp6(1),s.Q6J("ngIf",null==t.parameter||null==t.parameter.type?null:t.parameter.type.engType)("ngIfElse",i)}}function xo(t,e){1&t&&(s.TgZ(0,"th",49),s._uU(1,"Data Source"),s.qZA())}function vo(t,e){if(1&t&&(s.TgZ(0,"td",42),s._uU(1),s.ALo(2,"titlecase"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,null==t.parameter?null:t.parameter.dataSource)||"-")}}function bo(t,e){1&t&&(s.TgZ(0,"th",50),s._uU(1,"Description"),s.qZA())}function wo(t,e){if(1&t&&(s.TgZ(0,"td",42),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu((null==t.parameter?null:t.parameter.shortDescription)||"-")}}function Ao(t,e){1&t&&s._UZ(0,"tr",51)}function To(t,e){if(1&t&&s._UZ(0,"tr",52),2&t){const t=e.$implicit,i=s.oxw(2);s.ekj("selected",i.selection.isSelected(t))}}function So(t,e){if(1&t&&(s.TgZ(0,"table",16),s.ynx(1,17),s.YNc(2,Xs,2,0,"th",18),s.YNc(3,so,3,2,"td",19),s.BQk(),s.ynx(4,20),s.YNc(5,oo,2,0,"th",21),s.YNc(6,ro,3,3,"td",22),s.BQk(),s.ynx(7,23),s.YNc(8,co,2,0,"th",24),s.YNc(9,go,3,4,"td",25),s.BQk(),s.ynx(10,26),s.YNc(11,fo,2,0,"th",27),s.YNc(12,yo,2,2,"td",28),s.BQk(),s.ynx(13,29),s.YNc(14,xo,2,0,"th",30),s.YNc(15,vo,3,3,"td",28),s.BQk(),s.ynx(16,31),s.YNc(17,bo,2,0,"th",32),s.YNc(18,wo,2,1,"td",28),s.BQk(),s.YNc(19,Ao,1,0,"tr",33),s.YNc(20,To,1,2,"tr",34),s.qZA()),2&t){const t=s.oxw();s.Q6J("dataSource",t.dataSource),s.xp6(19),s.Q6J("matHeaderRowDef",t.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns)}}function qo(t,e){if(1&t&&(s.TgZ(0,"div",1),s._uU(1," The Mission Database for "),s.TgZ(2,"i"),s._uU(3),s.qZA(),s._uU(4," does not define any parameters. "),s.qZA()),2&t){const t=s.oxw();s.xp6(3),s.Oqu(t.yamcs.instance)}}function Co(t,e){1&t&&s._uU(0,"-")}let No=(()=>{class t{constructor(t,e,i,n,a){this.yamcs=t,this.route=i,this.router=n,this.filterForm=new lt.cw({filter:new lt.NI,type:new lt.NI("ANY"),source:new lt.NI("ANY")}),this.shortName=!1,this.pageSize=100,this.system=null,this.breadcrumb$=new v.X([]),this.displayedColumns=["name","type","dataSource","engValue","shortDescription"],this.typeOptions=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}],this.sourceOptions=[{id:"ANY",label:"Any source"},{id:"COMMAND",label:"Command"},{id:"COMMAND_HISTORY",label:"Command History"},{id:"CONSTANT",label:"Constant"},{id:"DERIVED",label:"Derived"},{id:"EXTERNAL1",label:"External 1"},{id:"EXTERNAL2",label:"External 2"},{id:"EXTERNAL3",label:"External 3"},{id:"LOCAL",label:"Local"},{id:"SYSTEM",label:"System"},{id:"TELEMETERED",label:"Telemetered"}],this.selection=new x.Ov(!1),e.setTitle("Parameters"),this.dataSource=new Es(t,a)}ngAfterViewInit(){const t=this.route.snapshot.queryParamMap;t.has("filter")&&(this.filter=t.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),t.has("type")&&(this.type=t.get("type"),this.filterForm.get("type").setValue(this.type)),t.has("source")&&(this.source=t.get("source"),this.filterForm.get("source").setValue(this.source)),this.filterForm.get("filter").valueChanges.subscribe(t=>{this.paginator.pageIndex=0,this.filter=t,this.updateDataSource()}),this.filterForm.get("type").valueChanges.forEach(t=>{this.type="ANY"!==t?t:null,this.updateDataSource()}),this.filterForm.get("source").valueChanges.forEach(t=>{this.source="ANY"!==t?t:null,this.updateDataSource()}),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(t=>{t.get("system")!==this.system&&this.changeSystem(t)}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(t){this.system=t.get("system"),this.updateBrowsePath(),this.paginator.pageIndex=t.has("page")?Number(t.get("page")):0,this.updateDataSource()}updateDataSource(){this.updateURL();const t={system:this.system||"/",pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize};this.filter&&(t.q=this.filter),this.type&&(t.type=this.type),this.source&&(t.source=this.source),this.dataSource.loadParameters(t).then(()=>{this.selection.clear(),this.updateBrowsePath()})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filter||null,type:this.type||null,source:this.source||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){const t=[];let e="";if(this.system)for(const i of this.system.slice(1).split("/"))e+="/"+i,t.push({name:i,route:"/telemetry/parameters",queryParams:{system:e,c:this.yamcs.context}});this.breadcrumb$.next(t)}selectNext(){const t=this.dataSource.items$.value;let e=0;if(this.selection.hasValue()){const i=this.selection.selected[0];-1!==t.indexOf(i)&&(e=Math.min(t.indexOf(i)+1,t.length-1))}this.selection.select(t[e])}selectPrevious(){const t=this.dataSource.items$.value;let e=0;if(this.selection.hasValue()){const i=this.selection.selected[0];-1!==t.indexOf(i)&&(e=Math.max(t.indexOf(i)-1,0))}this.selection.select(t[e])}applySelection(){var t;if(this.selection.hasValue()){const e=this.selection.selected[0],i=this.dataSource.items$.value;e.parameter&&-1!==i.indexOf(e)&&this.router.navigate(["/telemetry/parameters",null===(t=e.parameter)||void 0===t?void 0:t.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription&&this.queryParamMapSubscription.unsubscribe(),this.dataSource.disconnect()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(pe.Dx),s.Y36(m.gz),s.Y36(m.F0),s.Y36(h.j))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&(s.Gf(Fs,7),s.Gf($s.NW,7)),2&t){let t;s.iGM(t=s.CRH())&&(e.top=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},decls:20,vars:14,consts:[["top",""],[1,"panel-content"],[3,"formGroup"],[4,"ngIf"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"formControl","onArrowDown","onArrowUp","onEnter"],["formControlName","type",3,"options"],["formControlName","source",3,"options"],["mat-table","","class","ya-data-table","style","width: 100%",3,"dataSource",4,"ngIf"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["empty",""],["dash",""],["class","filter-bar",4,"ngIf"],["link","/telemetry/parameters","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label",4,"ngFor","ngForOf"],[3,"link","queryParams","label"],["mat-table","",1,"ya-data-table",2,"width","100%",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","style","width: 400px",4,"matHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","style","width: 200px",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-header-cell","","style","min-width: 200px",4,"matHeaderCellDef"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","","style","width: 120px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","dataSource"],["mat-header-cell","","style","width: 100px",4,"matHeaderCellDef"],["matColumnDef","shortDescription"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"width","400px"],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],[3,"routerLink","queryParams"],[3,"text","term",4,"ngIf"],[3,"text","term"],["mat-header-cell","",2,"width","200px"],["mat-cell",""],["mat-header-cell","",2,"min-width","200px"],[3,"pval",4,"ngIf"],[3,"pval"],["mat-header-cell","",2,"width","120px"],["class","mono",4,"ngIf","ngIfElse"],[1,"mono"],["mat-header-cell","",2,"width","100px"],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"app-instance-page"),s.TgZ(1,"app-instance-toolbar"),s._uU(2," Parameters "),s.qZA(),s._UZ(3,"span",null,0),s.TgZ(5,"div",1),s.TgZ(6,"form",2),s.YNc(7,Gs,2,1,"ng-container",3),s.ALo(8,"async"),s.TgZ(9,"div",4),s.TgZ(10,"app-search-filter",5),s.NdJ("onArrowDown",function(){return e.selectNext()})("onArrowUp",function(){return e.selectPrevious()})("onEnter",function(){return e.applySelection()}),s.qZA(),s._UZ(11,"app-select",6),s._UZ(12,"app-select",7),s.qZA(),s.qZA(),s.YNc(13,So,21,3,"table",8),s._UZ(14,"mat-paginator",9),s.ALo(15,"async"),s.qZA(),s.YNc(16,qo,5,1,"ng-template",null,10,s.W1O),s.YNc(18,Co,1,0,"ng-template",null,11,s.W1O),s.qZA()),2&t&&(s.xp6(6),s.Q6J("formGroup",e.filterForm),s.xp6(1),s.Q6J("ngIf",s.lcZ(8,10,e.breadcrumb$)),s.xp6(3),s.Q6J("formControl",e.filterForm.controls.filter),s.xp6(1),s.Q6J("options",e.typeOptions),s.xp6(1),s.Q6J("options",e.sourceOptions),s.xp6(1),s.Q6J("ngIf",e.dataSource),s.xp6(1),s.Q6J("pageSize",e.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",s.lcZ(15,12,e.dataSource.totalSize$)))},directives:[me.a,he.k,lt._Y,lt.JL,lt.sg,o.O5,Hs.a,lt.JJ,lt.oH,Ci.P,lt.u,$s.NW,De.w,Pe.a,o.sg,S.BZ,S.w1,S.fO,S.Dz,q.O_,S.as,S.nj,S.ge,S.ev,U.Hw,m.yS,Vs.y,N.Y,S.XQ,S.Gk],pipes:[o.Ov,Ie.X,o.OU,I.V,os.H,o.rS],styles:[".primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0}),t})();var _o=i(6874),Uo=i(9855),Io=i(5700),ko=i(7433);const Qo=["container"],Jo="http://www.w3.org/2000/svg";let Yo=(()=>{class t{ngOnChanges(){this.pval&&this.indicator&&this.redraw()}ngAfterViewInit(){const t=this.container.nativeElement,e=document.createElementNS(Jo,"rect");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100"),e.setAttribute("height","50"),e.setAttribute("shape-rendering","crispEdges"),e.style.fill="#00ff00",t.appendChild(e),this.watchLowRange=document.createElementNS(Jo,"rect"),this.watchLowRange.setAttribute("x","0"),this.watchLowRange.setAttribute("y","0"),this.watchLowRange.setAttribute("width","0"),this.watchLowRange.setAttribute("height","50"),this.watchLowRange.setAttribute("shape-rendering","crispEdges"),this.watchLowRange.style.fill="#ffff98",t.appendChild(this.watchLowRange),this.watchHighRange=document.createElementNS(Jo,"rect"),this.watchHighRange.setAttribute("x","0"),this.watchHighRange.setAttribute("y","0"),this.watchHighRange.setAttribute("width","0"),this.watchHighRange.setAttribute("height","50"),this.watchHighRange.setAttribute("shape-rendering","crispEdges"),this.watchHighRange.style.fill="#ffff98",t.appendChild(this.watchHighRange),this.warningLowRange=document.createElementNS(Jo,"rect"),this.warningLowRange.setAttribute("x","0"),this.warningLowRange.setAttribute("y","0"),this.warningLowRange.setAttribute("width","0"),this.warningLowRange.setAttribute("height","50"),this.warningLowRange.setAttribute("shape-rendering","crispEdges"),this.warningLowRange.style.fill="#ffff00",t.appendChild(this.warningLowRange),this.warningHighRange=document.createElementNS(Jo,"rect"),this.warningHighRange.setAttribute("x","0"),this.warningHighRange.setAttribute("y","0"),this.warningHighRange.setAttribute("width","0"),this.warningHighRange.setAttribute("height","50"),this.warningHighRange.setAttribute("shape-rendering","crispEdges"),this.warningHighRange.style.fill="#ffff00",t.appendChild(this.warningHighRange),this.distressLowRange=document.createElementNS(Jo,"rect"),this.distressLowRange.setAttribute("x","0"),this.distressLowRange.setAttribute("y","0"),this.distressLowRange.setAttribute("width","0"),this.distressLowRange.setAttribute("height","50"),this.distressLowRange.setAttribute("shape-rendering","crispEdges"),this.distressLowRange.style.fill="#ff6600",t.appendChild(this.distressLowRange),this.distressHighRange=document.createElementNS(Jo,"rect"),this.distressHighRange.setAttribute("x","0"),this.distressHighRange.setAttribute("y","0"),this.distressHighRange.setAttribute("width","0"),this.distressHighRange.setAttribute("height","50"),this.distressHighRange.setAttribute("shape-rendering","crispEdges"),this.distressHighRange.style.fill="#ff6600",t.appendChild(this.distressHighRange),this.criticalLowRange=document.createElementNS(Jo,"rect"),this.criticalLowRange.setAttribute("x","0"),this.criticalLowRange.setAttribute("y","0"),this.criticalLowRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("height","50"),this.criticalLowRange.setAttribute("shape-rendering","crispEdges"),this.criticalLowRange.style.fill="red",t.appendChild(this.criticalLowRange),this.criticalHighRange=document.createElementNS(Jo,"rect"),this.criticalHighRange.setAttribute("x","0"),this.criticalHighRange.setAttribute("y","0"),this.criticalHighRange.setAttribute("width","0"),this.criticalHighRange.setAttribute("height","50"),this.criticalHighRange.setAttribute("shape-rendering","crispEdges"),this.criticalHighRange.style.fill="red",t.appendChild(this.criticalHighRange),this.severeLowRange=document.createElementNS(Jo,"rect"),this.severeLowRange.setAttribute("x","0"),this.severeLowRange.setAttribute("y","0"),this.severeLowRange.setAttribute("width","0"),this.severeLowRange.setAttribute("height","50"),this.severeLowRange.setAttribute("shape-rendering","crispEdges"),this.severeLowRange.style.fill="#800000",t.appendChild(this.severeLowRange),this.severeHighRange=document.createElementNS(Jo,"rect"),this.severeHighRange.setAttribute("x","0"),this.severeHighRange.setAttribute("y","0"),this.severeHighRange.setAttribute("width","0"),this.severeHighRange.setAttribute("height","50"),this.severeHighRange.setAttribute("shape-rendering","crispEdges"),this.severeHighRange.style.fill="#800000",t.appendChild(this.severeHighRange),this.indicator=document.createElementNS(Jo,"polygon"),this.indicator.classList.add("indicator"),this.indicator.style.fill="black",this.indicator.style.visibility="hidden",t.appendChild(this.indicator),this.pval&&this.redraw()}redraw(){let t,e;const i=new Map;if(this.pval.alarmRange)for(const n of this.pval.alarmRange)i.set(n.level,n),void 0!==n.minInclusive&&(void 0===t||n.minInclusive<t)&&(t=n.minInclusive),void 0!==n.minExclusive&&(void 0===t||n.minExclusive<t)&&(t=n.minExclusive),void 0!==n.maxInclusive&&(void 0===e||n.maxInclusive>e)&&(e=n.maxInclusive),void 0!==n.maxExclusive&&(void 0===e||n.maxExclusive>e)&&(e=n.maxExclusive);if(this.criticalHighRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("width","0"),this.indicator.style.visibility="hidden",void 0!==t&&void 0!==e&&t!==e){const n=t-(e-t)/5,a=e+(e-t)/5,s=100/(a-n),o=i.get("WATCH");if(o)if(o.minInclusive?this.watchLowRange.setAttribute("width",String((o.minInclusive-n)*s)):o.minExclusive&&this.watchLowRange.setAttribute("width",String((o.minExclusive-n)*s)),o.maxInclusive){const t=(o.maxInclusive-n)*s;this.watchHighRange.setAttribute("x",String(t)),this.watchHighRange.setAttribute("width",String(100-t))}else if(o.maxExclusive){const t=(o.maxExclusive-n)*s;this.watchHighRange.setAttribute("x",String(t)),this.watchHighRange.setAttribute("width",String(100-t))}const r=i.get("WARNING");if(r)if(r.minInclusive?this.warningLowRange.setAttribute("width",String((r.minInclusive-n)*s)):r.minExclusive&&this.warningLowRange.setAttribute("width",String((r.minExclusive-n)*s)),r.maxInclusive){const t=(r.maxInclusive-n)*s;this.warningHighRange.setAttribute("x",String(t)),this.warningHighRange.setAttribute("width",String(100-t))}else if(r.maxExclusive){const t=(r.maxExclusive-n)*s;this.warningHighRange.setAttribute("x",String(t)),this.warningHighRange.setAttribute("width",String(100-t))}const c=i.get("DISTRESS");if(c)if(c.minInclusive?this.distressLowRange.setAttribute("width",String((c.minInclusive-n)*s)):c.minExclusive&&this.distressLowRange.setAttribute("width",String((c.minExclusive-n)*s)),c.maxInclusive){const t=(c.maxInclusive-n)*s;this.distressHighRange.setAttribute("x",String(t)),this.distressHighRange.setAttribute("width",String(100-t))}else if(c.maxExclusive){const t=(c.maxExclusive-n)*s;this.distressHighRange.setAttribute("x",String(t)),this.distressHighRange.setAttribute("width",String(100-t))}const l=i.get("CRITICAL");if(l)if(l.minInclusive?this.criticalLowRange.setAttribute("width",String((l.minInclusive-n)*s)):l.minExclusive&&this.criticalLowRange.setAttribute("width",String((l.minExclusive-n)*s)),l.maxInclusive){const t=(l.maxInclusive-n)*s;this.criticalHighRange.setAttribute("x",String(t)),this.criticalHighRange.setAttribute("width",String(100-t))}else if(l.maxExclusive){const t=(l.maxExclusive-n)*s;this.criticalHighRange.setAttribute("x",String(t)),this.criticalHighRange.setAttribute("width",String(100-t))}const u=i.get("SEVERE");if(u)if(u.minInclusive?this.severeLowRange.setAttribute("width",String((u.minInclusive-n)*s)):u.minExclusive&&this.severeLowRange.setAttribute("width",String((u.minExclusive-n)*s)),u.maxInclusive){const t=(u.maxInclusive-n)*s;this.severeHighRange.setAttribute("x",String(t)),this.severeHighRange.setAttribute("width",String(100-t))}else if(u.maxExclusive){const t=(u.maxExclusive-n)*s;this.severeHighRange.setAttribute("x",String(t)),this.severeHighRange.setAttribute("width",String(100-t))}const p=this.getNumericValue(this.pval);if(void 0!==p){const t=(Math.min(Math.max(p,n),a)-n)*s;this.indicator.setAttribute("points",`${t},25 ${t-3.5},100 ${t+3.5},100`),this.indicator.style.visibility="visible"}else this.indicator.style.visibility="hidden"}}getNumericValue(t){const e=t.engValue;switch(e.type){case"FLOAT":return e.floatValue;case"DOUBLE":return e.doubleValue;case"UINT32":return e.uint32Value;case"SINT32":return e.sint32Value;case"UINT64":return e.uint64Value;case"SINT64":return e.sint64Value}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-severity-meter"]],viewQuery:function(t,e){if(1&t&&s.Gf(Qo,7),2&t){let t;s.iGM(t=s.CRH())&&(e.container=t.first)}},inputs:{pval:"pval"},features:[s.TTD],decls:2,vars:0,consts:[["width","100%","height","8px","viewBox","0 0 100 100","preserveAspectRatio","none",2,"overflow","visible"],["container",""]],template:function(t,e){1&t&&(s.O4$(),s._UZ(0,"svg",0,1))},encapsulation:2,changeDetection:0}),t})();var Mo=i(4749);const Oo=function(t,e){return{c:t,filter:e}};function Do(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"a",10),s._uU(2),s.qZA(),s.BQk()),2&t){const t=e.ngIf,i=s.oxw(2);s.xp6(1),s.Q6J("queryParams",s.WLB(2,Oo,i.yamcs.context,t)),s.xp6(1),s.hij(" ",t," ")}}function Po(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2),s.qZA(),s.TgZ(3,"dd"),s._uU(4),s.qZA(),s.BQk()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.namespace),s.xp6(2),s.Oqu(t.name)}}function Lo(t,e){if(1&t&&(s.TgZ(0,"span",11),s._uU(1),s.qZA()),2&t){const t=e.ngIf;s.xp6(1),s.hij(" ",t," ")}}function Ro(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2,"Description"),s.qZA(),s.TgZ(3,"dd"),s._UZ(4,"app-markdown",12),s.qZA(),s.BQk()),2&t){const t=s.oxw().ngIf;s.xp6(4),s.Q6J("text",t.longDescription)}}function $o(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2,"Description"),s.qZA(),s.TgZ(3,"dd"),s._uU(4),s.qZA(),s.BQk()),2&t){const t=s.oxw().ngIf;s.xp6(4),s.hij(" ",t.shortDescription||"-"," ")}}function Eo(t,e){if(1&t&&(s.ynx(0),s.YNc(1,Ro,5,1,"ng-container",2),s.YNc(2,$o,5,1,"ng-container",2),s.BQk()),2&t){const t=e.ngIf;s.xp6(1),s.Q6J("ngIf",t.longDescription),s.xp6(1),s.Q6J("ngIf",!t.longDescription)}}function Ho(t,e){if(1&t&&(s.TgZ(0,"dl",8),s.TgZ(1,"dt"),s._uU(2,"Entry"),s.qZA(),s.TgZ(3,"dd"),s._uU(4),s.ALo(5,"shortName"),s.qZA(),s.TgZ(6,"dt"),s._uU(7,"Space System"),s.qZA(),s.TgZ(8,"dd"),s.YNc(9,Do,3,5,"ng-container",2),s.ALo(10,"spaceSystemName"),s.qZA(),s.YNc(11,Po,5,2,"ng-container",3),s.ALo(12,"async"),s.TgZ(13,"dt"),s._uU(14,"Type"),s.qZA(),s.TgZ(15,"dd"),s.YNc(16,Lo,2,1,"span",4),s.ALo(17,"async"),s.qZA(),s.TgZ(18,"dt"),s._uU(19,"Source"),s.qZA(),s.TgZ(20,"dd"),s._uU(21),s.ALo(22,"titlecase"),s.qZA(),s.YNc(23,Eo,3,2,"ng-container",9),s.ALo(24,"async"),s.qZA()),2&t){const t=s.oxw(),e=s.MAs(22);let i;s.xp6(4),s.AsE(" ",s.lcZ(5,9,t.parameter.qualifiedName),"",t.offset," "),s.xp6(5),s.Q6J("ngIf",s.lcZ(10,11,t.parameter.qualifiedName)),s.xp6(2),s.Q6J("ngForOf",s.lcZ(12,13,t.entry$).alias),s.xp6(5),s.Q6J("ngIf",null==(i=s.lcZ(17,15,t.ptype$))?null:i.engType)("ngIfElse",e),s.xp6(5),s.Oqu(s.lcZ(22,17,t.parameter.dataSource)||"-"),s.xp6(2),s.Q6J("ngIf",s.lcZ(24,19,t.entry$))("ngIfElse",e)}}const Vo=function(t){return["/telemetry/parameters",t]},Fo=function(t){return{c:t}};function Bo(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2,"Host Parameter"),s.qZA(),s.TgZ(3,"dd"),s.TgZ(4,"a",13),s._uU(5),s.ALo(6,"shortName"),s.qZA(),s.qZA(),s.BQk()),2&t){const t=s.oxw();s.xp6(4),s.Q6J("routerLink",s.VKq(5,Vo,t.parameter.qualifiedName))("queryParams",s.VKq(7,Fo,t.yamcs.context)),s.xp6(1),s.hij(" ",s.lcZ(6,3,t.parameter.qualifiedName)," ")}}function jo(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2,"Parameter"),s.qZA(),s.TgZ(3,"dd"),s._uU(4),s.ALo(5,"shortName"),s.qZA(),s.BQk()),2&t){const t=s.oxw();s.xp6(4),s.Oqu(s.lcZ(5,1,t.parameter.qualifiedName))}}function zo(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"a",10),s._uU(2),s.qZA(),s.BQk()),2&t){const t=e.ngIf,i=s.oxw(2);s.xp6(1),s.Q6J("queryParams",s.WLB(2,Oo,i.yamcs.context,t)),s.xp6(1),s.hij(" ",t," ")}}function Go(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2,"Space System"),s.qZA(),s.TgZ(3,"dd"),s.YNc(4,zo,3,5,"ng-container",2),s.ALo(5,"spaceSystemName"),s.qZA(),s.BQk()),2&t){const t=s.oxw();s.xp6(4),s.Q6J("ngIf",s.lcZ(5,1,t.parameter.qualifiedName))}}function Xo(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2),s.qZA(),s.TgZ(3,"dd"),s._uU(4),s.qZA(),s.BQk()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.namespace),s.xp6(2),s.Oqu(t.name)}}function Wo(t,e){if(1&t&&(s.TgZ(0,"span",11),s._uU(1),s.qZA()),2&t){const t=e.ngIf;s.xp6(1),s.hij(" ",t," ")}}function Ko(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2,"Source"),s.qZA(),s.TgZ(3,"dd"),s._uU(4),s.ALo(5,"titlecase"),s.qZA(),s.BQk()),2&t){const t=s.oxw();s.xp6(4),s.Oqu(s.lcZ(5,1,t.parameter.dataSource)||"-")}}function tr(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2,"Description"),s.qZA(),s.TgZ(3,"dd"),s._UZ(4,"app-markdown",12),s.qZA(),s.BQk()),2&t){const t=s.oxw();s.xp6(4),s.Q6J("text",t.parameter.longDescription)}}function er(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"dt"),s._uU(2,"Description"),s.qZA(),s.TgZ(3,"dd"),s._uU(4),s.qZA(),s.BQk()),2&t){const t=s.oxw();s.xp6(4),s.hij(" ",t.parameter.shortDescription||"-"," ")}}function ir(t,e){if(1&t&&(s.TgZ(0,"span",11),s._uU(1),s.qZA()),2&t){const t=e.ngIf;s.xp6(1),s.hij(" ",t," ")}}function nr(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"td"),s.TgZ(2,"a",20),s._uU(3),s.qZA(),s.qZA(),s.TgZ(4,"td"),s.YNc(5,ir,2,1,"span",4),s.ALo(6,"entryForOffset"),s.qZA(),s.TgZ(7,"td"),s._uU(8),s.ALo(9,"entryForOffset"),s.qZA(),s.TgZ(10,"td"),s._uU(11),s.ALo(12,"value"),s.qZA(),s.BQk()),2&t){const t=e.ngIf,i=s.oxw(),n=i.$implicit,a=i.index,o=s.oxw(2).ngIf,r=s.oxw(),c=s.MAs(22);let l,u;s.xp6(2),s.Q6J("routerLink",s.VKq(15,Vo,r.parameter.qualifiedName+t))("queryParams",s.VKq(17,Fo,r.yamcs.context)),s.xp6(1),s.Oqu(n),s.xp6(2),s.Q6J("ngIf",null==(l=s.xi3(6,7,r.parameter,t))||null==l.type?null:l.type.engType)("ngIfElse",c),s.xp6(3),s.Oqu((null==(u=s.xi3(9,10,r.parameter,t))?null:u.shortDescription)||"-"),s.xp6(3),s.Oqu(s.lcZ(12,13,o.aggregateValue.value[a]))}}function ar(t,e){if(1&t&&(s.TgZ(0,"tr"),s.YNc(1,nr,13,19,"ng-container",2),s.qZA()),2&t){const t=e.$implicit,i=s.oxw(3);s.xp6(1),s.Q6J("ngIf",(i.offset||"")+"."+t)}}function sr(t,e){if(1&t&&(s.TgZ(0,"table",19),s.TgZ(1,"tr"),s.TgZ(2,"th"),s._uU(3,"Member"),s.qZA(),s.TgZ(4,"th"),s._uU(5,"Type"),s.qZA(),s.TgZ(6,"th"),s._uU(7,"Description"),s.qZA(),s.TgZ(8,"th"),s._uU(9,"Value"),s.qZA(),s.qZA(),s.YNc(10,ar,2,1,"tr",3),s.qZA()),2&t){const t=s.oxw().ngIf;s.xp6(10),s.Q6J("ngForOf",t.aggregateValue.name)}}function or(t,e){if(1&t&&(s.TgZ(0,"tr"),s.TgZ(1,"td"),s.TgZ(2,"a",20),s._uU(3),s.qZA(),s.qZA(),s.TgZ(4,"td"),s._uU(5),s.ALo(6,"value"),s.qZA(),s.qZA()),2&t){const t=e.$implicit,i=e.index,n=s.oxw(3);s.xp6(2),s.Q6J("routerLink",s.VKq(6,Vo,n.parameter.qualifiedName+(n.offset||"")+"["+i+"]"))("queryParams",s.VKq(8,Fo,n.yamcs.context)),s.xp6(1),s.Oqu(i),s.xp6(2),s.Oqu(s.lcZ(6,4,t))}}function rr(t,e){if(1&t&&(s.TgZ(0,"table",19),s.TgZ(1,"tr"),s.TgZ(2,"th"),s._uU(3,"Index"),s.qZA(),s.TgZ(4,"th"),s._uU(5,"Value"),s.qZA(),s.qZA(),s.YNc(6,or,7,10,"tr",3),s.qZA()),2&t){const t=s.oxw().ngIf;s.xp6(6),s.Q6J("ngForOf",t.arrayValue)}}function cr(t,e){if(1&t&&(s.ynx(0),s._UZ(1,"app-alarm-level",23),s._uU(2,"\xa0 "),s.BQk()),2&t){const t=s.oxw(3);s.xp6(1),s.Q6J("level",t.pval.monitoringResult)}}function lr(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.ALo(2,"units"),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.Oqu(s.lcZ(2,1,null==t.parameter.type?null:t.parameter.type.unitSet))}}function ur(t,e){if(1&t&&(s.TgZ(0,"span",21),s.TgZ(1,"app-expirable",22),s.YNc(2,cr,3,1,"ng-container",2),s._uU(3),s.ALo(4,"value"),s.YNc(5,lr,3,3,"span",2),s.qZA(),s.qZA()),2&t){const t=s.oxw().ngIf,e=s.oxw();s.xp6(1),s.Q6J("pval",e.pval),s.xp6(1),s.Q6J("ngIf",e.pval.monitoringResult),s.xp6(1),s.hij(" ",s.lcZ(4,4,t)," "),s.xp6(2),s.Q6J("ngIf",null==e.parameter.type?null:e.parameter.type.unitSet)}}function pr(t,e){if(1&t&&(s.ynx(0),s._UZ(1,"app-severity-meter",24),s.BQk()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("pval",t.pval)}}function mr(t,e){if(1&t&&(s.ynx(0),s.ynx(1,14),s.YNc(2,sr,11,1,"table",15),s.YNc(3,rr,7,1,"table",15),s.YNc(4,ur,6,6,"span",16),s._UZ(5,"br"),s.TgZ(6,"div",17),s.YNc(7,pr,2,1,"ng-container",2),s._UZ(8,"br"),s.TgZ(9,"span",18),s._uU(10),s.ALo(11,"datetime"),s._UZ(12,"br"),s._uU(13),s.ALo(14,"value"),s._UZ(15,"br"),s.qZA(),s.qZA(),s.BQk(),s.BQk()),2&t){const t=e.ngIf,i=s.oxw();s.xp6(1),s.Q6J("ngSwitch",t.type),s.xp6(1),s.Q6J("ngSwitchCase","AGGREGATE"),s.xp6(1),s.Q6J("ngSwitchCase","ARRAY"),s.xp6(4),s.Q6J("ngIf",i.pval.alarmRange),s.xp6(3),s.hij(" Generation time: ",s.lcZ(11,6,i.pval.generationTime),""),s.xp6(3),s.hij(" Raw value: ",s.lcZ(14,8,i.pval.rawValue)||"-","")}}function hr(t,e){1&t&&(s.TgZ(0,"span",25),s._uU(1,"---"),s.qZA())}function gr(t,e){1&t&&(s.ynx(0),s._uU(1,", "),s.BQk())}const dr=function(t){return["/mdb/parameters/",t]};function fr(t,e){if(1&t&&(s.ynx(0),s.YNc(1,gr,2,0,"ng-container",2),s.TgZ(2,"a",29),s._uU(3),s.qZA(),s._uU(4),s.ALo(5,"operator"),s.BQk()),2&t){const t=e.$implicit,i=e.first,n=s.oxw(4);s.xp6(1),s.Q6J("ngIf",!i),s.xp6(1),s.Q6J("routerLink",s.VKq(8,dr,t.parameter.qualifiedName))("queryParams",s.VKq(10,Fo,n.yamcs.context)),s.xp6(1),s.hij(" ",t.parameter.name," "),s.xp6(1),s.AsE(" ",s.lcZ(5,6,t.operator)," ",t.value," ")}}function Zr(t,e){if(1&t&&(s.TgZ(0,"th"),s.YNc(1,fr,6,12,"ng-container",3),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngForOf",t.comparison)}}function yr(t,e){if(1&t&&(s.ynx(0),s._UZ(1,"app-alarm-level",30),s._uU(2),s.BQk()),2&t){const t=e.ngIf;s.xp6(1),s.Q6J("level",t)("grayscale",!0),s.xp6(1),s.hij(" ",t," ")}}function xr(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"-"),s.qZA())}function vr(t,e){if(1&t&&(s.ynx(0),s._UZ(1,"app-alarm-level",30),s._uU(2),s.BQk()),2&t){const t=e.ngIf;s.xp6(1),s.Q6J("level",t)("grayscale",!0),s.xp6(1),s.hij(" ",t," ")}}function br(t,e){1&t&&(s.TgZ(0,"span"),s._uU(1,"-"),s.qZA())}function wr(t,e){if(1&t&&(s.TgZ(0,"td"),s.YNc(1,vr,3,3,"ng-container",2),s.YNc(2,br,2,0,"span",2),s.qZA()),2&t){const t=e.$implicit,i=s.oxw().$implicit,n=s.oxw(3);s.xp6(1),s.Q6J("ngIf",n.getEnumerationAlarmLevel(t,i)),s.xp6(1),s.Q6J("ngIf",!n.getEnumerationAlarmLevel(t,i))}}function Ar(t,e){if(1&t&&(s.TgZ(0,"tr"),s.TgZ(1,"td",25),s._uU(2),s.qZA(),s.TgZ(3,"td",25),s._uU(4),s.qZA(),s.TgZ(5,"td"),s._uU(6),s.qZA(),s.TgZ(7,"td"),s.YNc(8,yr,3,3,"ng-container",2),s.YNc(9,xr,2,0,"span",2),s.qZA(),s.YNc(10,wr,3,2,"td",3),s.qZA()),2&t){const t=e.$implicit,i=s.oxw(2).ngIf,n=s.oxw();s.xp6(2),s.Oqu(t.value),s.xp6(2),s.Oqu(t.label),s.xp6(2),s.Oqu(t.description||"-"),s.xp6(2),s.Q6J("ngIf",n.getDefaultAlarmLevel(i.type,t)),s.xp6(1),s.Q6J("ngIf",!n.getDefaultAlarmLevel(i.type,t)),s.xp6(1),s.Q6J("ngForOf",i.type.contextAlarm)}}function Tr(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"div",5),s._UZ(2,"mat-divider"),s.qZA(),s.TgZ(3,"h4"),s._uU(4,"Enumeration"),s.qZA(),s.TgZ(5,"table",19),s.TgZ(6,"tr"),s.TgZ(7,"th",26),s._uU(8,"Value"),s.qZA(),s.TgZ(9,"th",27),s._uU(10,"Label"),s.qZA(),s.TgZ(11,"th",28),s._uU(12,"Description"),s.qZA(),s.TgZ(13,"th"),s._uU(14,"Alarm Level (default)"),s.qZA(),s.YNc(15,Zr,2,1,"th",3),s.qZA(),s.YNc(16,Ar,11,6,"tr",3),s.qZA(),s.BQk()),2&t){const t=s.oxw().ngIf;s.xp6(15),s.Q6J("ngForOf",null==t.type?null:t.type.contextAlarm),s.xp6(1),s.Q6J("ngForOf",null==t.type?null:t.type.enumValue)}}function Sr(t,e){if(1&t&&(s.ynx(0),s.YNc(1,Tr,17,2,"ng-container",2),s.BQk()),2&t){const t=e.ngIf;s.xp6(1),s.Q6J("ngIf","enumeration"===(null==t.type?null:t.type.engType))}}function qr(t,e){1&t&&s._uU(0,"-")}let Cr=(()=>{class t{constructor(t,e,i){this.yamcs=t,this.entryForOffsetPipe=e,this.parameterTypeForPathPipe=i,this.entry$=new v.X(null),this.ptype$=new v.X(null)}ngOnChanges(){if(this.parameter){if(this.offset){const t=this.entryForOffsetPipe.transform(this.parameter,this.offset);this.entry$.next(t)}else this.entry$.next(this.parameter);this.ptype$.next(this.parameterTypeForPathPipe.transform(this.parameter)||null)}else this.entry$.next(null),this.ptype$.next(null)}getDefaultAlarmLevel(t,e){if(t&&t.defaultAlarm){const i=t.defaultAlarm;if(i.enumerationAlarm)for(const t of i.enumerationAlarm)if(t.label===e.label)return t.level}}getEnumerationAlarmLevel(t,e){const i=t.alarm;for(const n of i.enumerationAlarm)if(n.label===e.label)return n.level}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.C),s.Y36(_o.h),s.Y36(Uo.W))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-parameter-detail"]],inputs:{parameter:"parameter",offset:"offset",pval:"pval"},features:[s.TTD],decls:23,vars:17,consts:[["class","dl-horizontal no-lead no-trail",4,"ngIf"],[1,"dl-horizontal","no-trail"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","mono",4,"ngIf","ngIfElse"],[1,"section-divider"],["style","white-space: nowrap",4,"ngIf"],["dash",""],[1,"dl-horizontal","no-lead","no-trail"],[4,"ngIf","ngIfElse"],["routerLink","/telemetry/parameters",1,"ya-link",3,"queryParams"],[1,"mono"],[3,"text"],[1,"ya-link",3,"routerLink","queryParams"],[3,"ngSwitch"],["yaDataTable","",4,"ngSwitchCase"],["class","pval",4,"ngSwitchDefault"],[1,"meter-size-constrainer"],[1,"subtext"],["yaDataTable",""],[3,"routerLink","queryParams"],[1,"pval"],[2,"white-space","nowrap",3,"pval"],[3,"level"],[3,"pval"],[2,"white-space","nowrap"],[2,"width","50px"],[2,"width","100px"],[2,"width","300px"],[1,"secundary",3,"routerLink","queryParams"],[3,"level","grayscale"]],template:function(t,e){if(1&t&&(s.YNc(0,Ho,25,21,"dl",0),s.TgZ(1,"dl",1),s.YNc(2,Bo,7,9,"ng-container",2),s.YNc(3,jo,6,3,"ng-container",2),s.YNc(4,Go,6,3,"ng-container",2),s.YNc(5,Xo,5,2,"ng-container",3),s.TgZ(6,"dt"),s._uU(7,"Type"),s.qZA(),s.TgZ(8,"dd"),s.YNc(9,Wo,2,1,"span",4),s.qZA(),s.YNc(10,Ko,6,3,"ng-container",2),s.YNc(11,tr,5,1,"ng-container",2),s.YNc(12,er,5,1,"ng-container",2),s.qZA(),s.TgZ(13,"div",5),s._UZ(14,"mat-divider"),s.qZA(),s.TgZ(15,"h4"),s._uU(16,"Current value"),s.qZA(),s.YNc(17,mr,16,10,"ng-container",2),s.YNc(18,hr,2,0,"span",6),s.YNc(19,Sr,2,1,"ng-container",2),s.ALo(20,"async"),s.YNc(21,qr,1,0,"ng-template",null,7,s.W1O)),2&t){const t=s.MAs(22);s.Q6J("ngIf",e.offset),s.xp6(1),s.ekj("no-lead",!e.offset),s.xp6(1),s.Q6J("ngIf",e.offset),s.xp6(1),s.Q6J("ngIf",!e.offset),s.xp6(1),s.Q6J("ngIf",!e.offset),s.xp6(1),s.Q6J("ngForOf",e.parameter.alias),s.xp6(4),s.Q6J("ngIf",null==e.parameter.type?null:e.parameter.type.engType)("ngIfElse",t),s.xp6(1),s.Q6J("ngIf",!e.offset),s.xp6(1),s.Q6J("ngIf",e.parameter.longDescription),s.xp6(1),s.Q6J("ngIf",!e.parameter.longDescription),s.xp6(5),s.Q6J("ngIf",null==e.pval?null:e.pval.engValue),s.xp6(1),s.Q6J("ngIf",!(null!=e.pval&&e.pval.engValue)),s.xp6(1),s.Q6J("ngIf",s.lcZ(20,15,e.entry$))}},directives:[o.O5,o.sg,pt.d,m.yS,Io.U,o.RF,o.n9,o.ED,ko.O,N.Y,C.i,Yo],pipes:[o.Ov,Us.y,_s.B,o.rS,k.i,I.V,_o.h,os.H,Mo.N],styles:[".meter-size-constrainer[_ngcontent-%COMP%]{display:inline-block;width:160px;position:relative}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{text-align:left}span.pval[_ngcontent-%COMP%]{font-size:16px;line-height:20px;margin:-8px 0 16px;bottom:-5px;color:rgba(0,0,0,.99);font-weight:400}.subtext[_ngcontent-%COMP%]{font-size:smaller;white-space:nowrap}.pval-frame[_ngcontent-%COMP%]{display:inline-block;min-width:412px;border:1px solid #e7e7e7;border-radius:2px;box-shadow:0 1px 3px rgba(0,0,0,.12)}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;height:64px;line-height:64px;padding-left:24px;position:relative}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.pval-frame[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:24px}.mat-icon.unchecked[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),t})();function Nr(t,e){if(1&t&&(s.ynx(0),s._UZ(1,"app-parameter-detail",2),s.ALo(2,"async"),s.ALo(3,"async"),s.BQk()),2&t){const t=e.ngIf,i=s.oxw();s.xp6(1),s.Q6J("parameter",t)("offset",s.lcZ(2,3,i.offset$))("pval",s.lcZ(3,5,i.pval$))}}const _r=[{path:"",canActivate:[ce.a,re.z],canActivateChild:[ce.a],runGuardsAndResolvers:"always",component:le.K,children:[{path:"",pathMatch:"full",redirectTo:"home"},{path:"displays",pathMatch:"full",redirectTo:"displays/browse"},{path:"displays/browse",component:vi,children:[{path:"**",component:yi}]},{path:"displays/files",component:xi,children:[{path:"**",component:ye,canDeactivate:[we]}]},{path:"packets",component:nn},{path:"parameters",pathMatch:"full",component:No},{path:"parameters/:qualifiedName",component:Rs,children:[{path:"",pathMatch:"full",redirectTo:"summary"},{path:"summary",component:(()=>{class t{constructor(t,e,i){this.yamcs=e,this.synchronizer=i,this.parameter$=new v.X(null),this.offset$=new v.X(null),this.parameterValue$=new v.X(null),this.dirty=!1,this.pval$=new v.X(null),t.parent.paramMap.subscribe(t=>{const e=t.get("qualifiedName");this.changeParameter(e)}),this.syncSubscription=this.synchronizer.syncFast(()=>{this.dirty&&(this.pval$.next(this.parameterValue$.value),this.dirty=!1)})}changeParameter(t){this.yamcs.yamcsClient.getParameter(this.yamcs.instance,t).then(e=>{this.parameter$.next(e),this.offset$.next(t!==e.qualifiedName?t.substring(e.qualifiedName.length):null),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValue$.next(null),this.pval$.next(null),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:t}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},t=>{this.parameterValue$.next(t.values?t.values[0]:null),null==this.pval$.value?this.pval$.next(this.parameterValue$.value):this.dirty=!0})})}ngOnDestroy(){this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.syncSubscription&&this.syncSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(m.gz),s.Y36(a.C),s.Y36(h.j))},t.\u0275cmp=s.Xpm({type:t,selectors:[["ng-component"]],decls:3,vars:3,consts:[[1,"panel-content"],[4,"ngIf"],[3,"parameter","offset","pval"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.YNc(1,Nr,4,7,"ng-container",1),s.ALo(2,"async"),s.qZA()),2&t&&(s.xp6(1),s.Q6J("ngIf",s.lcZ(2,1,e.parameter$)))},directives:[o.O5,Cr],pipes:[o.Ov],encapsulation:2,changeDetection:0}),t})()},{path:"chart",component:wa},{path:"data",component:is},{path:"alarms",component:Jn}]}]}];let Ur=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({providers:[we],imports:[[m.Bz.forChild(_r)],m.Bz]}),t})(),Ir=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[n.m,Ur]]}),t})()}}]);