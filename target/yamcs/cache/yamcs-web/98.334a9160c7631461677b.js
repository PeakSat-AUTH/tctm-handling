(self.webpackChunk_yamcs_webapp=self.webpackChunk_yamcs_webapp||[]).push([[98],{4098:(t,e,a)=>{"use strict";a.r(e),a.d(e,{InstanceHomeModule:()=>F});var s=a(7290),c=a(3337),i=a(7102),n=a(4017),o=a(9385),r=a(8512),m=a(8561),l=a(8981),u=a(8293),p=a(5366),h=a(9624),f=a(9451),d=a(6972),y=a(1116),g=a(9241),x=a(7340),w=a(8888),Z=a(487),k=a(3581);function D(t,e){1&t&&(p.TgZ(0,"th",18),p._uU(1,"Packet"),p.qZA())}const N=function(t,e){return{c:t,name:e}};function A(t,e){if(1&t&&(p.TgZ(0,"a",22),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit,e=p.oxw(2);p.Q6J("queryParams",p.WLB(2,N,e.yamcs.context,t.packetName)),p.xp6(1),p.hij(" ",t.packetName," ")}}function R(t,e){if(1&t&&(p.ynx(0),p._uU(1),p.BQk()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.packetName)}}function b(t,e){if(1&t&&(p.TgZ(0,"td",19),p.YNc(1,A,2,5,"a",20),p.YNc(2,R,2,1,"ng-container",21),p.qZA()),2&t){const t=p.oxw(2);p.xp6(1),p.Q6J("ngIf",t.config.tmArchive),p.xp6(1),p.Q6J("ngIf",!t.config.tmArchive)}}function C(t,e){1&t&&p._UZ(0,"td",23)}function Y(t,e){1&t&&(p.TgZ(0,"th",24),p._uU(1,"Received"),p.qZA())}function S(t,e){if(1&t&&(p.TgZ(0,"td",25),p._uU(1),p.ALo(2,"deltaWith"),p.qZA()),2&t){const t=e.$implicit;p.xp6(1),p.hij(" ",p.xi3(2,1,t.lastReceived,t.lastPacketTime)||"-"," ")}}function T(t,e){1&t&&p._UZ(0,"td",23)}function _(t,e){1&t&&(p.TgZ(0,"th",26),p._uU(1,"Packet Time"),p.qZA())}function v(t,e){if(1&t&&(p.TgZ(0,"td",19),p._uU(1),p.ALo(2,"datetime"),p.qZA()),2&t){const t=e.$implicit;p.xp6(1),p.hij(" ",p.lcZ(2,1,t.lastPacketTime)||"-"," ")}}function U(t,e){1&t&&p._UZ(0,"td",23)}function q(t,e){1&t&&(p.TgZ(0,"th",27),p._uU(1,"Packet\xa0Rate"),p.qZA())}function $(t,e){if(1&t&&(p.TgZ(0,"td",25),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.xp6(1),p.hij(" ",t.packetRate," p/s ")}}function Q(t,e){if(1&t&&(p.TgZ(0,"td",28),p._uU(1),p.ALo(2,"async"),p.qZA()),2&t){const t=p.oxw(2);p.xp6(1),p.hij(" ",p.lcZ(2,1,t.totalPacketRate$)," p/s ")}}function P(t,e){1&t&&(p.TgZ(0,"th",27),p._uU(1,"Data\xa0Rate "),p.qZA())}function B(t,e){if(1&t&&(p.TgZ(0,"td",25),p._uU(1),p.ALo(2,"dataRate"),p.qZA()),2&t){const t=e.$implicit;p.xp6(1),p.hij(" ",p.lcZ(2,1,t.dataRate)," ")}}function j(t,e){if(1&t&&(p.TgZ(0,"td",28),p._uU(1),p.ALo(2,"dataRate"),p.ALo(3,"async"),p.qZA()),2&t){const t=p.oxw(2);p.xp6(1),p.hij(" ",p.lcZ(2,1,p.lcZ(3,3,t.totalDataRate$))," ")}}function J(t,e){1&t&&p._UZ(0,"tr",29)}function I(t,e){1&t&&p._UZ(0,"tr",30)}function O(t,e){1&t&&p._UZ(0,"tr",31)}function H(t,e){if(1&t&&(p.TgZ(0,"table",1),p.ynx(1,2),p.YNc(2,D,2,0,"th",3),p.YNc(3,b,3,2,"td",4),p.YNc(4,C,1,0,"td",5),p.BQk(),p.ynx(5,6),p.YNc(6,Y,2,0,"th",7),p.YNc(7,S,3,4,"td",8),p.YNc(8,T,1,0,"td",5),p.BQk(),p.ynx(9,9),p.YNc(10,_,2,0,"th",10),p.YNc(11,v,3,3,"td",4),p.YNc(12,U,1,0,"td",5),p.BQk(),p.ynx(13,11),p.YNc(14,q,2,0,"th",12),p.YNc(15,$,2,1,"td",8),p.YNc(16,Q,3,3,"td",13),p.BQk(),p.ynx(17,14),p.YNc(18,P,2,0,"th",12),p.YNc(19,B,3,3,"td",8),p.YNc(20,j,4,5,"td",13),p.BQk(),p.YNc(21,J,1,0,"tr",15),p.YNc(22,I,1,0,"tr",16),p.YNc(23,O,1,0,"tr",17),p.qZA()),2&t){const t=p.oxw();p.Q6J("dataSource",t.dataSource),p.xp6(21),p.Q6J("matHeaderRowDef",t.displayedColumns),p.xp6(1),p.Q6J("matRowDefColumns",t.displayedColumns),p.xp6(1),p.Q6J("matFooterRowDef",t.displayedColumns)}}let L=(()=>{class t{constructor(t,e){this.yamcs=t,this.statsByName={},this.dataSource=new x.by,this.totalPacketRate$=new r.X(0),this.totalDataRate$=new r.X(0),this.displayedColumns=["packetName","lastPacketTime","lastReceived","packetRate","dataRate"],this.config=e.getConfig()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.tmstats$&&!this.tmstatsSubscription&&this.yamcs.yamcsClient.getPacketNames(this.yamcs.instance).then(t=>{for(const e of t||[])this.statsByName[e]={packetName:e,packetRate:0,dataRate:0};this.updateData(),this.tmstatsSubscription=this.tmstats$.subscribe(t=>{for(const e of t||[])this.statsByName[e.packetName]=e;this.updateData()})})}updateData(){const t=Object.values(this.statsByName);let e=0,a=0;for(const s of t)e+=Number(s.packetRate),a+=Number(s.dataRate);this.totalPacketRate$.next(e),this.totalDataRate$.next(a),this.dataSource.data=t}ngOnDestroy(){this.tmstatsSubscription&&this.tmstatsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(u.C),p.Y36(l.E))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-tmstats-table"]],viewQuery:function(t,e){if(1&t&&p.Gf(g.YE,5),2&t){let t;p.iGM(t=p.CRH())&&(e.sort=t.first)}},inputs:{tmstats$:"tmstats$"},decls:1,vars:1,consts:[["mat-table","","class","ya-data-table","matSort","","matSortActive","packetName","matSortDirection","asc","matSortDisableClear","",3,"dataSource",4,"ngIf"],["mat-table","","matSort","","matSortActive","packetName","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","","mat-sort-header","","style","width: 250px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","lastReceived"],["mat-header-cell","","style","width: 100px",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","lastPacketTime"],["mat-header-cell","","mat-sort-header","","style","width: 200px",4,"matHeaderCellDef"],["matColumnDef","packetRate"],["mat-header-cell","","mat-sort-header","","style","width: 100px",4,"matHeaderCellDef"],["mat-footer-cell","","style","text-align: right",4,"matFooterCellDef"],["matColumnDef","dataRate"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-header-cell","","mat-sort-header","",2,"width","250px"],["mat-cell",""],["routerLink","/telemetry/packets",3,"queryParams",4,"ngIf"],[4,"ngIf"],["routerLink","/telemetry/packets",3,"queryParams"],["mat-footer-cell",""],["mat-header-cell","",2,"width","100px"],["mat-cell","",2,"text-align","right"],["mat-header-cell","","mat-sort-header","",2,"width","200px"],["mat-header-cell","","mat-sort-header","",2,"width","100px"],["mat-footer-cell","",2,"text-align","right"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(t,e){1&t&&p.YNc(0,H,24,4,"table",0),2&t&&p.Q6J("ngIf",e.dataSource)},directives:[y.O5,x.BZ,g.YE,x.w1,x.fO,x.Dz,x.mD,x.as,x.nj,x.Ke,x.ge,g.nU,x.ev,c.yS,x.yh,x.XQ,x.Gk,x.Q2],pipes:[w.m,Z.i,y.Ov,k.z],encapsulation:2,changeDetection:0}),t})();function X(t,e){if(1&t&&(p.ynx(0),p._UZ(1,"app-tmstats-table",2),p.BQk()),2&t){const t=p.oxw();p.xp6(1),p.Q6J("tmstats$",t.tmstats$)}}const z=[{path:"",canActivate:[n.a,i.z],canActivateChild:[n.a],runGuardsAndResolvers:"always",component:o.K,children:[{path:"",pathMatch:"full",component:(()=>{class t{constructor(t,e,a,s){this.yamcs=t,this.authService=e,this.tmstats$=new r.X([]),this.config=s.getConfig(),this.user=e.getUser(),a.setTitle(this.yamcs.instance),this.yamcs.processor&&(this.tmstatsSubscription=t.yamcsClient.createTMStatisticsSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},t=>this.tmstats$.next(t.tmstats||[])))}showPackets(){return this.user.hasAnyObjectPrivilegeOfType("ReadPacket")}ngOnDestroy(){this.tmstatsSubscription&&this.tmstatsSubscription.cancel()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(u.C),p.Y36(m.e),p.Y36(h.Dx),p.Y36(l.E))},t.\u0275cmp=p.Xpm({type:t,selectors:[["ng-component"]],decls:5,vars:1,consts:[[1,"panel-content"],[4,"ngIf"],[3,"tmstats$"]],template:function(t,e){1&t&&(p.TgZ(0,"app-instance-page"),p.TgZ(1,"app-instance-toolbar"),p._uU(2,"Home"),p.qZA(),p.TgZ(3,"div",0),p.YNc(4,X,2,1,"ng-container",1),p.qZA(),p.qZA()),2&t&&(p.xp6(4),p.Q6J("ngIf",e.showPackets()))},directives:[f.a,d.k,y.O5,L],encapsulation:2,changeDetection:0}),t})()}]}];let E=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[c.Bz.forChild(z)],c.Bz]}),t})(),F=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[s.m,E]]}),t})()}}]);